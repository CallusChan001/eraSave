;-----------------------------------------------------------
;遠距離移動の設定
;ARG     目的地
;ARG:1   現在地
;RETURN  次の目的地
;-----------------------------------------------------------
@SKIP_MOVE_11(ARG, ARG:1)
#DIM 現在的位置
;現在位置取得
IF ARG:1
	現在的位置 = ARG:1
ELSE
	現在的位置 = CFLAG:MASTER:現在位置
ENDIF

;目的地に直接移動できる場合そこに移動
SIF CAN_MOVE(現在的位置, ARG) & 1
	RETURN ARG

;袋小路から行ける場所は固定なので、そこを目指す
SELECTCASE 現在的位置
	;魔界的死胡同分支其实挺多，关键交汇点在总传送站和万魔殿，因此路径图以这两个为中心考虑
	;一张一张地图的梳理吧
	;总传送站地图，注意小屋到浴室可达且没有其他房间，因此小屋也应该视为死胡同，即死胡同和一级死胡同分支
	CASE P1103萨拉的小屋・浴室
		RETURN P1102萨拉的小屋
	CASE P1102萨拉的小屋
		RETURN P1101传送点
	;魔界都市地图
	CASE P1113别墅区・闲置的冈崎宅 TO P1115别墅区・闲置的怨灵宅
		RETURN P1112船夫别墅区
	CASE P1106魔界商贸城
		RETURN P1105黄昏街
	;星辰之家地图
	CASE P1119雪的公寓・浴室
		RETURN P1118雪的公寓
	CASE P1118雪的公寓
		RETURN P1117星辰之家・5F走廊
	CASE P1121舞的公寓・浴室
		RETURN P1120舞的公寓
	CASE P1120舞的公寓
		RETURN P1117星辰之家・5F走廊
	CASE P1123空浴室
		RETURN P1122空屋子
	CASE P1122空屋子
		RETURN P1117星辰之家・5F走廊
	CASE P1125奥莲姬的公寓・浴室
		RETURN P1124奥莲姬的公寓
	CASE P1124奥莲姬的公寓
		RETURN P1117星辰之家・5F走廊
	CASE P1127里香的公寓・浴室
		RETURN P1126里香的公寓
	CASE P1126里香的公寓
		RETURN P1117星辰之家・5F走廊
	CASE P1129露易兹的公寓・浴室
		RETURN P1128露易兹的公寓
	CASE P1128露易兹的公寓
		RETURN P1117星辰之家・5F走廊
	;朝仓工作间地图
	CASE P1138理香子的小屋・浴室
		RETURN P1137理香子的小屋
	CASE P1132朝仓研究室・无菌室, P1134朝仓研究室・总实验室 TO P1137理香子的小屋
		RETURN P1133朝仓研究室・走廊
	;渡鸦小区地图
	CASE P1144明罗宅・浴室
		RETURN P1143明罗宅・卧室
	CASE P1143明罗宅・卧室, P1142明罗宅・厨房
		RETURN P1141明罗宅・道场
	CASE P1146魔眼宅・厨房 TO P1148魔眼宅・浴室
		RETURN P1145魔眼宅・仪式间
	CASE P1152矜羯罗宅・浴室
		RETURN P1151矜羯罗宅・卧室
	CASE P1151矜羯罗宅・卧室, P1150矜羯罗宅・厨房
		RETURN P1149矜羯罗宅・练功房
	;万魔殿地图
	CASE P1156万魔殿・厨房, P1157万魔殿・饭堂
		RETURN P1155万魔殿・一层左走廊
	CASE P1159万魔殿・菜园 TO P1161万魔殿・会客厅
		RETURN P1158万魔殿・一层右走廊
	CASE P1165万魔殿・梦子卧室 TO P1167万魔殿・神绮卧室
		RETURN P1162万魔殿・二层左走廊
	CASE P1168万魔殿・空屋, P1170万魔殿・闲置的爱丽丝卧室
		RETURN P1163万魔殿・二层右走廊
	;堕落神殿地图
	CASE P1178堕落神殿・厕所 TO P1181堕落神殿・萨丽爱尔的卧室
		RETURN P1177堕落神殿・二楼走廊
	CASE P1176堕落神殿・厨房, P1177堕落神殿・二楼走廊
		RETURN P1175堕落神殿・会客室
	;冰原世界与法界地图
	CASE P1183冰雪世界・冰湖
		RETURN P1182冰雪世界・冰原
	CASE P1182冰雪世界・冰原, P1184法界
		RETURN P1101传送点
ENDSELECT

;直接移動できない場合、1つ近い位置を暫定目的地に設定し直してループ
;基本的に最短で行けるコースを設定する
;現在地によってコースが変わることも考慮して対応する
;例如：	CASE P301正門
		;SELECTCASE 現在的位置
		;CASE P305仓库 TO P333大浴場
		;	RETURN P302庭
		;CASEELSE
		;	RETURN P343湖畔
		;ENDSELECT
;对应：其他地点→湖畔→正门←庭←红魔馆内部（左右两边不需要包括湖畔和庭这两个本来就有的位置）
	;CASE P310図書館
		;RETURN P309大廳
;对应：除了帕琪和小恶魔的卧室外的所有地点→大厅→图书馆（因为前两者可以直达图书馆）
SELECTCASE ARG
	;首先完全逆向死胡同分支，即想要抵达这些死胡同也只能走到这些分支的位置，比如各浴室，也只能先以小屋为目标
	CASE P1103萨拉的小屋・浴室
		RETURN P1102萨拉的小屋
	CASE P1102萨拉的小屋
		RETURN P1101传送点
	;魔界都市地图
	CASE P1113别墅区・闲置的冈崎宅 TO P1115别墅区・闲置的怨灵宅
		RETURN P1112船夫别墅区
	CASE P1106魔界商贸城
		RETURN P1105黄昏街
	;星辰之家地图
	CASE P1119雪的公寓・浴室
		RETURN P1118雪的公寓
	CASE P1118雪的公寓
		RETURN P1117星辰之家・5F走廊
	CASE P1121舞的公寓・浴室
		RETURN P1120舞的公寓
	CASE P1120舞的公寓
		RETURN P1117星辰之家・5F走廊
	CASE P1123空浴室
		RETURN P1122空屋子
	CASE P1122空屋子
		RETURN P1117星辰之家・5F走廊
	CASE P1125奥莲姬的公寓・浴室
		RETURN P1124奥莲姬的公寓
	CASE P1124奥莲姬的公寓
		RETURN P1117星辰之家・5F走廊
	CASE P1127里香的公寓・浴室
		RETURN P1126里香的公寓
	CASE P1126里香的公寓
		RETURN P1117星辰之家・5F走廊
	CASE P1129露易兹的公寓・浴室
		RETURN P1128露易兹的公寓
	CASE P1128露易兹的公寓
		RETURN P1117星辰之家・5F走廊
	;朝仓工作间地图
	CASE P1138理香子的小屋・浴室
		RETURN P1137理香子的小屋
	CASE P1132朝仓研究室・无菌室, P1134朝仓研究室・总实验室 TO P1137理香子的小屋
		RETURN P1133朝仓研究室・走廊
	;渡鸦小区地图
	CASE P1144明罗宅・浴室
		RETURN P1143明罗宅・卧室
	CASE P1143明罗宅・卧室, P1142明罗宅・厨房
		RETURN P1141明罗宅・道场
	CASE P1146魔眼宅・厨房 TO P1148魔眼宅・浴室
		RETURN P1145魔眼宅・仪式间
	CASE P1152矜羯罗宅・浴室
		RETURN P1151矜羯罗宅・卧室
	CASE P1151矜羯罗宅・卧室, P1150矜羯罗宅・厨房
		RETURN P1149矜羯罗宅・练功房
	;万魔殿地图
	CASE P1156万魔殿・厨房, P1157万魔殿・饭堂
		RETURN P1155万魔殿・一层左走廊
	CASE P1159万魔殿・菜园 TO P1161万魔殿・会客厅
		RETURN P1158万魔殿・一层右走廊
	CASE P1165万魔殿・梦子卧室 TO P1167万魔殿・神绮卧室
		RETURN P1162万魔殿・二层左走廊
	CASE P1168万魔殿・空屋, P1170万魔殿・闲置的爱丽丝卧室
		RETURN P1163万魔殿・二层右走廊
	;堕落神殿地图
	CASE P1178堕落神殿・厕所 TO P1181堕落神殿・萨丽爱尔的卧室
		RETURN P1177堕落神殿・二楼走廊
	CASE P1176堕落神殿・厨房, P1177堕落神殿・二楼走廊
		RETURN P1175堕落神殿・会客室
	;冰原世界与法界地图
	CASE P1183冰雪世界・冰湖
		RETURN P1182冰雪世界・冰原
	CASE P1182冰雪世界・冰原, P1184法界
		RETURN P1101传送点

	;随后是二级死胡同分支，因为子节点的一级分支会因为死胡同机制全部返回这里，因此它不再可能是从这些方向再定位到这里的，因此只需要返回父节点即可
	;比如去堕落神殿的会客厅，按以上死胡同逻辑，角色不论是在子节点的浴室厕所卧室等等，现在都已经全部回到了会客厅，因此就不再需要考虑这些方位了
	;相应的，因为二级分支可以直达三级，因此三级也不需要考虑子节点方向的定位，因为子节点的角色现在已经全部回到了二级，只需要直达三级即可，因此三级也可以直接返回父节点
	;比如要去堕落神殿的主教堂，因为会客厅方向的角色都已经到了会客厅，直达即可，因此只需要考虑其他方向的定位
	;星辰之家地图
	CASE P1117星辰之家・5F走廊
		RETURN P1116星辰之家・5F电梯口
	CASE P1116星辰之家・5F电梯口
		RETURN P1107星辰之家外
	;朝仓工作间地图
	CASE P1133朝仓研究室・走廊
		RETURN P1131朝仓研究室・准备室
	CASE P1131朝仓研究室・准备室
		RETURN P1130智者写字楼・3F走廊
	;渡鸦小区地图
	CASE P1141明罗宅・道场, P1145魔眼宅・仪式间, P1149矜羯罗宅・练功房
		RETURN P1140渡鸦小区・6F走廊
	CASE P1140渡鸦小区・6F走廊
		RETURN P1139渡鸦小区・6F电梯口
	;万魔殿地图，由于成环需要分类讨论
	;堕落神殿地图
	CASE P1175堕落神殿・会客室
		RETURN P1174堕落神殿・主教堂
	CASE P1174堕落神殿・主教堂
		RETURN P1173堕落神殿・殿外
	;冰原世界与法界地图，因为全是一级以下所以已经讨论过了

	;接下来是四级以上死胡同分支，现在必须要分类讨论，因为可能有二级分支等子节点方向过来的情况，但除了子节点以外其他方向也只需要返回父节点即可
	;星辰之家地图
	CASE P1107星辰之家外
		SELECTCASE 現在的位置
		CASE P1117星辰之家・5F走廊
			RETURN P1116星辰之家・5F电梯口
		CASEELSE
			RETURN P1105黄昏街
		ENDSELECT
	;朝仓工作间地图
	CASE P1130智者写字楼・3F走廊
		SELECTCASE 現在的位置
		CASE P1133朝仓研究室・走廊
			RETURN P1131朝仓研究室・准备室
		CASEELSE
			RETURN P1109智者写字楼外
		ENDSELECT
	CASE P1109智者写字楼外
		SELECTCASE 現在的位置
		CASE P1133朝仓研究室・走廊, P1131朝仓研究室・准备室
			RETURN P1130智者写字楼・3F走廊
		CASEELSE
			RETURN P1108先知环形路
		ENDSELECT
	;渡鸦小区地图
	CASE P1139渡鸦小区・6F电梯口
		SELECTCASE 現在的位置
		CASE P1141明罗宅・道场, P1145魔眼宅・仪式间, P1149矜羯罗宅・练功房
			RETURN P1140渡鸦小区・6F走廊
		CASEELSE
			RETURN P1111渡鸦小区・小路
		ENDSELECT
	CASE P1111渡鸦小区・小路
		SELECTCASE 現在的位置
		CASE P1141明罗宅・道场, P1145魔眼宅・仪式间, P1149矜羯罗宅・练功房, P1140渡鸦小区・6F走廊
			RETURN P1139渡鸦小区・6F电梯口
		CASEELSE
			RETURN P1110流光巷
		ENDSELECT
	;万魔殿地图，由于成环需要分类讨论
	;堕落神殿地图
	CASE P1173堕落神殿・殿外
		SELECTCASE 現在的位置
		CASE P1175堕落神殿・会客室
			RETURN P1174堕落神殿・主教堂
		CASEELSE
			RETURN P1101传送点
		ENDSELECT
	;冰原世界与法界地图，因为全是一级以下所以已经讨论过了

	;接下来是成环的万魔殿
	;成环需要考虑路径最短问题，现在各死胡同分支会将角色汇集到二级分支或岔路
	;即一楼大厅、一楼左走廊、一楼右走廊、二楼左走廊、二楼右走廊、宴会厅，六个位置
	;因为传送点位于二楼右走廊，移动倾向更高，因此除非左侧更近，否则统一返回右侧，即右走廊比左走廊的节点高级
	;同时因为目前一楼大厅出不了门，而二楼有传送点，因此二楼比一楼的节点高级——希尔塔
	;由上又可知，若转为右走廊优先级＞左走廊，一楼＞二楼的话，
	;节点优先级（谁更应该跟在CASEELSE的后面）：一右＞（二右/一左）＞二左
	CASE P1164万魔殿・宴会厅
		SELECTCASE 現在的位置
		CASE P1155万魔殿・一层左走廊
			RETURN P1162万魔殿・二层左走廊
		CASEELSE
			RETURN P1163万魔殿・二层右走廊
		ENDSELECT
	CASE P1162万魔殿・二层左走廊
		SELECTCASE 現在的位置
		CASE P1163万魔殿・二层右走廊
			RETURN P1164万魔殿・宴会厅
		CASEELSE
			RETURN P1155万魔殿・一层左走廊
		ENDSELECT
	CASE P1163万魔殿・二层右走廊
		SELECTCASE 現在的位置
		CASE P1162万魔殿・二层左走廊
			RETURN P1164万魔殿・宴会厅
		CASEELSE
			RETURN P1158万魔殿・一层右走廊
		ENDSELECT
	CASE P1155万魔殿・一层左走廊
		SELECTCASE 現在的位置
		CASE P1164万魔殿・宴会厅
			RETURN P1162万魔殿・二层左走廊
		CASEELSE
			RETURN P1154万魔殿・大厅
		ENDSELECT
	CASE P1158万魔殿・一层右走廊
		SELECTCASE 現在的位置
		CASE P1164万魔殿・宴会厅
			RETURN P1163万魔殿・二层右走廊
		CASEELSE
			RETURN P1154万魔殿・大厅
		ENDSELECT
	;随后，二楼右走廊就可以作为四级死胡同分支，只将万魔殿内部作为分类讨论而其他返回父节点的总传送点了
	;特殊的，若万魔殿大厅开始能移动到魔界都市，那么这里的逻辑也必须对应做出更改讨论
	CASE P1154万魔殿・大厅
		SELECTCASE 現在的位置
		CASE P1162万魔殿・二层左走廊
			RETURN P1155万魔殿・一层左走廊
		CASE P1164万魔殿・宴会厅, P1163万魔殿・二层右走廊
			RETURN P1158万魔殿・一层右走廊
		CASEELSE
			RETURN P1153万魔殿・庭院
		ENDSELECT
	CASE P1153万魔殿・庭院
		SELECTCASE 現在的位置
		CASE P1155万魔殿・一层左走廊, P1163万魔殿・二层右走廊, P1158万魔殿・一层右走廊, P1162万魔殿・二层左走廊, P1164万魔殿・宴会厅
			RETURN P1154万魔殿・大厅
		CASEELSE
			RETURN P1169万魔殿・传送点
		ENDSELECT
	CASE P1169万魔殿・传送点
		SELECTCASE 現在的位置 
		CASE P1155万魔殿・一层左走廊, P1154万魔殿・大厅, P1158万魔殿・一层右走廊, P1162万魔殿・二层左走廊, P1164万魔殿・宴会厅, P1163万魔殿・二层右走廊
			RETURN P1153万魔殿・庭院
		CASEELSE
			RETURN P1101传送点
		ENDSELECT
	;然后是传送点，这里先讨论传送点是因为地点的建筑分类比较清楚，可以视为类死胡同分支
	CASE P1101传送点
		SELECTCASE 現在的位置
		CASE P1155万魔殿・一层左走廊, P1154万魔殿・大厅, P1158万魔殿・一层右走廊, P1162万魔殿・二层左走廊, P1164万魔殿・宴会厅, P1163万魔殿・二层右走廊, P1153万魔殿・庭院
			RETURN P1169万魔殿・传送点
		CASE P1175堕落神殿・会客室, P1174堕落神殿・主教堂
			RETURN P1173堕落神殿・殿外
		CASE P1183冰雪世界・冰湖
			RETURN P1182冰雪世界・冰原
		CASEELSE
			RETURN P1105黄昏街
		ENDSELECT

	;最后是魔界都市，此类需要根据距离进行讨论，将万魔殿-黄昏街-传送点视为核心区，将其他区域依附在这些上，且将黄昏街视为高级节点
	CASE P1112船夫别墅区
		SELECTCASE 現在的位置
		;流光系
		CASE P1111渡鸦小区・小路, P1139渡鸦小区・6F电梯口, P1140渡鸦小区・6F走廊, P1141明罗宅・道场, P1145魔眼宅・仪式间, P1149矜羯罗宅・练功房
			RETURN P1110流光巷
		CASEELSE
			RETURN P1104万魔殿・仿
		ENDSELECT

	CASE P1110流光巷
		SELECTCASE 現在的位置
		;船夫别墅区因为已经是二级死胡同分支，作为汇集点已经不用讨论
		;流光子节点系
		CASE P1139渡鸦小区・6F电梯口, P1140渡鸦小区・6F走廊, P1141明罗宅・道场, P1145魔眼宅・仪式间, P1149矜羯罗宅・练功房
			RETURN P1111渡鸦小区・小路
		;先知系
		CASE P1109智者写字楼外, P1130智者写字楼・3F走廊, P1131朝仓研究室・准备室, P1133朝仓研究室・走廊
			RETURN P1108先知环形路
		CASEELSE
			RETURN P1104万魔殿・仿
		ENDSELECT

	CASE P1108先知环形路
		SELECTCASE 現在的位置
		;先知子节点系
		CASE P1130智者写字楼・3F走廊, P1131朝仓研究室・准备室, P1133朝仓研究室・走廊
			RETURN P1109智者写字楼外
		;流光系
		CASE P1111渡鸦小区・小路, P1139渡鸦小区・6F电梯口, P1140渡鸦小区・6F走廊, P1141明罗宅・道场, P1145魔眼宅・仪式间, P1149矜羯罗宅・练功房
			RETURN P1110流光巷
		;注意船夫别墅区需要归入万魔殿系
		CASE P1112船夫别墅区
			RETURN P1104万魔殿・仿
		CASEELSE
			RETURN P1105黄昏街
		ENDSELECT

	CASE P1104万魔殿・仿
		SELECTCASE 現在的位置
		;船夫别墅区因为已经是二级死胡同分支，作为汇集点已经不用讨论
		;先知系
		CASE P1109智者写字楼外, P1130智者写字楼・3F走廊, P1131朝仓研究室・准备室, P1133朝仓研究室・走廊
			RETURN P1108先知环形路
		;流光系
		CASE P1111渡鸦小区・小路, P1139渡鸦小区・6F电梯口, P1140渡鸦小区・6F走廊, P1141明罗宅・道场, P1145魔眼宅・仪式间, P1149矜羯罗宅・练功房
			RETURN P1110流光巷
		CASEELSE
			RETURN P1105黄昏街
		ENDSELECT

	CASE P1105黄昏街
		SELECTCASE 現在的位置
        ;黄昏子节点系
        CASE P1117星辰之家・5F走廊, P1116星辰之家・5F电梯口
            RETURN P1107星辰之家外
		;先知系
		CASE P1109智者写字楼外, P1130智者写字楼・3F走廊, P1131朝仓研究室・准备室, P1133朝仓研究室・走廊
			RETURN P1108先知环形路
		;流光系归入万魔殿系
		CASE P1111渡鸦小区・小路, P1139渡鸦小区・6F电梯口, P1140渡鸦小区・6F走廊, P1141明罗宅・道场, P1145魔眼宅・仪式间, P1149矜羯罗宅・练功房, P1110流光巷
			RETURN P1104万魔殿・仿
		;注意船夫别墅区需要归入万魔殿系
		CASE P1112船夫别墅区
			RETURN P1104万魔殿・仿
		CASEELSE
			RETURN P1101传送点
		ENDSELECT

	;说起来还是加一个ELSE吧，似乎是用于外出的
	CASEELSE
		RETURN P1101传送点
ENDSELECT

;
;这些函数可以按口上设置，但是custom_button_name、custom_talent等变量是角色变量。
;有多个口上的场合，如果直接辨别ID的话，会覆盖其他人的口上（当然，XXX作为自己的口上识别标志，绝对不会也不能重复）
;所以，要注意鉴别CFLAG:X:998是否是自己的口上编号
;
;该部分是4.920之后更新的，能给予口上自定义的更多接口



;================================
;统一SUCCESS函数
;如果与 com 对应的SUCCESS函数不存在，它将被调用
;你可以用它,在 com 之前进行一些数据处理。
;================================
;@M_KOJO_TPP_SUCCESS_K43_GENERAL



;================================
;统一EXTRASOURCE函数
;你可以用它,在某些 com 添加SOURCE补正
;请检测SELECTCOM
;================================
@M_KOJO_TPP_EXTRASOURCE_SCOM_K43_GENERAL
@M_KOJO_TPP_EXTRASOURCE_COM_K43_GENERAL

;================================
;自定义商店按钮
;Y 是按钮的编号，范围是0-9
;使用的时候请删除SKIPSTART～SKIPEND。
;================================
[SKIPSTART]
;判断按钮是否可以显示，如果返回1，则显示
@KOJO_TPP_CUSTOM_BUTTON_CONDITION_K43_Y
;custom_button_name:XX:Y = ボタンY
RETURN 1

;按钮被按下后，触发以下函数
@KOJO_TPP_CUSTOM_BUTTON_K43_Y

RETURN 1
[SKIPEND]

;================================
;自定义素质名
;使用的时候请删除SKIPSTART～SKIPEND。
;================================
[SKIPSTART]
@KOJO_TPP_CUSTOM_TALENT_SET_K43
;Z是素质ID，对应0～29
;如果这个变量不是0，就表示该素质
CUSTOM_TALENT:XX:Z = 1
;素質名
CUSTOM_TALENT_NAME:XX:Z = 自定义素质名
;(省略可)自定义素质的显示颜色，0/普通1/粉红2/红色+粗体
CUSTOM_TALENT_COLOR:XX:Z = 1
;(省略可)表示类别 1/種族 2/性的特徴 3/身体的特徴 4/精神的特徴 5/技術的特徴 他は「その他」
CUSTOM_TALENT_TYPE:XX:Z = 2
[SKIPEND]

;================================
;自定义指令
;Y 是自定义指令的编号，范围是0-29
;使用的时候请删除SKIPSTART～SKIPEND。
;================================
;指令名
@KOJO_TPP_COM_NAME_K43_1
RESULTS = 主动脱衣

;指令使用条件、和通常的com_able函数一样，如果返回1，指令就会显示为可执行。
@KOJO_TPP_COM_ABLE_K43_1
SIF !(TALENT:恋人 || TALENT:恋慕)   ;非恋人/恋慕，不能被其他人脱
    RETURN 0
SIF !(CFLAG:TARGET:诶嘿嘿 == 1 && TFLAG:COMABLE管理 == 2)   ;非男上位态不能脱
    RETURN 0
SIF Tequip:0 == 0 && Tequip:1 == 0   ;已经全裸了就用不着了
    RETURN 0
SIF FLAG:70 ;没有劲儿！这么怯懦还想解衣服！（震声）
    RETURN 0
RETURN 1

;指令数据处理。记述经验、参数增减
;RETURN 1=指令実行 / RETURN 0=部分取消(SOURCE計算SKIP) / RETURN -1=指令失败
@KOJO_TPP_COM_K43_1
RETURN 1

;指令的文本内容。地文/口上请写在这里
;W的値等于(270 + Y)。SELECTCOM/PREVCOM也会变化成这个值
@M_KOJO_TPP_MESSAGE_COM_K43_271
PRINTL
PRINTFORMDW 警告：该指令的口上部分尚未完成
PRINTFORML 「想帮我宽衣解带吗...可以的哦，来吧...」
PRINTFORMDW 看着华扇欲拒还迎的面容，%CALLNAME:MASTER%努力克制住自己的兽欲，伸出了自己的双手。
PRINTL
IF FIRSTTIME("43初次全脱34")
    IF TEQUIP:TARGET:上半身着衣状況 != 0 || TEQUIP:TARGET:下半身着衣状況 != 0
        IF TEQUIP:TARGET:上半身着衣状況 != 0
            PRINTFORMDL 将道袍从脖颈处解开，小心翼翼地摘下来，三两下叠好放到一边。
            IF OUTROOF(CFLAG:43:300)
                PRINTFORM 接着是鞋子，手指轻抚过大腿，“哒”的一声，解开华扇的
                IF DAY:2 == 4
                    PRINTFORMD 冬靴
                ELSE
                    PRINTFORMD 素足屐
                ENDIF
                PRINTFORMDW ，然后任其自由落体，露出华扇的一对玉足。
                PRINTFORMDW %CALLNAME:MASTER%不住地伸出手，轻轻抚摸着脚背，时不时还要用手指在华扇的足弓上揉动。
            ELSE
                PRINTFORMDW 接着%CALLNAME:MASTER%的手便攀上华扇身下的那对露出的玉足。
                PRINTFORMDW 轻轻地从脚背上掠过，时不时还要用手指在华扇的足弓上揉动。
            ENDIF
            PRINTFORMW 「哈啊，好痒...」
            PRINTFORMDL 到了这时候，%CALLNAME:MASTER%和华扇都已经是欲情难耐...
            PRINTFORMDW 但%CALLNAME:MASTER%还是决定将“仪式”继续下去，将目光又转回来了华扇的身体上。
            PRINTW 
        ENDIF
        IF TEQUIP:TARGET:下半身着衣状況 != 0
            PRINTFORMDW %CALLNAME:MASTER%首先盯上了华扇的那条绿裙子。
            PRINTFORMDL 扽住裙子的两边，略微用力，华扇的大腿根便跟着内裤一点点露了出来...
            PRINTFORMDL 一下，一下，又一下。裙子游过大腿，游过膝盖，最后在脚踝处完全脱落。
            PRINTFORMDW 抬头望去，仅剩下华扇的鼠蹊部，和那中间微微湿润的内裤...
            IF TEQUIP:TARGET:上半身着衣状況 != 0
                PRINTFORMDW 然后%CALLNAME:MASTER%的手又伸到了华扇的衬衫下摆。
                PRINTFORMDL 一颗，两颗，三颗...
                PRINTFORMDL 华扇胸口处的衬衫纽扣就这样被%CALLNAME:MASTER%从下到上逐渐解开。
                PRINTFORMDW 与此同时漏出的还有华扇不带一丝赘肉的腰肢，以及包裹着硕大乳房的内衣...
                PRINTFORMDW 随着最后一枚纽扣解开，%CALLNAME:MASTER%再也抑制不住自己的情绪。
                PRINTFORMDL 猛地将衬衫拉开，头压在两团大山的深沟处肆意呼吸。
                PRINTFORMDL 同时还不忘把两只手脱开，压在乳房两侧，一边肆意揉搓一边往自己脸部凑去。
                PRINTFORMDW 自己则不禁伸出舌头，舔舐着从内衣边缘溢出的柔软乳肉...
                PRINTFORMW 「哈啊～啊～%CALLNAME:MASTER%...太急了...」
                PRINTFORMDL 听到这句话的%CALLNAME:MASTER%理智才收回来一点。
                PRINTFORMDW ——倒不如说，一想到接下来的情节，%CALLNAME:MASTER%瞬间有了忍下去不享受的毅力...							
            ELSE
            PRINTFORMDL 更何况眼前人上身的衬衣已是在刚才的亲热中不知何时被褪去，仅剩下随着呼吸一翕一张的乳沟...
            PRINTFORMDW 一想到接下来将身下人彻底扒干净的快感，%CALLNAME:MASTER%不禁咽了口口水。
            ENDIF
        ELSE
            PRINTFORMW %CALLNAME:MASTER%的手伸到了华扇的衬衫下摆。
            PRINTFORMDL 一颗，两颗，三颗...
            PRINTFORMDL 华扇胸口处的衬衫纽扣就这样被%CALLNAME:MASTER%从下到上逐渐解开。
            PRINTFORMDW 与此同时漏出的还有华扇不带一丝赘肉的腰肢，以及包裹着硕大乳房的内衣...
            PRINTFORMDW 随着最后一枚纽扣解开，%CALLNAME:MASTER%再也抑制不住自己的情绪。
            PRINTFORMDL 猛地将衬衫拉开，头压在两团大山的深沟处肆意呼吸。
            PRINTFORMDL 同时还不忘把两只手脱开，压在乳房两侧，一边肆意揉搓一边往自己脸部凑去。
            PRINTFORMW 自己则不禁伸出舌头，舔舐着从内衣边缘溢出的柔软乳肉...
            PRINTFORMW 「哈啊～啊～%CALLNAME:MASTER%...太急了...」
            PRINTFORMDL 听到这句话的%CALLNAME:MASTER%理智才收回来一点。
            PRINTFORMDW ——倒不如说，一想到接下来的情节，%CALLNAME:MASTER%瞬间有了忍下去不享受的毅力...		
        ENDIF
    ENDIF
    IF (EQUIP:TARGET:上半身内衣１ != 0 || EQUIP:TARGET:上半身内衣２ != 0) || (EQUIP:TARGET:下半身内衣１ != 0 || EQUIP:TARGET:下半身内衣２ != 0)
        IF TEQUIP:TARGET:上半身着衣状況 == 0 && TEQUIP:TARGET:下半身着衣状況 == 0
            PRINTFORMDW 既然在刚才的亲热中外衣已尽数被褪去，那么接下来，自己与华扇的胴体间也就只剩这一层内衣了。
            PRINTFORM 这么想的
        ELSE
            PRINTW
        ENDIF
        IF EQUIP:TARGET:上半身内衣１ != 0 || EQUIP:TARGET:上半身内衣２ != 0
            PRINTFORMDL 先是将双手覆在了华扇的内衣上——当然，带着揩油的性质稍微揉了两下。
            PRINTFORMDW 然后，从内衣上开始，从前到后不住地摩挲、寻找——直到找到解开整个内衣的扣子。
            PRINTFORMDW 咔。
            PRINTFORMDL 扣子被打开。正面看去，华扇的那娇好双乳似乎又大了一点。
            PRINTFORMDL 华扇主动抬起腰部，这是...方便我把内衣摘下来吗。
            PRINTFORMDW %CALLNAME:MASTER%咽了下口水，最后还是下定决心，开奖似的把内衣这么一掀——
            PRINTFORMDW 哗啦。
            PRINTFORMDL 鲜嫩的乳肉、樱色的乳晕、因发情早就挺立起来的水滴状乳头...
            PRINTFORMDL 老实说%CALLNAME:MASTER%当时真就想兽性大发，直接一手一个乳房攥在手里，连揉带舔连嘬带咬。
            PRINTFORMDW 激得身下的华扇阵阵浪叫——当然，%CALLNAME:MASTER%还是知道没到真正上垒的时候，所以在心里暗暗忍了下来。
            PRINTFORMDL 再看华扇，初次经历此事的她已经是满脸通红。
            PRINTFORMDW 在%CALLNAME:MASTER%将内衣摘下来扔到一边的时候，华扇就已经用双臂遮住了自己的胸口。						
            IF EQUIP:TARGET:下半身内衣１ != 0 || EQUIP:TARGET:下半身内衣２ == 0
                PRINTFORMDW 当然%CALLNAME:MASTER%没管这个，此时的他，已经将双手抵到了华扇的腰肢两侧。
                PRINTFORMDL 抬起手肚，仅用指肚微微从上划过，静静感受着华扇的身躯微微发颤。
                PRINTFORMDL 直到手指抵达内裤的两端，这才停下来。
                PRINTFORMDW 华扇内裤的中心处已经被爱液打湿一大片了，如果凑近闻闻，似乎还能闻到恋爱特有的那股味道。
                PRINTFORMDL %CALLNAME:MASTER%肯定是没那兴致——双手轻巧地把住内裤两侧，然后开始略微施力。
                PRINTFORMDL 然后就像是刚才把裙子褪下去那样，开始将内裤一点点摘下来。
                PRINTFORMDW 直到内裤的那片湿润区域彻底和华扇的身体分离——
                PRINTFORMW 「呀啊！」
                PRINTFORMDL 一声娇吟，华扇的眼角处似是有点点泪花。这是在为自己最后的贞操失守而哭泣吗...
                PRINTFORMDW 而%CALLNAME:MASTER%抬头看去，然后看到了令自己终身难忘的一幕。
                PRINTFORMDL 那是怎样美丽的秘部啊...裂缝粉嫩异常，周边没有一根杂物，仔细看似乎能看到一些晶莹物质萦绕在裂缝周围...
                PRINTFORMDW %CALLNAME:MASTER%吞了口口水。今天这秘部，注定是要经受好一顿折腾了...
                PRINTFORMDL 不过现在不是想这个的时候。%CALLNAME:MASTER%继续把着那内裤，一点点扽了下去。
                PRINTFORMDW 一样的游过大腿，游过膝盖，最后在脚踝处完全脱落，跟着裙子和裙子下的那双屐堆在了地上。	
            ELSE
                PRINTFORMDL 只是这般反抗在面对%CALLNAME:MASTER%的哪怕轻轻一推时也是无济于事。
                PRINTFORMDW 唯一的效果似乎也只是激起了%CALLNAME:MASTER%的施虐欲——当然，也仅限于推开手臂后往华扇的乳头处轻轻一挑。
                PRINTFORMW 「咿！」
                PRINTFORMDL 伴随着华扇的惊呼，她那早已裸露在空气中的光洁裂缝也渗出了点点晶莹物质...
                PRINTFORMDW 到底是刚才亲热的时候褪下去的还是说她是真空出门呢...%CALLNAME:MASTER%如是想着。
            ENDIF
        ELSE
            PRINTFORMDW %CALLNAME:MASTER%抬起手，然后用指肚轻轻触碰到华扇裸露的乳房上侧。
            PRINTFORMDL 但并没有华扇预想中的乳房揉搓——取而代之的是一点点向华扇的下身划去。
            PRINTFORMDW 从锁骨到乳肉，到乳头边缘，再到乳根，再到华扇的腰肢。
            PRINTFORMDL 意识到什么的华扇双唇紧闭，身躯也开始微微发颤。
            PRINTFORMDW 默默感受着这一切的%CALLNAME:MASTER%直到手指抵达华扇内裤的两端，这才停下来。
            PRINTFORMDW 华扇内裤的中心处已经被爱液打湿一大片了，如果凑近闻闻，似乎还能闻到恋爱特有的那股味道。
            PRINTFORMDL %CALLNAME:MASTER%肯定是没那兴致——双手轻巧地把住内裤两侧，然后开始略微施力。
            PRINTFORMDL 然后就像是刚才把裙子褪下去那样，开始将内裤一点点摘下来。
            PRINTFORMDW 直到内裤的那片湿润区域彻底和华扇的身体分离——
            PRINTFORMW 「呀啊！」
            PRINTFORMDL 一声娇吟，华扇的眼角处似是有点点泪花。这是在为自己最后的贞操失守而哭泣吗...
            PRINTFORMDW 而%CALLNAME:MASTER%抬头看去，然后看到了令自己终身难忘的一幕。
            PRINTFORMDL 那是怎样美丽的秘部啊...裂缝粉嫩异常，周边没有一根杂物，仔细看似乎能看到一些晶莹物质萦绕在裂缝周围...
            PRINTFORMDW %CALLNAME:MASTER%吞了口口水。今天这秘部，注定是要经受好一顿折腾了...
            PRINTFORMDL 不过现在不是想这个的时候。%CALLNAME:MASTER%继续把着那内裤，一点点扽了下去。
            PRINTFORMDW 一样的游过大腿，游过膝盖，最后在脚踝处完全脱落，跟着裙子和裙子下的那双屐堆在了地上。
        ENDIF
    ENDIF
    PRINTW 
    PRINTFORMW 「啊...」
    PRINTFORMDL 玉体横陈的华扇看起来已经彻底臊得彻底说不出来话了。
    PRINTFORMDL 不过，待到%CALLNAME:MASTER%将脸探向华扇，她还是张开双臂，轻轻地抱住了%CALLNAME:MASTER%。
    PRINTFORMDW 也不管已经在空气中暴露许久的双乳如何摩擦%CALLNAME:MASTER%的胸膛，或者那秘处和%CALLNAME:MASTER%的阳具如何接近。
    PRINTFORML 「我的胴体...就这么被看了个遍...」
    PRINTFORMW 「这具胴体只为你显露哦，%CALLNAME:MASTER%...作为回报，要好好地报答我呢...」
    PRINTFORMDL 说罢，华扇将额头和%CALLNAME:MASTER%的额头互相抵住。
    PRINTFORMDW 感受着胸前的两团硕大乳饼，%CALLNAME:MASTER%感觉自己的兽欲已经要压不住了...
	CALL CTRL_CLOTHES_SET(43, "現在衣装の変更_全裸")
	CALL CLOTHES_SETTING_TRAIN(43)
ENDIF
RETURN 1

;指令实行的可能判定
;可以在实行指令前显示一个条件实行可否的权重比较，并且
;可以参考 @CAN_COM9(ARG)，不能实行时请RETURN 0 ，允许实行时RETURN 1 
;或者可以不用写这部分
;@KOJO_TPP_CAN_COM_K43_Y(skipFlag)
;	#DIM skipFlag
;	SKIPDISP skipFlag
;	SKIPDISP 0


;================================
;加载游戏时会自动读取以下函数并更新
;如果您的kojo无需持续更新，请忽略它
;;================================
;@KOJO_TPP_VERSION_K43
	;返回当前口上的版本数
	; RETURN now_version

;当存档记录的变量CFLAG:kojo_version比上面的口上版本号低，即为旧版本的时候，此处将调用
;@KOJO_TPP_VERSION_UPDATE_K43
	;
	; RETURN now_version

;================================
;自定义移动倾向以及特殊食物
;这部分可用于自定义口上移动倾向和独有食材
;它会完全覆盖原版设置，因此仅在启用的时候取消注释
;此处以灵梦原版的移动倾向为例子
;------------------------------------------------------------
[SKIPSTART]
@M_KOJO_TPP_CHECK_K43_CHARADATA(ARGS,ARG,ARG:2)
SELECTCASE ARGS 
    ;移动倾向自定义
    CASE "MOVE"
        SELECTCASE ARG
            ;連動設定（RETURN=依存するキャラ, RESULT:1～3=対等に連動するキャラ）
            CASE 1
            ;特殊生活時間設定（CFLAG:LOCAL:生活時間補正を設定する）
            CASE 3
            ;移動傾向（±～10=是可能移动的权重值, -100=绝对不会前往）
            CASE 4
                SELECTCASE ARG:2
                    ;よく居る
                    ;CASE P2境内, P10縁側
                    ;    RETURN 5
                    ;他所
                    ;CASE P30三妖精の家・風呂, P39夢幻遺跡・浴室, P56あうんの棲家
                    ;    RETURN -100
                    ;addition custom code, kourindou
                    ;CASE P502香霖堂
                    ;    RETURN 3
                ENDSELECT
            ;出現場所
            CASE 7
                SELECTCASE ARG:2
                    ;CASE 桜並木の鳥居, 神社境内, 神社本堂, 神社縁側
                    ;    RETURN 1
                    ;CASE 広場, 商家町, 呑屋小道, 長屋街
                    ;    RETURN 1
                    ;addition custom code, kourindou
                    ;CASE 香霖堂
                    ;    RETURN 1
                ENDSELECT
            ;引力設定（CFLAG:LOCAL:引力点を設定する）
            CASE 8
        ENDSELECT

		;我试图更改名为“角色数据”的设置，但失败了。
		;似乎需要进行彻底的更改。很抱歉我无法构建这些。

	;角色特殊料理
	CASE "SPECIAL_MENU"
		;DISH_NAME = 红白馒头
		;RESULTS = 甜点
		;CALL 材料設定("甜味料")
		;DISH_TASTE = 和食/饅頭/甜/上品/芸術的/软糯的/祝福/
		;DISH_COMMENT = 庆祝喜事时食用的喜庆馒头。具有[祝福]的效果。
		;RETURN 1
ENDSELECT
[SKIPEND]




@M_KOJO_EXTRASOURCE_COM_K140_312
#DIM CHK
LOCAL = TARGET
;模拟选择可能判定@COM_ABLE
;没有第二人，前一指令不是该指令
SIF GET_TARGETNUM() == 1 || PREVCOM != SELECTCOM
	RETURN
;前一回合发生了该指令，且对象不是口上主
SIF TFLAG:103 == LOCAL
	RETURN
;针对第二人状态的检测条件从这里开始，例如最基本的，检测第二人的小穴或肛门是否繁忙中.该指令时会完全解除其他占用，所以不需要
CHK = TFLAG:103
;SIF TEQUIP:CHK:50 == PLAYER || TEQUIP:CHK:51 == PLAYER
;	RETURN 

;模拟指令的特殊判定部分 限定特殊指令要满足怎样的条件；例如限定角色的素质等级陷落状态、或限定只有和某些关系良好的角色才会触发
;使用TFLAG:193同时记录成功标志与搭档编码
SIF !((GROUPMATCH(CHK, [[文]],42,[[椛]],[[典]],[[百百世]]) && TALENT:恋慕 && (TALENT:CHK:恋慕 ||TALENT:CHK:恋人)))
	RETURN
TARGET = CHK
CALLFORM COM_ABLE{SELECTCOM}
IF !RESULT
	TARGET = LOCAL
	RETURN
ENDIF
;-----------------------------------
;判定部分结束，接下来模拟SCOM本体，让COMBO指令发生
CALLFORM COM{SELECTCOM}
TIME -= 5
TARGET = LOCAL
IF HETEROSEX(TARGET, CHK) == 1
	EXP:LOCAL:百合経験 += 1
	EXP:CHK:百合経験 += 1
	EXP:LOCAL:奉仕快楽経験 += 2
	EXP:CHK:奉仕快楽経験 += 2
	EXP:LOCAL:愛情経験 += 1
	EXP:CHK:愛情経験 += 1
	;用TFLAG:194作为原本193的大成功或大失败检定；或者呼出特殊文本。暂时不需要
	;IF GROUPMATCH(CHK, 76, 80, 129) && !RAND:4
	;	EXP:140:百合経験 += 6
	;	EXP:CHK:百合経験 += 6
	;	TFLAG:194 = 1
	;ENDIF
ENDIF
TFLAG:194 = CHK
TCVAR:30 ++
TCVAR:CHK:30 ++
RETURN
@M_KOJO_EXTRASOURCE_COM_K139_312_1
#DIM CHK
LOCAL = TARGET
;模拟选择可能判定@COM_ABLE
;没有第二人，前一指令不是该指令
SIF GET_TARGETNUM() == 1 || PREVCOM != SELECTCOM
	RETURN
;前一回合发生了该指令，且对象不是口上主
SIF TFLAG:103 == LOCAL
	RETURN
;针对第二人状态的检测条件从这里开始，例如最基本的，检测第二人的小穴或肛门是否繁忙中
CHK = TFLAG:103
;SIF TEQUIP:CHK:50 == PLAYER || TEQUIP:CHK:51 == PLAYER
;	RETURN 

;模拟指令的特殊判定部分 限定特殊指令要满足怎样的条件；例如限定角色的素质等级陷落状态、或限定只有和某些关系良好的角色才会触发
;使用TFLAG:193同时记录成功标志与搭档编码
SIF !((GROUPMATCH(CHK, [[文]],42,[[椛]],[[龙]]) && TALENT:恋慕 && (TALENT:CHK:恋慕 ||TALENT:CHK:恋人)))
	RETURN
TARGET = CHK
CALLFORM COM_ABLE{SELECTCOM}
IF !RESULT
	TARGET = LOCAL
	RETURN
ENDIF
;-----------------------------------
;判定部分结束，接下来模拟SCOM本体，让COMBO指令发生
CALLFORM COM{SELECTCOM}
TIME -= 5
TARGET = LOCAL
IF HETEROSEX(TARGET, CHK) == 1
	EXP:LOCAL:百合経験 += 1
	EXP:CHK:百合経験 += 1
	EXP:LOCAL:奉仕快楽経験 += 2
	EXP:CHK:奉仕快楽経験 += 2
	EXP:LOCAL:愛情経験 += 1
	EXP:CHK:愛情経験 += 1
	;用TFLAG:194作为原本193的大成功或大失败检定；或者呼出特殊文本。暂时不需要
	;IF GROUPMATCH(CHK, 76, 80, 129) && !RAND:4
	;	EXP:140:百合経験 += 6
	;	EXP:CHK:百合経験 += 6
	;	TFLAG:194 = 1
	;ENDIF
ENDIF
TFLAG:194 = CHK
TCVAR:30 ++
TCVAR:CHK:30 ++
RETURN

@ASSISTANT_KOJO_COM312
SIF TFLAG:103 != TFLAG:104 && PREVCOM == SELECTCOM && CFLAG:(TFLAG:103):同室
CALL KOJO_MESSAGE_SEND("COMMAND_ASSISTANT",-1,TFLAG:103,-1,-1)
@M_KOJO_MESSAGE_COM_K140_312_2
IF TFLAG:104 == 139
	TFLAG:194 = TFLAG:104
	PRINTL
	IF TFLAG:102 == 1
		PRINTFORMDL 接着%CALLNAME:MASTER%把龙也搂进怀中，在三人之间交换激烈的吻
	ELSEIF TFLAG:102 == 3
		PRINTFORMDL 接着龙也叩开%CALLNAME:MASTER%的嘴唇，三人不甘示弱地交换着激烈的吻
	ENDIF
	PRINTL
	CALL M_KOJO_MESSAGE_COM_K140_312_1
ENDIF
RETURN RESULT
[SKIPSTART]
@M_KOJO_EXTRASOURCE_COM_K140_85
#DIM CHK
LOCAL = TARGET
;模拟选择可能判定@COM_ABLE
;没有第二人，前一指令不是该指令
SIF GET_TARGETNUM() == 1 || PREVCOM != SELECTCOM
	RETURN
;前一回合发生了该指令，且对象不是口上主
SIF GROUPMATCH(MASTER_POSE(8, 1, 1), 0, LOCAL)
	RETURN
;针对第二人状态的检测条件从这里开始，例如最基本的，检测第二人的小穴或肛门是否繁忙中.该指令时会完全解除其他占用，所以不需要
CHK = MASTER_POSE(8, 1, 1)
;SIF TEQUIP:CHK:50 == PLAYER || TEQUIP:CHK:51 == PLAYER
;	RETURN 

;模拟指令的特殊判定部分 限定特殊指令要满足怎样的条件；例如限定角色的素质等级陷落状态、或限定只有和某些关系良好的角色才会触发
;使用TFLAG:193同时记录成功标志与搭档编码
SIF !(GROUPMATCH(CHK, [[文]],42,[[椛]],[[典]],[[百百世]]) && TALENT:恋慕 && (TALENT:CHK:恋慕 ||TALENT:CHK:恋人))
	RETURN
;对于该指令，就简单地，令第二人的状态是可以实施该指令指令的状态即可
;但是，COM检验依赖TARGET，要暂时更改TARGET，因此将它放在最后一个检验
;SIF TEQUIP:CHK:50 == PLAYER || TEQUIP:CHK:51 == PLAYER
;	RETURN
TARGET = CHK
CALLFORM COM_ABLE{SELECTCOM}
IF !RESULT
	TARGET = LOCAL
	RETURN
ENDIF
;-----------------------------------
;判定部分结束，接下来模拟SCOM本体，让COMBO指令发生
CALLFORM COM{SELECTCOM}
TARGET = LOCAL
IF HETEROSEX(TARGET, CHK) == 1
	EXP:LOCAL:百合経験 += 1
	EXP:CHK:百合経験 += 1
	EXP:LOCAL:奉仕快楽経験 += 2
	EXP:CHK:奉仕快楽経験 += 2
	EXP:LOCAL:愛情経験 += 1
	EXP:CHK:愛情経験 += 1
	;用TFLAG:194作为原本193的大成功或大失败检定；或者呼出特殊文本。暂时不需要
	;IF GROUPMATCH(CHK, 76, 80, 129) && !RAND:4
	;	EXP:140:百合経験 += 6
	;	EXP:CHK:百合経験 += 6
	;	TFLAG:194 = 1
	;ENDIF
ENDIF
TFLAG:193 = CHK
RETURN
@M_KOJO_EXTRASOURCE_COM_K140_85
#DIM CHK
LOCAL = TARGET
;模拟选择可能判定@COM_ABLE
;没有第二人，前一指令不是该指令
SIF GET_TARGETNUM() == 1 || PREVCOM != SELECTCOM
	RETURN
;前一回合发生了该指令，且对象不是口上主
SIF GROUPMATCH(MASTER_POSE(8, 1, 1), 0, LOCAL)
	RETURN
;针对第二人状态的检测条件从这里开始，例如最基本的，检测第二人的小穴或肛门是否繁忙中.该指令时会完全解除其他占用，所以不需要
CHK = MASTER_POSE(8, 1, 1)
;SIF TEQUIP:CHK:50 == PLAYER || TEQUIP:CHK:51 == PLAYER
;	RETURN 

;模拟指令的特殊判定部分 限定特殊指令要满足怎样的条件；例如限定角色的素质等级陷落状态、或限定只有和某些关系良好的角色才会触发
;使用TFLAG:193同时记录成功标志与搭档编码
SIF !(GROUPMATCH(CHK, [[文]],42,[[椛]],[[典]],[[百百世]]) && TALENT:恋慕 && (TALENT:CHK:恋慕 ||TALENT:CHK:恋人))
	RETURN
;对于该指令，就简单地，令第二人的状态是可以实施该指令指令的状态即可
;但是，COM检验依赖TARGET，要暂时更改TARGET，因此将它放在最后一个检验
;SIF TEQUIP:CHK:50 == PLAYER || TEQUIP:CHK:51 == PLAYER
;	RETURN
TARGET = CHK
CALLFORM COM_ABLE{SELECTCOM}
IF !RESULT
	TARGET = LOCAL
	RETURN
ENDIF
;-----------------------------------
;判定部分结束，接下来模拟SCOM本体，让COMBO指令发生
CALLFORM COM{SELECTCOM}
TARGET = LOCAL
IF HETEROSEX(TARGET, CHK) == 1
	EXP:LOCAL:百合経験 += 1
	EXP:CHK:百合経験 += 1
	EXP:LOCAL:奉仕快楽経験 += 2
	EXP:CHK:奉仕快楽経験 += 2
	EXP:LOCAL:愛情経験 += 1
	EXP:CHK:愛情経験 += 1
	;用TFLAG:194作为原本193的大成功或大失败检定；或者呼出特殊文本。暂时不需要
	;IF GROUPMATCH(CHK, 76, 80, 129) && !RAND:4
	;	EXP:140:百合経験 += 6
	;	EXP:CHK:百合経験 += 6
	;	TFLAG:194 = 1
	;ENDIF
ENDIF
TFLAG:193 = CHK
RETURN
[SKIPEND]

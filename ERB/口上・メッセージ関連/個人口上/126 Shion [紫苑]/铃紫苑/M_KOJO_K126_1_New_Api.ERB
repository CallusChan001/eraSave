;确定环境为4.972，为匹配CHECK模板的更新而翻译自of_new_kojo_api.ERB
;================================
;这些函数可以由剧本进行设置，但 custom_button_name、custom_talent 等变量是角色变量，
;如果存在多个剧本，注意修改成自己的ID，请注意。

;SUCCESS的通用版
;注意，只有当COM对应的SUCCESS函数不存在，它才将被调用
;你可以用它在COM之前进行一些数据处理
;@M_KOJO_XXX_SUCCESS_KX_GENERAL

;EXTRASOURCE的通用版，同上
;@M_KOJO_XXX_EXTRASOURCE_SCOM_KX_GENERAL
;@M_KOJO_XXX_EXTRASOURCE_COM_KX_GENERAL

;================================
;自定义商店按钮
;y是按钮的ID，对应0~9
;使用时请移除SKIPSTART~SKIPEND。
;================================
[SKIPSTART]
;如果RETURN 1，按钮就会显示
@KOJO_XXX_CUSTOM_BUTTON_CONDITION_KX_Y
custom_button_name:XX:Y = 选项Y
RETURN 1

;如果按钮被点击
@KOJO_XXX_CUSTOM_BUTTON_KX_Y

RETURN 1
[SKIPEND]

;================================
;自定义素质
;使用时请移除SKIPSTART~SKIPEND。
;================================
[SKIPSTART]
@KOJO_XXX_CUSTOM_TALENT_SET_KX
;Z是素质ID，对应0~29
;如果此变量不为0则显示
CUSTOM_TALENT:XX:Z = 1
;素质名
CUSTOM_TALENT_NAME:XX:Z = 色情素质
;(省略可)自定义素质的显示颜色 示例是红色
CUSTOM_TALENT_COLOR:XX:Z = 0xFF0000
;(省略可)显示的类别 1/种族 2/性特征 3/身体特征 4/精神特征 5/技术特征 其他为“其他”
CUSTOM_TALENT_TYPE:XX:Z = 2
[SKIPEND]

;================================
;自定义指令，可设置0~29号
;使用时请移除SKIPSTART~SKIPEND。
;================================
;指令名
;==================================================
;270,摸摸脚
;==================================================
@KOJO_铃紫苑_COM_NAME_K126_0
#LOCALSIZE 1
#LOCALSSIZE 1
    RESULTS = 摸摸脚
;其实根本就是吃脚
;指令执行内容。描述经验值和参数的增减，与通常的@COM函数相同
@KOJO_铃紫苑_COM_K126_0
#LOCALSIZE 1
#LOCALSSIZE 1
	RETURN 1
;指令使用条件，与通常的@COM_ABLE函数相同，如果RETURN 1则指令显示为可执行
@KOJO_铃紫苑_COM_ABLE_K126_0
#LOCALSIZE 1
#LOCALSSIZE 1
	SIF !TFLAG:100
		RETURN 0
	;一括管理
	SIF GLOBAL_COMABLE(315)
		RETURN RESULT
	;时间停止中以及潜伏诶嘿嘿时跳过
	IF (!FLAG:70 || CFLAG:344 == 1) && !GETBIT(CFLAG:526,0)
		;亲热強度2
		SIF (TCVAR:MASTER:亲热 < 2)  && CFLAG:睡眠 == 0
			RETURN 0
		;睡眠中
		SIF CFLAG:睡眠 && !CFLAG:恶作剧
			RETURN 0
		;陪睡中
		SIF CFLAG:陪睡中
			RETURN 0
		;仕事中
		SIF CFLAG:行動 == 5
			RETURN 0
		;约会中
		SIF CHK_DATENOW(CFLAG:约会中) && CFLAG:現在位置 != OMANEKIBEYA()
			RETURN 0
		;甲斐性無しにそんな度胸はない
		SIF FLAG:甲斐性無 && !CFLAG:诶嘿嘿
			RETURN 0
	ENDIF
	;気力0
	SIF BASE:MASTER:気力 <= 0
		RETURN 0
	;腕使用中
	SIF TFLAG:61 && MASTER_POSE(SET_C,3) != TARGET && MASTER_POSE(SET_P,SET_YUBI) != TARGET && MASTER_POSE(SET_V,SET_YUBI) != TARGET && MASTER_POSE(SET_A,SET_YUBI) != TARGET
		RETURN 0
	SIF GETBIT (TCVAR:26,5)
		RETURN 0
	RETURN 1


;指令消息。描述指令的情景文本，
;W的值是(270 + Y)。SELECTCOM/PREVCOM会代入此值
@M_KOJO_铃紫苑_MESSAGE_COM_K126_270
#LOCALSIZE 1
#LOCALSSIZE 1
IF (TALENT:126:3 || TALENT:126:8) && CFLAG:126:300 == CFLAG:126:311 && FIRSTTIME("虽然很怪，但思慕这里只有一个事件，其他什么都没有")
	PRINTFORMDL 紫苑对你突然提出的要求感到非常困惑的样子。
	PRINTFORML 「等等，为什么就突然变成这种情况了啊？」
	PRINTFORMW 「这是很正常的侍奉…不是性骚扰？唔……到底是不是真的啊？话说，%CALLNAME:MASTER%你什么时候变得这么殷勤了。」 
	PRINTFORML 「知道了知道了！我照你说的做总行了吧……」 
	PRINTFORMDL 你终于还是说服了紫苑。
	PRINTFORMDL 她害羞地捂住脸，怯生生地把那双小巧的玉足伸了过来。
	PRINTFORMDL 那双小脚如凝脂般白皙，细腻柔软，指尖轻轻一触，脚趾便娇怯地微缩回去，露出下面粉红的脚掌，这番景象让你不免咽了一下口水。
	PRINTFORML 「快……快点吧。」
	PRINTFORMDL 另一边，紫苑已经羞耻地快冒烟了。
	PRINTFORMDL 那么你要怎么做呢？
	CALL ASK_YN("不捉弄紫苑，正常地按摩","按摩的同时整点不正经的")
	IF !RESULT
		PRINTFORMDL ——
		PRINTFORMDL 你轻轻捧起紫苑的小脚，拇指上下移动，力度均匀地按压着脚心。
		PRINTFORML 「唔……嗯……啊咧？好像还挺舒服的？」
		PRINTFORMDW 紫苑从手指缝里露出眼睛，有些惊讶地说道。
		PRINTFORML 「诶？啊啊，说的也是呢，对不起%CALLNAME:MASTER%…我错怪你了。」
		PRINTFORMDL 紫苑变得晕乎乎的了。
		PRINTFORML 「哦……哦」
		PRINTFORMDL 紫苑有些犹豫地放松了紧绷的身体，放任你对她的脚为所欲为。
		PRINTFORMDL 你也确实没干什么奇怪的事，安分地完成了整套按摩。但这不意味着你没有占到便宜。
		PRINTFORMDL 这十分钟里，你时而轻揉趾缝，时而轻掐脚跟，可谓吃足了豆腐。
		PRINTFORMDW 顺带一提紫苑在第三分钟以后就彻底陷落了，一副舒服到失神的表情不知道在想什么。
		PRINTFORMDL 时间到了以后，你使坏地将手指从少女的足底滑到了脚尖
		PRINTFORML 「咿——！」
		PRINTFORMDL 紫苑这下可是羞的够呛，她差点就要翻起身敲你的头了，你哄了好一会才把她安抚好。
		PRINTFORMDL ……？
		PRINTFORMDL 她作势将手放在嘴边咳了几声，轻吐一句。
		PRINTFORMW 「嘛…总体还算舒服吧。」
	ELSE
		PRINTFORMDL ——
		PRINTFORML 「要帮我做高级的护理？」
		PRINTFORMDL 尽管有些迟疑，但她还是点了点头。
		PRINTFORML 「好吧，既然你都这么说了……。」
		PRINTFORML 「很早以前就想问了，扫把也好茶具也好，你怎么什么都能从背后拿出来啊。」
		PRINTFORMDL 你将一条微湿的毛巾轻柔地覆在了紫苑的面颊上。
		PRINTFORML 「……%CALLNAME:MASTER%？」
		PRINTFORMDL 当视野被遮蔽，紫苑的声音也褪去了平时的装腔作势，柔弱地吐出了自己的心声。
		PRINTFORMW 「不要对我那么粗暴，好吗……？」
		CALL ASK_YN("温柔地对待紫苑","粗暴地对待紫苑")
		IF !RESULT
			PRINTFORMDL 她轻颤的身体映入眼帘，你伸手揉了揉她的脑袋，直到她不再紧张为止一直耐心安慰她。
			PRINTFORML 「……谢谢你，%CALLNAME:MASTER%。」
			PRINTFORMDL 待紫苑的情绪稳定下来，你方才开始按摩：双手轻叠，指腹贴在太阳穴上，打圈的同时轻柔地按压……
			PRINTFORMDL 轻托她的腰背，缓缓将她翻身成趴姿，沿着脊柱一点一点松弛僵硬的肌肉……
			PRINTFORMDL 随着你的节奏放缓，紫苑的呼吸也渐渐加深。
			PRINTFORMDW ……差不多已经可以了吧？
			PRINTFORMDL 你深吸一口气，紧张地偷看了一眼紫苑的睡颜，确定她已经熟睡。小心翼翼地，你捧起了那双你垂涎已久的玉足。
			PRINTFORMDL 从闪着粉红色光泽的脚趾，到白嫩软糯的足心，每一寸肌肤都在向你发出致命的诱惑。
			PRINTFORMDL 你用鼻子轻轻蹭了蹭她的足弓，嗅到一股淡淡的甜香，像是甜橘的味道。
			PRINTFORMDL 再也无法自制，你低下头，在她的脚底轻舔了一下。
			PRINTFORMDL 接着你明显感觉到紫苑的身体颤了一颤，这下几乎让你心脏骤停
			PRINTFORML 「%CALLNAME:MASTER%，你到底在……？」
			PRINTFORMDL ……
			PRINTFORMDL 她不再言语，你暗暗松了口气，却也感到一阵失落。
			PRINTFORMDW 唉……
			PRINTFORMDL 忽然，她轻声说道：「可以哦。」
			PRINTFORMDL 你惊得愣在了原地，脑中一片空白。
			PRINTFORMDL 她羞红了脸，把头埋进枕头：
			PRINTFORML 「所以说…想做什么，就做吧……」
			PRINTFORML 「看在你刚才那么温柔的份上，我不会抗拒的。」
			PRINTFORMDL 得偿所愿恐怕说的就是这种情况吧。
			PRINTFORMDW 你俯下身吻了吻紫苑的脚心，舌尖不时在她的脚底游走。
			PRINTFORMDL 确认她不会抗拒以后，你更是大胆地将她的脚趾含进嘴里轻轻吮吸了起来。
			PRINTFORML 「等等，再怎么说那个也太……啊！」
			PRINTFORMDL ……
			PRINTFORMDL 十几分钟后，紫苑坐起身，双脚羞涩地交叉，你跪坐在地板上，空气中弥漫着尴尬的沉默。
			PRINTFORML 「没想到下仆你还有这种兴趣……」
			PRINTFORML 「听好了，整个幻想乡里能接受你这种特殊兴趣的只有我。」
			PRINTFORMW 「所以……你只要看着我就够了，绝对不要去找别的女孩子丢人现眼哦！」
		ELSE
			PRINTFORMDW 太过得意忘形的你被紫苑讨厌了……
		ENDIF
	ENDIF
	RETURN 1
ENDIF
IF TALENT:126:3
	IF PALAM:126:11 >= PALAMLV:9 && !RAND:2;欲情高于9的时候概率触发
		SELECTCASE RAND:3
			CASE 0
			PRINTFORMDL 你将紫苑光洁的脚踝握在手中，她有些失神地看着你，并未反抗。
			PRINTFORMDL 于是你的舌尖，带着温热的湿意，从她小巧的脚跟开始，沿着那道优美紧致的足弓曲线，缓慢而坚定地舔舐了上去。
			PRINTFORMDW 你听到她喉咙深处发出一声被截断的惊喘，脚趾猛地蜷缩起来。
			CASE 1
			PRINTFORMDL 她发出一声像是呜咽的「呀」，在你将她的大脚趾整个含入口中的瞬间。她的身体猛地绷直。
			PRINTFORMDL 你用舌头在温热的口腔中用力搅动、吸吮着那根小巧的脚趾，湿润的水声在空间中显得格外清晰。
			PRINTFORMDL 你感觉到她抓着你衣服的手在不住地颤抖，口中断断续续地溢出不成调的呻吟
			PRINTFORMW 「哈啊……不……不行……那里……」
			CASE 2
			PRINTFORML 「%CALLNAME:MASTER%真是…太下流了，对这样的%CALLNAME:MASTER%，要给一些惩罚才行。」
			PRINTFORMDL 紫苑坐在凳子上，纤细的双腿因羞涩而微微颤抖。但最终，她还是逞强地抬起双脚，并拢，用脚掌夹住了你的脸。
			PRINTFORMDL 你的视野被她光裸的小腿和粉红的脚心占据，脚底的皮肤因紧张而蒸腾出的、独特的温热香气被你吸入鼻中。
			PRINTFORMDL 脸颊能清晰感受到她足底皮肤的温热与柔软的纹理。
			PRINTFORMW 「怎…怎么样？整张脸都被足底夹住的感觉！」
		ENDSELECT
	ELSE
		;带派
		SELECTCASE RAND:7
			CASE 0
			PRINTFORML 「想摸……我的脚吗？」
			PRINTFORML 「可以哦。」
			PRINTFORMDL 紫苑找到合适的位置坐下，尽管显得有些局促，但她还是顺从地将小脚伸到了你面前。
			PRINTFORMW 「……请」
			PRINTFORMDL 她的小脚很美，娇俏的形状很适合握在手中把玩，脚心嫩嫩的，一点死皮都没有。
			PRINTFORMDL 你的胸中悸动难抑，手指穿过那一根根脚趾，与其紧紧相扣在了一起，手掌紧紧贴合着足心的柔软，将有着优美曲线的足弓收入其中。
			PRINTFORML 「唔……嗯……」
			PRINTFORMDW 为了让你能够放心享受，紫苑竭力将羞耻感压了下去，一直保持着伸出脚的姿势。
			CASE 1
			PRINTFORML 「……嗯」
			PRINTFORMDL 得到紫苑的首肯，你温柔地捧起了少女粉嫩的小脚，将脸凑过去
			PRINTFORML 「唔…这就是人们常说的性癖对吧？不……我不觉得奇怪或者讨厌哦，倒不如说，%CALLNAME:MASTER%能这么喜爱我的…额身体的一部分也挺让我开心的哈哈，总之……%CALLNAME:MASTER%自便就好。」
			PRINTFORMDL 你用鼻子蹭了蹭紫苑柔软的脚底，慢慢舔过她优美的足弓，在那娇小的脚趾头上一吻，然后将脚趾头整个含住，吞吐吸吮起来。
			CALL HPH_PRINT,@"「嗯～～这样……有点痒…啊HPH」","W"
			CASE 2
			PRINTFORMDL 你将自己的脸贴在紫苑柔软的脚心处，贪婪地嗅吸着气味。
			PRINTFORMDL 紫苑平时要么完全不穿鞋飘着，要么就只穿一双拖鞋啪嗒啪嗒地到处走。
			PRINTFORMDL 所以那白白嫩嫩的脚掌完全没有异味，不仅如此，还散发着一股诱人的肉香。
			PRINTFORMW 「实在……想不到会闻得这么直接啊。」
			CASE 3
			PRINTFORML 「如果%CALLNAME:MASTER%会因为这个高兴的话……」
			PRINTFORMDL 紫苑脸红得好像要滴血。她缓缓将脚伸向了你，脚趾因为紧张而微微蜷缩。
			PRINTFORMDL 当你的舌尖初次触碰到她娇嫩的脚趾时，她的整个身体都颤了一下。
			PRINTFORMDL 温热湿润的触感让她忍不住发出细微的呻吟。
			PRINTFORMW 「等……那里……」
			PRINTFORMDL 你开始仔细舔舐她每一根脚趾，舌头灵活地在脚趾缝隙间穿梭，品尝着她肌肤独有的甜腻味道。紫苑的呼吸变得急促，她紧咬下唇想要压抑声音。
			PRINTFORMDL 于是你更进一步，将她粉嫩的大脚趾整个含入了口中，舌头在其周围煽情地搅动着。
			PRINTFORMW 「呜……我的脚趾，被%CALLNAME:MASTER%好认真地吸着。」
			CASE 4
			PRINTFORML 「%CALLNAME:MASTER%……真的要舔我的脚吗？」紫苑的声音细如蚊呐，她慢慢将双脚放在你面前，脚趾羞涩地蜷缩着。
			PRINTFORMDL 你从她精致的脚背开始，舌头缓缓划过每一寸肌肤。当到达她娇嫩的脚心时，你故意放慢了速度，让温热的舌头在那最敏感的软肉上反复游移。
			PRINTFORML 「嗯啊……」
			PRINTFORMDL 紫苑忍不住发出甜腻的呻吟，她的腰肢因为强烈的刺激而微微弓起。
			PRINTFORMDL 你往上专注于她的脚趾，将每一根都仔细含入口中。舌头在她大脚趾周围打转，时而轻舔，时而用力地搅动。
			PRINTFORMDL 紫苑的呼吸变得凌乱，她的另一只脚无意识地摩擦着你的脸颊。
			PRINTFORMW 「等等，舌头在脚趾上转圈的感觉……好羞耻……要变得奇怪了。」
			CASE 5
			PRINTFORML 「我知道啦……来吧。」
			PRINTFORMDL 紫苑羞涩地坐了下来，没有任何织物遮挡的裸足，在半空中诱惑地摆动着。
			PRINTFORMDL 你轻抚着她光滑的脚背，然后缓缓捧到了面前。舌尖从她的前脚掌开始一路向下，在那娇嫩的足心停留。
			PRINTFORMDW 紫苑的身体不由自主地向后倾斜了些。
			PRINTFORMDL 你的舌头开始在她足心最柔软的部位打转，那里的肌肤嫩得就像豆腐，在你湿热的舌头抚慰下微微发颤。紫苑的双手紧抓着裙摆，指节泛白。
			PRINTFORMDL 最后你开始逐一舔舐她的脚趾，舌头在趾缝中深入浅出，紫苑的脚趾无意识地蜷缩起来，想要夹住你的舌头。
			PRINTFORML 「%CALLNAME:MASTER%……真的很擅长呢……」
			PRINTFORMDL 紫苑喘息着说道，脸颊早已经是一片绯红，
			PRINTFORMW 「感觉自己就像要融化了一样……」
			CASE 6
			PRINTFORML 「……请用吧。」
			PRINTFORMDL 紫苑稍微偏过发红的脸颊，装作随意地把脚伸了过来，
			PRINTFORMDL 你捧起紫苑晃荡的小脚，将她冰凉的脚趾一根根含入口中，用牙齿轻轻啃咬着柔软的趾腹。
			PRINTFORMW 「哇！果然还是……习惯不了。」
		ENDSELECT
	ENDIF
ELSEIF TALENT:126:8
	;风铃被紫苑的大脚踹晕了所以这里没写
ENDIF
RETURN 1

[SKIPSTART]
;指令名
@KOJO_XXX_COM_NAME_KX_Y
	RESULTS = com_name

;指令使用条件，与通常的@COM_ABLE函数相同，如果RETURN 1则指令显示为可执行
@KOJO_XXX_COM_ABLE_KX_Y
	RETURN 1

;指令执行内容。描述经验值和参数的增减，与通常的@COM函数相同
;RETURN 1=执行指令 / RETURN 0=指令失败了（函数意义：跳过@SOURCE_CHECK的SOURCE计算阶段) / RETURN -1=指令不执行（函数意义：将直接结束@SOURCE_CHECK）
@KOJO_XXX_COM_KX_Y
	RETURN 1

;指令消息。描述指令的情景文本，
;W的值是(270 + Y)。SELECTCOM/PREVCOM会代入此值
@M_KOJO_XXX_MESSAGE_COM_KX_W
	RETURN 1

;指令能否执行的显性判定计算文本，与通常的@CAN_COM函数相同
;仅当您想为自定义诶嘿嘿指令添加成功/失败判断时才取消注释
;你也可以不写
;@KOJO_XXX_CAN_COM_KX_Y(skipFlag)
;	#DIM skipFlag
;	SKIPDISP skipFlag
;	SKIPDISP 0
[SKIPEND]


;================================
;游戏加载时自动更新
;如果不通过版本管理口上更新，可以忽略
;================================
@KOJO_XXX_VERSION_KX
	;返回当前口上的版本号
	; RETURN now_version

;当存档的CFLAG:kojo_version小于KOJO_XXX_VERSION_KX时加载更新
@KOJO_XXX_VERSION_UPDATE_KX
	;
	; RETURN now_version

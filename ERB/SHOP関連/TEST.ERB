[SKIPSTART]
;778后端测试函数
@K77_RANK_FAVOR_INHIGH(ARG)
#DIM RANK
#DIM ra
#DIM ranum
#DIM flagnum
#DIM kind
RANK = 0
ra = 0
ranum = 0
flagnum = 0
kind = 0
VARSET LOCAL
flagnum = 1 ;V经验
	FOR RANK,1,CHARANUM
		FOR ra,1,CHARANUM
			IF EX:RANK:flagnum < EX:ra:flagnum
				LOCAL:RANK ++
			ENDIF
		NEXT
	NEXT
SETCOLOR 0xA260BF
PRINTFORMW 📸『花果子念报』📸昨日💕去了💕天梯  前{ARG}名
	PRINTFORML -------------
	FOR ranum,1,ARG+1
		FOR RANK,1,CHARANUM
			IF LOCAL:RANK==ranum
				IF EX:(RANK):flagnum == 0
					BREAK
				ENDIF
				PRINTFORM {ranum}位  
				PRINTFORML {EX:(RANK):flagnum}回
				FOR ra,1,CHARANUM
					IF LOCAL:ra == ranum
						CALL PRINT_FACE, ra,"自慰", "裸", "", "吐息"
						PRINTFORML
						IF ra == 42
							PRINTFORMDL %CALLNAME:ra%被%CALLNAME:MASTER%弄到高潮时的照片！
							PRINTFORML 「哎呀，这、这不是我吗...搞错了搞错了快拿下来！」
							PRINTFORML （{EX:(RANK):flagnum}...{EX:(RANK):flagnum}次呐，昨天%CALLNAME:MASTER%把人家都折腾散架了！）
						ELSE
							PRINTFORMDL %CALLNAME:ra%被%CALLNAME:MASTER%弄到高潮时的照片！
							PRINTFORML 「欸？你说是怎么拍到的？这可是独家取材！」
							SIF ranum <= 3
								PRINTFORML （去了{EX:(RANK):flagnum}...{EX:(RANK):flagnum}次呐，咕噜…%CALLNAME:MASTER%也太强了吧…%CALLNAME:ra%桑吗？也真叫人意外啊……换人家的话…）
						ENDIF
					ENDIF
				NEXT
				PRINTFORML
				BREAK
			ENDIF
		NEXT
	NEXT
	PRINTW -------------
RESETCOLOR
RETURN 0


@重置素质(ARG)
#LOCALSIZE 1
#LOCALSSIZE 1
FOR LOCAL,0,352
	TALENT:ARG:LOCAL = CSVTALENT(ARG,LOCAL)
NEXT
RETURN RESULT

@M_KOJO_CHECK_K30_OSHITAOSARE(ARGS,ARG,ARG:1)
#DIM 夺主导权概率
SELECTCASE ARGS
	CASE "OVERRIDE"
		IF CFLAG:积攒度 > 500
			RETURN 1
		ELSE
			RETURN -1
		ENDIF
ENDSELECT

@大轮盘
PALAM:TARGET:欲情 = PALAMLV:4
EQUIP:TARGET:下半身内衣１ = 5
FOR LOCAL,-3,5
	TALENT:ヒップサイズ = LOCAL
	PRINTFORML ⭐大轮盘测试⭐ 臀围为%GET_TALENTNAME(108,TALENT:ヒップサイズ)%
	DRAWLINE
	FOR LOCAL:1,1,50
		PRINTFORML %CLOTHNAME(15,RAND(1,11))%被掀了起来 露出%HIP(TARGET)%
	NEXT
	DRAWLINE
	NEXT
WAIT


@PRINT_IMAGE_ANIMATION_bak(sRes_Name,iStart=0,iEnd=4,iAnime_Num=0,iRollback=1,iWait=100,iSize=1000,sAlign="left")
#DIMS sRes_Name
#DIM iStart
#DIM iEnd
#DIM iAnime_Num
#DIM iRollback
#DIM iWait
#DIM iSize
#DIM TEMP
#DIMS sAlign


SIF !FLAG:画像表示 || sRes_Name == ""
	RETURN RESULT

SIF !FLAG:アニメーション
	RETURN RESULT

SIF !iAnime_Num
	iAnime_Num = FLAG:アニメーション

TEMP = CURRENTREDRAW()
REDRAW 0

FOR LOCAL,0,iAnime_Num
	FOR LOCAL:1,iStart,(iStart+iEnd)
		CALL PRINT_IMAGE(@"%sRes_Name%{LOCAL:1}",iSize,sAlign)
		TWAIT iWait, 0
		CLEARLINE iSize/100
	NEXT
	
	;ロールバックさせるか
	SIF !iRollback
		CONTINUE

	FOR LOCAL:1,(iStart+iEnd)-2,iStart-1,-1
		CALL PRINT_IMAGE(@"%sRes_Name%{LOCAL:1}",iSize,sAlign)
		TWAIT iWait, 0
		CLEARLINE iSize/100
	NEXT
NEXT
REDRAW TEMP

RETURN RESULT

@动画样例
LOCAL = 80
SETANIMETIMER 10
CALL PRINT_IMAGE,"TE1",LOCAL*10
CALL PRINT_IMAGE,"TE2",LOCAL*10
CALL PRINT_IMAGE,"兔女郎-笑",LOCAL*10
DO
PRINTC [100]100
PRINTC [200]200
PRINTC [300]300 
PRINTC [999]返回
INPUT
IF RESULT == 999
	SETANIMETIMER 1000
	CLEARLINE LOCAL/10*3 + 2
	RETURN
ENDIF
CLEARLINE LOCAL/10*3 + 2
LOCAL = RESULT
CALL PRINT_IMAGE,"TE1",LOCAL*10

CALL PRINT_IMAGE,"TE2",LOCAL*10
CALL PRINT_IMAGE,"兔女郎-笑",LOCAL*10
LOCAL:1 = 1
LOOP 1

@动画精灵图,ARGS,ARGS:1,ARG = 2500
LOCAL = CURRENTREDRAW()
REDRAW 0
SETANIMETIMER 40
CALL PRINT_IMAGE,ARGS,ARG
WAIT
CLEARLINE ARG / 100
CALL PRINT_IMAGE,ARGS:1,ARG
REDRAW LOCAL
SETANIMETIMER 32627

@留琴测试
CALL 画像セット,"别颜2_服_笑颜动_2"
CALL 画像セット,"别颜2_服_セーラー_笑颜动_2"
CALL 画像セット,"别颜2_服_バニー_笑颜动_2"
CALL 画像セット,"别颜2_服_变T_笑颜动_2"
CALL 画像一斉表示("左", 0, 1)
CALL 画像セット,"别立ち2_服_笑颜动_2"
CALL 画像セット,"别立ち2_服_セーラー_笑颜动_2"
CALL 画像セット,"别立ち2_服_バニー_笑颜动_2"
CALL 画像セット,"别立ち2_服_变T_笑颜动_2"
CALL 画像一斉表示("左", 0, 1)
WAIT
;CALL PRINT_IMAGE,"别立ち2_服_バニー_イキ颜_2"
;CALL PRINT_IMAGE,"别立ち2_服_バニー_トロ颜_2"
;CALL PRINT_IMAGE,"别立ち2_服_バニー_爱抚_2"
;CALL PRINT_IMAGE,"别立ち2_服_バニー_发情_2"
;CALL PRINT_IMAGE,"别立ち2_服_バニー_愤怒_2"
;CALL PRINT_IMAGE,"别立ち2_服_バニー_通常_2"
;CALL PRINT_IMAGE,"别立ち2_服_バニー_笑颜_2"
;CALL PRINT_IMAGE,"别立ち2_服_バニー_性交_2"
;CALL PRINT_IMAGE,"别颜2_服_バニー_イキ颜_2"
;CALL PRINT_IMAGE,"别颜2_服_バニー_トロ颜_2"
;CALL PRINT_IMAGE,"别颜2_服_バニー_爱抚_2"
;CALL PRINT_IMAGE,"别颜2_服_バニー_发情_2"
;CALL PRINT_IMAGE,"别颜2_服_バニー_愤怒_2"
;CALL PRINT_IMAGE,"别颜2_服_バニー_通常_2"
;CALL PRINT_IMAGE,"别颜2_服_バニー_笑颜_2"
;CALL PRINT_IMAGE,"别颜2_服_バニー_性交_2"

;CALL PRINT_IMAGE,"别立ち2_服_トロ颜_2"
;CALL PRINT_IMAGE,"别立ち2_服_发情_2"
;CALL PRINT_IMAGE,"别立ち2_服_愤怒_2"
;CALL PRINT_IMAGE,"别立ち2_服_通常_2"
;CALL PRINT_IMAGE,"别立ち2_服_笑颜_2"
;CALL PRINT_IMAGE,"别立ち2_裸_イキ颜_2"
;CALL PRINT_IMAGE,"别立ち2_裸_トロ颜_2"
;CALL PRINT_IMAGE,"别立ち2_裸_爱抚_2"
;CALL PRINT_IMAGE,"别立ち2_裸_发情_2"
;CALL PRINT_IMAGE,"别立ち2_裸_愤怒_2"
;CALL PRINT_IMAGE,"别立ち2_裸_汗_2"
;CALL PRINT_IMAGE,"别立ち2_裸_怒羞_2"
;CALL PRINT_IMAGE,"别立ち2_裸_睡眠_2"
;CALL PRINT_IMAGE,"别立ち2_裸_通常_2"
;CALL PRINT_IMAGE,"别立ち2_裸_笑颜_2"
;CALL PRINT_IMAGE,"别立ち2_裸_性交_2"
;CALL PRINT_IMAGE,"别立ち2_裸_自慰_2"
;CALL PRINT_IMAGE,"别颜2_服_トロ颜_2"
;CALL PRINT_IMAGE,"别颜2_服_发情_2"
;CALL PRINT_IMAGE,"别颜2_服_愤怒_2"
;CALL PRINT_IMAGE,"别颜2_服_通常_2"
;CALL PRINT_IMAGE,"别颜2_服_笑颜_2"
;CALL PRINT_IMAGE,"别颜2_裸_イキ颜_2"
;CALL PRINT_IMAGE,"别颜2_裸_トロ颜_2"
;CALL PRINT_IMAGE,"别颜2_裸_爱抚_2"
;CALL PRINT_IMAGE,"别颜2_裸_发情_2"
;CALL PRINT_IMAGE,"别颜2_裸_愤怒_2"
;CALL PRINT_IMAGE,"别颜2_裸_汗_2"
;CALL PRINT_IMAGE,"别颜2_裸_怒羞_2"
;CALL PRINT_IMAGE,"别颜2_裸_睡眠_2"
;CALL PRINT_IMAGE,"别颜2_裸_通常_2"
;CALL PRINT_IMAGE,"别颜2_裸_笑颜_2"
;CALL PRINT_IMAGE,"别颜2_裸_性交_2"
;CALL PRINT_IMAGE,"别颜2_裸_自慰_2"
@ARRAYMSORTEX测试
    #DIM array_index = 4, 3, 0, 9999
    #DIMS array_key = "4", "3", "0", "9999"
    #DIM array_a = 14, 13, 11, 12
    #DIMS array_b = "D", "C", "A", "B"
    #DIMS arrays_name = "array_index", "array_a", "array_b"  ; 不加入 array_index 就不会重新排序
    PRINTFORML > 原数列序号 == %array_key%,%array_key:1%,%array_key:2%,%array_key:3%
    PRINTFORML > array_a == {array_a},{array_a:1},{array_a:2},{array_a:3}
    PRINTFORML > array_b == %array_b%,%array_b:1%,%array_b:2%,%array_b:3%
    ARRAYMSORTEX array_index, arrays_name,1,4  ; 顺序
    PRINTFORML > 排序后序号 == {array_index},{array_index:1},{array_index:2},{array_index:3}
    PRINTFORML > array_a == {array_a},{array_a:1},{array_a:2},{array_a:3}
    PRINTFORML > array_b == %array_b%,%array_b:1%,%array_b:2%,%array_b:3%
    PRINTFORML

@字符转图画
LOCAL = 1
PRINTFORML {LOCAL}占位占位占位占位占位
GCREATE LOCAL, 2000, 300
GSETFONT LOCAL, "黑体", 100, 0
GSETPEN LOCAL, 0xFFFF0000, 5
GDRAWTEXT LOCAL, "占位占位占位占位占位"
SPRITECREATE @"TEST{LOCAL}", LOCAL
HTML_PRINT @"<img src='TEST{LOCAL}' srcb='' height='300'>"
PRINTFORML {LOCAL}占位占位占位占位占位
LOCAL = 2
PRINTFORML {LOCAL}占位占位占位占位占位
FOR local:1, 1, 5
	GCREATE local:1+10, 2*50*local:1, 200
GSETFONT local:1+10, "黑体", local:1*50, 0
GSETPEN local:1+10, 0xFFFF0000, 2
GSETBRUSH local:1+10, 0xFFFF0000
GDRAWTEXT local:1+10, "占位"
SPRITECREATE @"TEST{local:1+10}", local:1+10
locals += @"<img src='TEST{local:1+10}' srcb='' height='200' ypos='{200-50*local:1}'>"
NEXT
HTML_PRINT locals
PRINTFORML
PRINTFORML {LOCAL}占位占位占位占位占位
LOCAL = 3
PRINTFORML {LOCAL}占位占位占位占位占位
GCREATE LOCAL, 2000, 300
GSETFONT LOCAL, "黑体", 50, 0
GSETBRUSH LOCAL, 0xDDFF0000
GDRAWTEXT LOCAL, "占位占位占位占位占位"
SPRITECREATE @"TEST{LOCAL}", LOCAL
HTML_PRINT @"<img src='TEST{LOCAL}' srcb='' height='300'>"
PRINTFORML {LOCAL}占位占位占位占位占位
LOCAL = 4
PRINTFORML {LOCAL}占位占位占位占位占位
FOR local:1, 1, 5
	GCREATE local:1+10, 2000, 200
	GSETFONT local:1+10, "黑体", local:1*50, 0
	GSETPEN local:1+10, 0xFFFF0000, 2
	GSETBRUSH local:1+10, 0xFFFF0000
	GDRAWTEXT local:1+10, "占位"
	SPRITECREATE @"TEST{local:1+10}", local:1+10
	HTML_PRINT @"<img src='TEST{local:1+10}' srcb='' height='200'>",1
NEXT
PRINTL

@从文件中生成图示例1
;测试图已移除
CALL 生成GID
PRINTW 1234567
GCREATEFROMFILE NEXT_GID, "玩家立绘/兔子测试.webp"
SPRITECREATE "兔子测试",NEXT_GID
CALL PRINT_IMAGE,"兔子测试",1500
PRINTW 1234567
CALL 生成GID
GCREATEFROMFILE NEXT_GID, "玩家立绘/兔子原.png"
SPRITECREATE "兔子测试2",NEXT_GID,100,0,400,400
CALL PRINT_IMAGE,"兔子测试2",1500
PRINTW 1234567

@从文件中生成图示例2
#DIM GID
#LOCALSIZE 1
#LOCALSSIZE 1
REDRAW 0
CALL 生成GID
i = NEXT_GID
GID = NEXT_GID
GCREATEFROMFILE GID, "剧本自定义附件/megumu/恶心丸.webp"
FOR COUNT, 1, 7
	GCREATE GID+COUNT,500,500
NEXT
GDRAWG ++i,NEXT_GID,0,0,500,500,0,0,500,500
GDRAWG ++i,NEXT_GID,0,0,500,500,500,0,500,500
GDRAWG ++i,NEXT_GID,0,0,500,500,1000,0,500,500
GDRAWG ++i,NEXT_GID,0,0,500,500,0,500,500,500
GDRAWG ++i,NEXT_GID,0,0,500,500,500,500,500,500
GDRAWG ++i,NEXT_GID,0,0,500,500,1000,500,500,500
CALL 生成GID
A = NEXT_GID
PRINTL 请欣赏『高兴之舞』
VARSET R
FOR j, 0, 300
	PRINTFORML ({j}/300)
	;FOR i, 1, 7
	i = RAND(1,7)
		GDISPOSE A+i
		GCREATE A+i, GWIDTH(GID), GHEIGHT(GID)
		R:0 += 3 * RAND(1,10)
		GDRAWGWITHROTATE A+i, GID+i, R:0, RAND:GWIDTH(GID)/2, RAND:GHEIGHT(GID)/2
		;GDRAWGWITHROTATE 5, 0, RAND:360, RAND:GWIDTH(5), RAND:GHEIGHT(5)
		SPRITECREATE @"dynamic_aya{i}", A+i
	;NEXT
	LOCALS = 
	;FOR I, 1, 7
		LOCALS += @"<img src='dynamic_aya{I}' height = '2000' width = '2000'>"
	;NEXT
	HTML_PRINT LOCALS
	FOR I, 0, 10
		PRINTL 
	NEXT
	AWAIT
	CLEARLINE 12
NEXT
[SKIPEND]
@立绘测试15
#DIM DYNAMIC CID = 15
#DIMS DYNAMIC 类别 = "別立ち6", "別顔6"
#DIMS DYNAMIC 服装 = "服", "服_水手服", "服_兔女郎", "服_睡袍", "服_吊带", "服_下着", "服_丝带", "服_婚纱", "裸"
#DIMS DYNAMIC 表情 = "通常", "笑顔", "憤怒", "自慰", "性交", "発情", "イキ顔", "睡眠"
FOR K, 0, VARSIZE("类别")
	FOR I, 0, VARSIZE("服装")
		FOR J, 0, VARSIZE("表情")
			CALL 画像セット(@"%类别:K%_%服装:I%_%表情:J%_{CID}", 0, 0, 120, 0, 0)
		NEXT
		CALL 画像一斉表示("左", 0, 1)
	NEXT
	WAIT
NEXT
@立绘测试2103
#DIM DYNAMIC CID = 103
#DIMS DYNAMIC 类别 = "別立ち2", "別顔2"
#DIMS DYNAMIC 服装 = "服", "服_水手服", "服_兔女郎", "服_睡衣", "服_下着", "裸"
#DIMS DYNAMIC 表情 = "通常", "笑顔", "憤怒", "自慰", "性交", "発情", "イキ顔", "睡眠"
FOR K, 0, VARSIZE("类别")
	FOR I, 0, VARSIZE("服装")
		FOR J, 0, VARSIZE("表情")
			CALL 画像セット(@"%类别:K%_%服装:I%_%表情:J%_{CID}", 0, 0, 120, 0, 0)
		NEXT
		CALL 画像一斉表示("左", 0, 1)
	NEXT
	WAIT
NEXT
@立绘测试68
#DIM DYNAMIC CID = 68
#DIMS DYNAMIC 类别 = "別立ち", "別顔"
#DIMS DYNAMIC 服装 = "服", "服_水手服", "服_兔女郎", "服_睡衣", "服_下着", "裸"
#DIMS DYNAMIC 表情 = "通常", "笑顔", "憤怒", "自慰", "性交", "発情", "イキ顔", "睡眠"
FOR K, 0, VARSIZE("类别")
	FOR I, 0, VARSIZE("服装")
		FOR J, 0, VARSIZE("表情")
			CALL 画像セット(@"%类别:K%_%服装:I%_%表情:J%_{CID}", 0, 0, 120, 0, 0)
		NEXT
		CALL 画像一斉表示("左", 0, 1)
	NEXT
	WAIT
NEXT
@立绘测试9
#DIM DYNAMIC CID = 9
#DIMS DYNAMIC 类别 = "別立ち3", "別顔3"
#DIMS DYNAMIC 服装 = "服", "服_水手服", "服_兔女郎", "服_睡衣", "服_下着", "裸"
#DIMS DYNAMIC 表情 = "通常", "笑顔", "憤怒", "自慰", "性交", "発情", "イキ顔", "睡眠"
FOR K, 0, VARSIZE("类别")
	FOR I, 0, VARSIZE("服装")
		FOR J, 0, VARSIZE("表情")
			CALL 画像セット(@"%类别:K%_%服装:I%_%表情:J%_{CID}", 0, 0, 120, 0, 0)
		NEXT
		CALL 画像一斉表示("左", 0, 1)
	NEXT
	WAIT
NEXT
@立绘测试37
#DIM DYNAMIC CID = 37
#DIMS DYNAMIC 类别 = "別立ち", "別顔"
#DIMS DYNAMIC 服装 = "服", "服_水手服", "服_兔女郎", "服_睡衣", "服_下着", "裸"
#DIMS DYNAMIC 表情 = "通常", "笑顔", "憤怒", "自慰", "性交", "発情", "イキ顔", "睡眠"
FOR K, 0, VARSIZE("类别")
	FOR I, 0, VARSIZE("服装")
		FOR J, 0, VARSIZE("表情")
			CALL 画像セット(@"%类别:K%_%服装:I%_%表情:J%_{CID}", 0, 0, 120, 0, 0)
		NEXT
		CALL 画像一斉表示("左", 0, 1)
	NEXT
	WAIT
NEXT
@立绘测试43
#DIM DYNAMIC CID = 43
#DIMS DYNAMIC 类别 = "別立ち3", "別顔3"
#DIMS DYNAMIC 服装 = "服", "服_巫女服", "服_泳衣", "服_冬服", "裸"
#DIMS DYNAMIC 表情 = "通常", "笑顔", "憤怒", "自慰", "性交", "発情", "イキ顔", "トロ顔", "睡眠"
FOR K, 0, VARSIZE("类别")
	FOR I, 0, VARSIZE("服装")
		FOR J, 0, VARSIZE("表情")
			CALL 画像セット(@"%类别:K%_%服装:I%_%表情:J%_{CID}", 0, 0, 120, 0, 0)
		NEXT
		CALL 画像一斉表示("左", 0, 1)
	NEXT
	WAIT
NEXT
@立绘测试57
#DIM DYNAMIC CID = 57
#DIMS DYNAMIC 类别 = "別立ち3", "別顔3"
#DIMS DYNAMIC 服装 = "服", "服_舞娘", "服_泳衣", "裸"
#DIMS DYNAMIC 表情 = "通常", "笑顔", "憤怒", "自慰", "性交", "発情", "イキ顔", "トロ顔", "睡眠"
FOR K, 0, VARSIZE("类别")
	FOR I, 0, VARSIZE("服装")
		FOR J, 0, VARSIZE("表情")
			CALL 画像セット(@"%类别:K%_%服装:I%_%表情:J%_{CID}", 0, 0, 120, 0, 0)
		NEXT
		CALL 画像一斉表示("左", 0, 1)
	NEXT
	WAIT
NEXT

@立绘测试,CID = 0,ARG
#DIM DYNAMIC CID
#DIMS DYNAMIC 立绘种类 = "立絵", "顔絵"
#DIMS DYNAMIC 服装 = "服", "服_舞娘", "服_泳衣", "裸"
#DIMS DYNAMIC 表情 = "通常", "笑顔", "憤怒", "自慰", "性交", "愛撫", "発情", "イキ顔", "トロ顔", "睡眠"
;PRINT_FACE,CID,表情="",服装="",差分="",エフェクト="",立绘选择 = -1,一齐表示 = 1
CALL PRINT_FACE,CID,"トロ顔","服_舞娘",,"吐息"
CALL PRINT_BODY,CID,"トロ顔","服_舞娘",,"吐息"
CALL PRINT_FACE,CID,"トロ顔","服_舞娘",,"照れ"
CALL PRINT_BODY,CID,"トロ顔","服_舞娘",,"照れ"
CALL PRINT_IMAGE,"別顔3_照れ_57"
CALL PRINT_IMAGE,"別顔3_吐息_57"
CALL PRINT_IMAGE,"別立3_照れ_57"
CALL PRINT_IMAGE,"別立3_吐息_57"
;FOR K, 0, 2
;	FOR I, 0, VARSIZE("服装")
;		FOR J, 0, VARSIZE("表情")
;			CALL PRINT_FIGURE,CID,表情:J,服装:I, , ,立绘种类:K,ARG
;		NEXT
;	NEXT
;	WAIT
;NEXT
;CALL PRINT_FACE,CID,表情:J,服装:I, , , ,0
;CALL PRINT_BODY,CID,表情:J,服装:I, , , ,0

@数组测试
#DIM MATRIX,3,3

MATRIX:0:0 = 30,31,32
MATRIX:1:0 = 40,41,42
MATRIX:2:0 = 20,21,22
FOR I, 0, 3
	FOR J, 0, 3
		PRINTFORM {MATRIX:I:J} 
	NEXT
	PRINTL
NEXT
WAIT
LOCAL = 44,67,89
@参考
#DIM GID
GID = 0
CALL 画像合成(GID,"別顔_服_通常_93")
GSAVE GID , 1
;GID = 0
;CALL 画像合成(GID,"別顔_服_通常_156")
;GSAVE GID , 2
;GID = 0
;CALL 画像合成(GID,"別顔2_服_通常_97")
;GSAVE GID , 3

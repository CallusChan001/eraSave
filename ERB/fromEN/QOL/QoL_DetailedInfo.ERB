;detailed info for print_state2
@QoL_DetailedInfo(nType = -1, ARG:1, ARG:2)
#DIM nType
SELECTCASE nType
	CASE Qol_Info_Dates
		CALL Qol_Info_Dates(ARG:1)
	CASE Qol_Info_House
		CALL Qol_Info_House(ARG:1)
	CASE Qol_Info_Hours
		CALL Qol_Info_Hours(ARG:1)
	CASE Qol_Info_Dialogue
		CALL Qol_Info_Dialogue(ARG:1)
	CASE Qol_Info_Child
		CALL Qol_Info_Child(ARG:1, ARG:2)
	;CASE Qol_Info_Penis
	;	CALL Qol_Info_Penis(ARG:1, ARG:2)
CASEELSE
	PRINTFORML QoL_DetailedInfo ERROR - Unrecognized {nType}!
ENDSELECT

@Qol_Info_Child(ARG, ARG:1)
LOCAL = ARG:1
IF DAY - CHILD_BIRTHDAY:ARG:LOCAL < 120
	IF DAY - CHILD_BIRTHDAY:ARG:LOCAL < CHILD_語彙 ;bug fix, check child's personal birthday
		PRINTFORM 幼儿期
	ELSEIF DAY - CHILD_BIRTHDAY:ARG:LOCAL < CHILD_自立前 ;bug fix, check child's personal birthday
		PRINTFORM 儿童期
	ELSE
		PRINTFORM 青春期
	ENDIF
	PRINTFORM ({DAY - CHILD_BIRTHDAY:ARG:LOCAL}) 当前状态：
	SELECTCASE DAY - CHILD_BIRTHDAY:ARG:LOCAL
		CASE IS < CHILD_離乳
			PRINTFORM 还在被哺乳 
		CASE IS  < CHILD_玩具
			PRINTFORM 正在适应断奶餐 
		CASE IS  < CHILD_つかまり立ち
			PRINTFORM 正在玩第一个玩具 
		CASE IS  < CHILD_よちよち
			PRINTFORM 正在学习站立和行走 
		CASE IS  < CHILD_喋る
			PRINTFORM 正在行走和探索 
		CASE IS  < CHILD_語彙
			PRINTFORM 初学说话，学习交流 
		CASE IS  < CHILD_しつけ
			PRINTFORM 正在练习和发展语言 
		CASE IS  < CHILD_就学
			PRINTFORM 正在被管教和学习礼仪 
		CASE IS  < CHILD_自立前
			PRINTFORM 正在上学 
		CASE IS  < CHILD_自立-3
			PRINTFORM 正在成长并学习独立 
	CASEELSE
		PRINTFORM 即将成年 
	ENDSELECT
	PRINTFORML
ELSE
	PRINTFORM 当前{14 + (DAY - CHILD_BIRTHDAY:ARG:LOCAL) / 124}岁 \@ (DAY - CHILD_BIRTHDAY:ARG:LOCAL) / 124 > 0 ? 独立已有{(DAY - CHILD_BIRTHDAY:ARG:LOCAL) / 124}年 # 今年已独立\@
	SIF GET_MAPID(CHILD_AREA:ARG:LOCAL) != MAIN_MAP ;exclude main map for now as children cannot appear there
		PRINTFORM 居住在%STR_TR(6000 + (CHILD_AREA:ARG:LOCAL / 10))%
	PRINTL
ENDIF

;expanded list
@Qol_Info_ChildList(ARG, SHOW_ALL)
#DIM SHOW_ALL
#DIM CHILD_NUM
PRINTFORM 　・怀孕时间: {CFLAG:ARG:903}
;CFLAG:ARG:903 = 40
;PRINTL
;PRINTFORM 自覚 : {CFLAG:(ARG):910}
;PRINTL
;PRINTFORM 無自覚妊娠 : {CFLAG:ARG:無自覚妊娠}
PRINTL
PRINTFORM 　・当前育儿数: {CFLAG:ARG:育児人数}
PRINTL
PRINTFORM 　・当前育儿时间: {CFLAG:ARG:908}
PRINTFORML 
PRINTFORM 　・子女数: {CFLAG:ARG:子供人数}
PRINTFORML 
IF CFLAG:ARG:子供人数
	IF !SHOW_ALL
		FOR LOCAL,MAX(CFLAG:ARG:子供人数 - 5, 1),CFLAG:ARG:子供人数 + 1
			CHILD_NUM = CHILD_INDEX(LOCAL)
			IF CHILDNAME:ARG:CHILD_NUM != ""
				PRINTFORM 第%TOKANJI(LOCAL)%\@ CHILD_SEX:ARG:CHILD_NUM == 1 ? 女 # 子 \@: %CHILDNAME:ARG:CHILD_NUM, 15, LEFT%　\@ CHILD_SEX:ARG:CHILD_NUM == 1 ? ♀ # ♂ \@  %PRINT_DATE_F(CHILD_BIRTHDAY:ARG:CHILD_NUM)%(第{CHILD_BIRTHDAY:ARG:CHILD_NUM}日)  出生于%CHILD_WEATHER_CN(CHILD_WEATHER:ARG:CHILD_NUM)%星期%GET_DAY_CN(CHILD_BIRTHDAY:ARG:CHILD_NUM)%　爱情度: {CHILD_LOVE:ARG:CHILD_NUM}
				PRINTL
				PRINTFORM %BL(31)%
				CALL QoL_DetailedInfo(Qol_Info_Child, ARG, CHILD_NUM)
			ENDIF
		NEXT
		IF CFLAG:ARG:子供人数 > 5
			PRINTFORM 　
			PRINTBUTTON "[显示所有子女]", 9997
		ENDIF
	ELSE
		FOR LOCAL,MAX(CFLAG:ARG:子供人数 - MAXCHILD + 1, 1),CFLAG:ARG:子供人数 + 1
			CHILD_NUM = CHILD_INDEX(LOCAL)
			IF CHILDNAME:ARG:CHILD_NUM != ""
				PRINTFORM 第%TOKANJI(LOCAL)%\@ CHILD_SEX:ARG:CHILD_NUM == 1 ? 女 # 子 \@: %CHILDNAME:ARG:CHILD_NUM, 15, LEFT%　\@ CHILD_SEX:ARG:CHILD_NUM == 1 ? ♀ # ♂ \@  %PRINT_DATE_F(CHILD_BIRTHDAY:ARG:CHILD_NUM)%(第{CHILD_BIRTHDAY:ARG:CHILD_NUM}日)  出生于%CHILD_WEATHER_CN(CHILD_WEATHER:ARG:CHILD_NUM)%星期%GET_DAY_CN(CHILD_BIRTHDAY:ARG:CHILD_NUM)%　爱情度: {CHILD_LOVE:ARG:CHILD_NUM}
				PRINTL
				PRINTFORM %BL(31)%
				CALL QoL_DetailedInfo(Qol_Info_Child, ARG, CHILD_NUM)
			ENDIF
		NEXT
	ENDIF
ENDIF

;show wake up times on friendly characters
@Qol_Info_Hours(ARG)
PRINT Active Hours: 
IF CFLAG:ARG:神社在住 || CFLAG:MASTER:現在位置 == OMANEKIBEYA()
	CALL 滞在時間表示(ARG)
	PRINT Waking Hours: 
	CALL 起床時間表示(ARG)
ELSE
	CALL 滞在時間表示(ARG)
	IF CFLAG:ARG:2 >= 1500
		PRINT Waking Hours: 
		CALL 起床時間表示(ARG)
	ENDIF
ENDIF

@Qol_Info_House(ARG)
IF CFLAG:ARG:自宅位置 && (STR:(CFLAG:ARG:自宅位置/ 10 + 6000) != "") && !CFLAG:ARG:神社在住
	LOCAL = CFLAG:ARG:自宅位置 / 10 + 6000
	PRINT Home: 
	;Custom code translation(added _TR) QoL(added the 'at' part)
	PRINTFORML %STR_TR(LOCAL)% at %GET_MAPNAME(GET_MAPID(CFLAG:ARG:自宅位置))%
ELSEIF CFLAG:ARG:神社在住
	PRINT Home: 
	;custom code QoL(added the part before the %GET_MAPNAME)
	PRINTFORML %STR_TR(((MAIN_MAP != 0) ? 8000 # 0) + CFLAG:ARG:神社在住)% at %GET_MAPNAME(MAIN_MAP)%
ELSE
	PRINTL Home: ■■■■■ 【 ■■■■■ 】
ENDIF

@Qol_Info_Dialogue(ARG)
RESULTS:1 =
CALL KOJO_ACTIVE_INFO(ARG)
SIF !RESULT
	RETURN
IF RESULT ;&& ((CFLAG:ARG:口上セレクタ == 0 && RESULTS:1 != "") || CFLAG:ARG:口上セレクタ)
	SIF CFLAG:ARG:口上セレクタ == 0 && RESULTS:1 == ""
		RESULTS:1 = 初始
		
	LOCALS = 版本：[{CFLAG:ARG:口上セレクタ}]\@ RESULTS:1 != "" ? %CALLNAME:(NO:ARG)%%RESULTS:1% # \@剧本
	
	;CALL CHARACTER_DIALOG_STATUS(NO:ARG) ;addition custom code, duplicated characters
	;IF STRLENS(RESULTS:(CFLAG:ARG:口上セレクタ))
	;	LOCALS:1 = (搬运：%RESULTS:(CFLAG:ARG:口上セレクタ)%)
	;ELSE
	;	LOCALS:1 = (搬运：%RESULTS%)
	;ENDIF
	;SIF STRCOUNT(LOCALS:1, "未翻译") || STRCOUNT(LOCALS:1, "中文剧本") || STRCOUNT(LOCALS:1, "原创角色") || STRCOUNT(LOCALS:1, "原版")
	;	LOCALS:1 '= REPLACE(LOCALS:1, "搬运：", "")
	
	;PRINTPLAINFORM %LOCALS%\@ STRLENS(RESULTS) ? %" "%%LOCALS:1%#\@
	PRINTPLAINFORM %LOCALS%
ENDIF

@Qol_Info_AverageFavor ;code by AK Spectre
#DIM TE_TOTAL
#DIM TE_COUNT
#DIM TE_AVERAGE
TE_COUNT = 0
TE_TOTAL = 0
FOR LOCAL, 1, CHARANUM
    TE_TOTAL += CFLAG:LOCAL:好感度
    TE_COUNT += 1
        
    
NEXT
TE_TOTAL = TE_TOTAL / TE_COUNT
TE_AVERAGE = TE_TOTAL * CHARANUM
TE_AVERAGE = TE_AVERAGE / DAY
PRINTFORML ★Average Favor: {TE_TOTAL}
PRINTFORML ★Average Favor gained per day: {TE_AVERAGE} over %PRINT_PLUR("day", DAY)%

@Qol_Info_World_Str(ARG, ARG:1)
#FUNCTIONS
IF Qol_Info_World_Array:ARG:(ARG:1) == -1
	RETURNF @" in an unknown world"
ELSEIF Qol_Info_World_Array:ARG:(ARG:1) != FLAG:周回数
	RETURNF @" in the %NUM_COUNT(Qol_Info_World_Array:ARG:(ARG:1)+1, "pos")% world"
ELSE
	RETURNF ""
ENDIF

@Qol_Info_Dates(ARG)
#DIM nLastSeen
CALL PRINTLINE, "Personal History"
PRINTL 

IF ARG == MASTER ;player section
	VARSET RESULT
	PRINTFORML ★Highest Favor: {最大好感度()}\@ RESULT:1 ? （%CALLNAME:(RESULT:1)%） # \@
	CALL Qol_Info_AverageFavor
	RETURN 1
ENDIF

IF CFLAG:ARG:面識
	nLastSeen = DAY - CFLAG:ARG:最後に会った日
	SELECTCASE nLastSeen
		CASE 0
			PRINTFORML You last met %HIM_HER(ARG)% today.
		CASE 1
			PRINTFORML You last met %HIM_HER(ARG)% yesterday.
	CASEELSE
		PRINTFORML You last met %HIM_HER(ARG)% {nLastSeen} days ago.
	ENDSELECT
	PRINTFORML
ENDIF

IF Qol_Info_Dates_Array:ARG:Qol_Dates_Meet > 0 && CFLAG:ARG:面識
	PRINTFORML %HE_SHE(ARG,1)% first met you on day {Qol_Info_Dates_Array:ARG:Qol_Dates_Meet}\@ Qol_Info_Dates_Str:ARG:Qol_Dates_Meet != "" ? %" " + Qol_Info_Dates_Str:ARG:Qol_Dates_Meet%#\@%Qol_Info_World_Str(ARG, Qol_Dates_Meet)%.
ELSEIF !CFLAG:ARG:面識
	PRINTFORML This %PRINT_MALE("boy", ARG)% still haven't met you yet.
ENDIF

SIF Qol_Info_Dates_Array:ARG:Qol_Dates_Marriage > 0
	PRINTFORML %HE_SHE(ARG,1)% became your %PRINT_MALE("husband", ARG)% on day {Qol_Info_Dates_Array:ARG:Qol_Dates_Marriage}%COND_STR()%%Qol_Info_World_Str(ARG, Qol_Dates_Marriage)%.

SIF Qol_Info_Dates_Array:ARG:Qol_Dates_Concubine > 0
	PRINTFORML %HE_SHE(ARG,1)% became your concubine on day {Qol_Info_Dates_Array:ARG:Qol_Dates_Concubine}%Qol_Info_World_Str(ARG, Qol_Dates_Concubine)%.

SIF Qol_Info_Dates_Array:ARG:Qol_Dates_Engagement > 0
	PRINTFORML %HE_SHE(ARG,1)% became your %PRINT_MALE("fiancé", ARG)% on day {Qol_Info_Dates_Array:ARG:Qol_Dates_Engagement}%Qol_Info_World_Str(ARG, Qol_Dates_Engagement)%.

SIF Qol_Info_Dates_Array:ARG:Qol_Dates_GF > 0
	PRINTFORML %HE_SHE(ARG,1)% became your %PRINT_MALE("boy", ARG)%friend on day {Qol_Info_Dates_Array:ARG:Qol_Dates_GF}%Qol_Info_World_Str(ARG, Qol_Dates_GF)%.

SIF Qol_Info_Dates_Array:ARG:Qol_Dates_DeepLove > 0
	PRINTFORML %HE_SHE(ARG,1)% utterly fell in love with you on day {Qol_Info_Dates_Array:ARG:Qol_Dates_DeepLove}%Qol_Info_World_Str(ARG, Qol_Dates_DeepLove)%.

SIF Qol_Info_Dates_Array:ARG:Qol_Dates_Love > 0
	PRINTFORML %HE_SHE(ARG,1)% fell in love with you on day {Qol_Info_Dates_Array:ARG:Qol_Dates_Love}%Qol_Info_World_Str(ARG, Qol_Dates_Love)%.

SIF Qol_Info_Dates_Array:ARG:Qol_Dates_Yearn > 0
	PRINTFORML %HE_SHE(ARG,1)% started thinking about you romantically on day {Qol_Info_Dates_Array:ARG:Qol_Dates_Yearn}%Qol_Info_World_Str(ARG, Qol_Dates_Yearn)%.

;IF CFLAG:選択中キャラID:83 > 0 && CFLAG:選択中キャラID:84 > 0
;	PRINTFORML She dated %CALLNAME:MASTER% from the {CFLAG:選択中キャラID:83}%CALENDAR_COUNT(CFLAG:選択中キャラID:83)% day.

SIF Qol_Info_Dates_Array:ARG:Qol_Dates_Lust > 0
	PRINTFORML %HE_SHE(ARG,1)% started drowning in lust and letting you have your way with %HIM_HER(ARG)% at %ORDINAL(Qol_Info_Dates_Array:ARG:Qol_Dates_Lust)% day%Qol_Info_World_Str(ARG, Qol_Dates_Lust)%.
SIF Qol_Info_Dates_Array:ARG:Qol_Dates_FBuddy > 0
	PRINTFORML %HE_SHE(ARG,1)% started having a physical relationship with you in exchange for pleasure at %ORDINAL(Qol_Info_Dates_Array:ARG:Qol_Dates_FBuddy)% day%Qol_Info_World_Str(ARG, Qol_Dates_FBuddy)%.

SIF FLAG:子宝祈願 == ARG
	PRINTFORML %HE_SHE(ARG,1)% is currently the object of your Pregnancy Prayer.

;when marriage is complete (yeaaah right)
; SELECTCASE TALENT:選択中キャラID:妻
; CASE 1
	; PRINTFORML She became %CALLNAME:MASTER%'s wife, creating a happy family at the {CFLAG:選択中キャラID:84}%CALENDAR_COUNT(CFLAG:選択中キャラID:84)% day.
; CASE 2
	; PRINTFORML She became %CALLNAME:MASTER%'s wife at the {CFLAG:選択中キャラID:84}%CALENDAR_COUNT(CFLAG:選択中キャラID:84)% day.
; CASE 3
	; PRINTFORML She became %CALLNAME:MASTER%'s wife at the {CFLAG:選択中キャラID:84}%CALENDAR_COUNT(CFLAG:選択中キャラID:84)% day.
	; PRINTFORML Currently she dreams of the day when you will live together, and refines herself as a woman every day.
; ENDSELECT
		
;for affection mark, someday
; IF CFLAG:選択中キャラID:88 > 0
	; PRINTFORML At day {CFLAG:選択中キャラID:88}, her body and soul became %CALLNAME:MASTER%'s after many sexual intercourses with %HIM_HER(MASTER)%.
	; SIF TALENT:選択中キャラID:献身的
		; PRINTFORML She's determined to sacrifice everything without a hesitation if needed for %CALLNAME:MASTER%'s sake.
; ENDIF

SIF Qol_Info_Dates_Array:ARG:Qol_Dates_Mirada
	CALL COLORMESSAGE(@"You first used the Stone of Mirada on %HIM_HER(ARG)% for the purpose of having access to her body on day {Qol_Info_Dates_Array:ARG:Qol_Dates_Mirada}%Qol_Info_World_Str(ARG, Qol_Dates_Mirada)%.",C_PINK,1)

@Qol_Info_Body(ARG)
PRINTL
PRINTL 【Other】
SIF ARG != MASTER && Qol_Info_Dates_Array:ARG:Qol_Dates_Orgasm > 0
	PRINTFORML You made %HIM_HER(ARG)% orgasm for the first time while making out on day {Qol_Info_Dates_Array:ARG:Qol_Dates_Orgasm}%Qol_Info_World_Str(ARG, Qol_Dates_Orgasm)%.
SIF ARG != MASTER && (Qol_Info_Count_Array:ARG:Qol_Count_Orgasms > 0)
	PRINTFORML Through actions, you made %HIM_HER(ARG)% orgasm %PRINT_PLUR("time", Qol_Info_Count_Array:ARG:Qol_Count_Orgasms)%.
	
SIF Qol_Info_Dates_Array:ARG:Qol_Dates_Ejac > 0
	PRINTFORML \@ ARG == MASTER ? You # %HE_SHE(ARG,1)%\@ ejaculated for the first time on day {Qol_Info_Dates_Array:ARG:Qol_Dates_Ejac}%Qol_Info_World_Str(ARG, Qol_Dates_Ejac)%.
	
LOCAL = EXP:ARG:絶頂経験 - EXP:ARG:無自覚絶頂経験
SIF LOCAL > 0
	PRINTFORML In total, \@ ARG == MASTER ? you # %HE_SHE(ARG)%\@ had {LOCAL} conscious %PLURALIZER("orgasm", LOCAL)%\@ EXP:ARG:射精経験 > 0 ? , including %PRINT_PLUR("ejaculation", EXP:ARG:射精経験)%#\@\@ EXP:ARG:無自覚絶頂経験 > 0 ? , and orgasmed unconsciously {EXP:ARG:無自覚絶頂経験} %PLURALIZER("time", EXP:ARG:無自覚絶頂経験)%, totalling at {EXP:ARG:絶頂経験} %PLURALIZER("orgasm", EXP:ARG:絶頂経験)%#\@.

LOCAL = CFLAG:ARG:累計膣内精液 + CFLAG:ARG:累計アナル精液 + CFLAG:ARG:累計精飲
SIF LOCAL > 0 || CFLAG:ARG:累計ぶっかけ
	PRINTFORML Total semen received: %DIGIT_GROUP(LOCAL)%ml inside, and poured over with %DIGIT_GROUP(CFLAG:ARG:累計ぶっかけ)%ml.
	
SIF Qol_Info_Dates_Array:ARG:Qol_Dates_Bj > 0
	PRINTFORML \@ ARG == MASTER ? You # %HE_SHE(ARG,1)%\@ first sucked penis on day {Qol_Info_Dates_Array:ARG:Qol_Dates_Bj}%Qol_Info_World_Str(ARG, Qol_Dates_Bj)%.
IF ARG != MASTER && (Qol_Info_Count_Array:ARG:Qol_Count_GiveMSex > 0 || Qol_Info_Count_Array:ARG:Qol_Count_GiveMSexCunni > 0 || Qol_Info_Count_Array:ARG:Qol_Count_GiveMSexAnal > 0 || Qol_Info_Count_Array:ARG:Qol_Count_GiveMSexNip > 0 || Qol_Info_Count_Array:ARG:Qol_Count_GiveMSexDeepThroat > 0)
	LOCALS =
	SIF Qol_Info_Count_Array:ARG:Qol_Count_GiveMSex > 0
		LOCALS += @"given blowjobs %PRINT_PLUR("time", Qol_Info_Count_Array:ARG:Qol_Count_GiveMSex)%、"
	SIF Qol_Info_Count_Array:ARG:Qol_Count_GiveMSexCunni > 0
		LOCALS += @"licked your pussy %PRINT_PLUR("time", Qol_Info_Count_Array:ARG:Qol_Count_GiveMSexCunni)%、"
	SIF Qol_Info_Count_Array:ARG:Qol_Count_GiveMSexAnal > 0
		LOCALS += @"licked your ass %PRINT_PLUR("time", Qol_Info_Count_Array:ARG:Qol_Count_GiveMSexAnal)%、"
	SIF Qol_Info_Count_Array:ARG:Qol_Count_GiveMSexNip > 0
		LOCALS += @"licked your nipples %PRINT_PLUR("time", Qol_Info_Count_Array:ARG:Qol_Count_GiveMSexNip)%、"
	SIF Qol_Info_Count_Array:ARG:Qol_Count_GiveMSexDeepThroat > 0
		LOCALS += @"given deepthroats %PRINT_PLUR("time", Qol_Info_Count_Array:ARG:Qol_Count_GiveMSexDeepThroat)%、"
	PRINTFORML Through actions, %HE_SHE(ARG)% has %LIST_IN_STRING(LOCALS)%.
ENDIF
IF ARG != MASTER && (Qol_Info_Count_Array:ARG:Qol_Count_MSex > 0 || Qol_Info_Count_Array:ARG:Qol_Count_MSexCunni > 0 || Qol_Info_Count_Array:ARG:Qol_Count_MSexAnal > 0 || Qol_Info_Count_Array:ARG:Qol_Count_MSexNip > 0 || Qol_Info_Count_Array:ARG:Qol_Count_MSexDeepThroat > 0)
	LOCALS =
	SIF Qol_Info_Count_Array:ARG:Qol_Count_MSex > 0
		LOCALS += @"given %HIM_HER(ARG)% blowjobs %PRINT_PLUR("time", Qol_Info_Count_Array:ARG:Qol_Count_MSex)%、"
	SIF Qol_Info_Count_Array:ARG:Qol_Count_MSexCunni > 0
		LOCALS += @"licked %HIS_HER(ARG)% pussy %PRINT_PLUR("time", Qol_Info_Count_Array:ARG:Qol_Count_MSexCunni)%、"
	SIF Qol_Info_Count_Array:ARG:Qol_Count_MSexAnal > 0
		LOCALS += @"licked %HIS_HER(ARG)% ass %PRINT_PLUR("time", Qol_Info_Count_Array:ARG:Qol_Count_MSexAnal)%、"
	SIF Qol_Info_Count_Array:ARG:Qol_Count_MSexNip > 0
		LOCALS += @"licked %HIS_HER(ARG)% nipples %PRINT_PLUR("time", Qol_Info_Count_Array:ARG:Qol_Count_MSexNip)%、"
	SIF Qol_Info_Count_Array:ARG:Qol_Count_MSexDeepThroat > 0
		LOCALS += @"given %HIM_HER(ARG)% deepthroats %PRINT_PLUR("time", Qol_Info_Count_Array:ARG:Qol_Count_MSexDeepThroat)%、"
	PRINTFORML Through actions, you've %LIST_IN_STRING(LOCALS)%.
ENDIF
IF ARG == MASTER
	LOCAL:1 = 0
	LOCAL:2 = 0
	LOCAL:3 = 0
	LOCAL:4 = 0
	LOCAL:5 = 0
	FOR LOCAL, 1, CHARANUM
		LOCAL:1 += Qol_Info_Count_Array:LOCAL:Qol_Count_MSex
		LOCAL:2 += Qol_Info_Count_Array:LOCAL:Qol_Count_MSexCunni
		LOCAL:3 += Qol_Info_Count_Array:LOCAL:Qol_Count_MSexAnal
		LOCAL:4 += Qol_Info_Count_Array:LOCAL:Qol_Count_MSexNip
		LOCAL:5 += Qol_Info_Count_Array:LOCAL:Qol_Count_MSexDeepThroat
	NEXT
	LOCALS =
	SIF LOCAL:1 > 0
		LOCALS += @"given blowjobs %PRINT_PLUR("time", LOCAL:1)%、"
	SIF LOCAL:2 > 0
		LOCALS += @"licked pussy %PRINT_PLUR("time", LOCAL:2)%、"
	SIF LOCAL:3 > 0
		LOCALS += @"licked ass %PRINT_PLUR("time", LOCAL:3)%、"
	SIF LOCAL:4 > 0
		LOCALS += @"licked nipples %PRINT_PLUR("time", LOCAL:4)%、"
	SIF LOCAL:5 > 0
		LOCALS += @"given deepthroats %PRINT_PLUR("time", LOCAL:5)%、"
	SIF STRLENS(LOCALS)
		PRINTFORML In total, through actions, you've %LIST_IN_STRING(LOCALS)%.
ENDIF
	
SIF Qol_Info_Dates_Array:ARG:Qol_Dates_Semen > 0
	PRINTFORML \@ ARG == MASTER ? You # %HE_SHE(ARG,1)%\@ experienced the taste of semen for the first time on day {Qol_Info_Dates_Array:ARG:Qol_Dates_Semen}%Qol_Info_World_Str(ARG, Qol_Dates_Semen)%.
IF ARG != MASTER && Qol_Info_Count_Array:ARG:Qol_Count_Semen > 0
	LOCALS =
	SIF Qol_Info_Count_Array:ARG:Qol_Count_SemenDrink > 0
		LOCALS += @"%PRINT_PLUR("time", Qol_Info_Count_Array:ARG:Qol_Count_SemenDrink)% drinking、"
	SIF Qol_Info_Count_Array:ARG:Qol_Count_SemenV > 0
		LOCALS += @"%PRINT_PLUR("time", Qol_Info_Count_Array:ARG:Qol_Count_SemenV)% vaginally、"
	SIF Qol_Info_Count_Array:ARG:Qol_Count_SemenA > 0
		LOCALS += @"%PRINT_PLUR("time", Qol_Info_Count_Array:ARG:Qol_Count_SemenA)% anally、"
	PRINTFORML In total, %HE_SHE(ARG)% has come in contact with your semen %PRINT_PLUR("time", Qol_Info_Count_Array:ARG:Qol_Count_Semen)%\@ Qol_Info_Count_Array:ARG:Qol_Count_UncVSex > 0 ? %" "%(%PRINT_PLUR("time", Qol_Info_Count_Array:ARG:Qol_Count_UncSemen)% unconsciously) #\@\@ STRLENS(LOCALS) ? , including %LIST_IN_STRING(LOCALS)%#\@.
ENDIF
IF ARG != MASTER
	LOCALS =
	SIF Qol_Info_Count_Array:ARG:Qol_Count_EjacV > 0
		LOCALS += @"inside your vagina %PRINT_PLUR("time", Qol_Info_Count_Array:ARG:Qol_Count_EjacV)%、"
	SIF Qol_Info_Count_Array:ARG:Qol_Count_EjacA > 0
		LOCALS += @"inside your ass %PRINT_PLUR("time", Qol_Info_Count_Array:ARG:Qol_Count_EjacA)%、"
	SIF Qol_Info_Count_Array:ARG:Qol_Count_EjacM > 0
		LOCALS += @"inside your mouth %PRINT_PLUR("time", Qol_Info_Count_Array:ARG:Qol_Count_EjacM)%、"
	SIF STRLENS(LOCALS)
		PRINTFORML Through actions, %HE_SHE(ARG)% has ejaculated %LIST_IN_STRING(LOCALS)%.
ENDIF
	
IF ARG != MASTER && (Qol_Info_Count_Array:ARG:Qol_Count_VSex > 0 || Qol_Info_Count_Array:ARG:Qol_Count_ASex > 0)
	IF Qol_Info_Count_Array:ARG:Qol_Count_VSex > 0 && Qol_Info_Count_Array:ARG:Qol_Count_ASex > 0
		PRINTFORML Through actions, you had vaginal sex with %HIM_HER(ARG)% %PRINT_PLUR("time", Qol_Info_Count_Array:ARG:Qol_Count_VSex)%\@ Qol_Info_Count_Array:ARG:Qol_Count_UncVSex > 0 ? %" "%(Including unconsciously %PRINT_PLUR("time", Qol_Info_Count_Array:ARG:Qol_Count_UncVSex)%) #\@ and anal sex %PRINT_PLUR("time", Qol_Info_Count_Array:ARG:Qol_Count_ASex)%\@ Qol_Info_Count_Array:ARG:Qol_Count_UncASex > 0 ? %" "%(Including unconsciously %PRINT_PLUR("time", Qol_Info_Count_Array:ARG:Qol_Count_UncASex)%) #\@.
	ELSEIF Qol_Info_Count_Array:ARG:Qol_Count_VSex > 0
		PRINTFORML Through actions, you had vaginal sex with %HIM_HER(ARG)% %PRINT_PLUR("time", Qol_Info_Count_Array:ARG:Qol_Count_VSex)%\@ Qol_Info_Count_Array:ARG:Qol_Count_UncVSex > 0 ? %" "%(Including unconsciously %PRINT_PLUR("time", Qol_Info_Count_Array:ARG:Qol_Count_UncVSex)%) #\@.
	ELSEIF Qol_Info_Count_Array:ARG:Qol_Count_ASex > 0
		PRINTFORML Through actions, you had anal sex with %HIM_HER(ARG)% %PRINT_PLUR("time", Qol_Info_Count_Array:ARG:Qol_Count_ASex)%\@ Qol_Info_Count_Array:ARG:Qol_Count_UncASex > 0 ? %" "%(Including unconsciously %PRINT_PLUR("time", Qol_Info_Count_Array:ARG:Qol_Count_UncASex)%) #\@.
	ENDIF
	SIF Qol_Info_Count_Array:ARG:Qol_Count_PulloutSex > 0
		PRINTFORML Under the promise to pull out before ejaculation, you fucked her raw %PRINT_PLUR("time", Qol_Info_Count_Array:ARG:Qol_Count_PulloutSex)% and ejaculated {Qol_Info_Count_Array:ARG:Qol_Count_EjacOut}ml outside.
ENDIF
IF ARG != MASTER && (Qol_Info_Count_Array:ARG:Qol_Count_VGiveSex > 0 || Qol_Info_Count_Array:ARG:Qol_Count_AGiveSex > 0)
	IF Qol_Info_Count_Array:ARG:Qol_Count_VGiveSex > 0 && Qol_Info_Count_Array:ARG:Qol_Count_AGiveSex > 0
		PRINTFORML Through actions, %HE_SHE(ARG)% penetrated you vaginally %PRINT_PLUR("time", Qol_Info_Count_Array:ARG:Qol_Count_VGiveSex)%\@ Qol_Info_Count_Array:ARG:Qol_Count_UncVGiveSex > 0 ? %" "%(Including unconsciously %PRINT_PLUR("time", Qol_Info_Count_Array:ARG:Qol_Count_UncVGiveSex)%) #\@ and anally %PRINT_PLUR("time", Qol_Info_Count_Array:ARG:Qol_Count_AGiveSex)%\@ Qol_Info_Count_Array:ARG:Qol_Count_UncAGiveSex > 0 ? %" "%(Including unconsciously %PRINT_PLUR("time", Qol_Info_Count_Array:ARG:Qol_Count_UncAGiveSex)%) #\@.
	ELSEIF Qol_Info_Count_Array:ARG:Qol_Count_VGiveSex > 0
		PRINTFORML Through actions, %HE_SHE(ARG)% penetrated you vaginally %PRINT_PLUR("time", Qol_Info_Count_Array:ARG:Qol_Count_VGiveSex)%\@ Qol_Info_Count_Array:ARG:Qol_Count_UncVGiveSex > 0 ? %" "%(Including unconsciously %PRINT_PLUR("time", Qol_Info_Count_Array:ARG:Qol_Count_UncVGiveSex)%) #\@.
	ELSEIF Qol_Info_Count_Array:ARG:Qol_Count_AGiveSex > 0
		PRINTFORML Through actions, %HE_SHE(ARG)% penetrated you anally %PRINT_PLUR("time", Qol_Info_Count_Array:ARG:Qol_Count_AGiveSex)%\@ Qol_Info_Count_Array:ARG:Qol_Count_UncAGiveSex > 0 ? %" "%(Including unconsciously %PRINT_PLUR("time", Qol_Info_Count_Array:ARG:Qol_Count_UncAGiveSex)%) #\@.
	ENDIF
ENDIF
;exp counter will do for now
; IF ARG == MASTER
	; LOCAL:1 = 0
	; LOCAL:2 = 0
	; LOCAL:3 = 0
	; LOCAL:4 = 0
	; FOR LOCAL, 1, CHARANUM
		; LOCAL:1 += Qol_Info_Count_Array:LOCAL:Qol_Count_VGiveSex
		; LOCAL:2 += Qol_Info_Count_Array:LOCAL:Qol_Count_AGiveSex
		; LOCAL:3 += Qol_Info_Count_Array:LOCAL:Qol_Count_VGiveSex
		; LOCAL:4 += 
	; NEXT
; ENDIF

SIF Qol_Info_Dates_Array:ARG:Qol_Dates_Creampie > 0
	PRINTFORML \@ ARG == MASTER ? You # She\@ received her first creampie in \@ ARG == MASTER ? your # her\@ womb on day {Qol_Info_Dates_Array:ARG:Qol_Dates_Creampie}%Qol_Info_World_Str(ARG, Qol_Dates_Creampie)%.
SIF Qol_Info_Dates_Array:ARG:Qol_Dates_ACreampie > 0
	PRINTFORML \@ ARG == MASTER ? You # %HE_SHE(ARG,1)%\@ received a load of semen inside \@ ARG == MASTER ? your # %HIS_HER(ARG)%\@ ass for the first time on day {Qol_Info_Dates_Array:ARG:Qol_Dates_ACreampie}%Qol_Info_World_Str(ARG, Qol_Dates_ACreampie)%.
	
SIF Qol_Info_Dates_Array:ARG:Qol_Dates_Lactation > 0
	PRINTFORML \@ ARG == MASTER ? You # %HE_SHE(ARG,1)%\@ first lactated on day {Qol_Info_Dates_Array:ARG:Qol_Dates_Lactation}%Qol_Info_World_Str(ARG, Qol_Dates_Lactation)%.
;milk related
SIF ARG != MASTER && (Qol_Info_Count_Array:ARG:Qol_Count_MilkLactated > 0)
	PRINTFORML So far %HE_SHE(ARG)% lactated {Qol_Info_Count_Array:ARG:Qol_Count_MilkLactated}ml of milk\@ Qol_Info_Count_Array:ARG:Qol_Count_MilkCollected ? , and you collected {Qol_Info_Count_Array:ARG:Qol_Count_MilkCollected}ml of it#\@\@ Qol_Info_Count_Array:ARG:Qol_Count_UncMilked > 0 ? %" "%(Including unconsciously {Qol_Info_Count_Array:ARG:Qol_Count_UncMilked}ml) #\@.
SIF ARG != MASTER && Qol_Info_Count_Array:ARG:Qol_Count_MilkDrankNipple > 0
	PRINTFORML So far %HE_SHE(ARG)% fed you with {Qol_Info_Count_Array:ARG:Qol_Count_MilkDrankNipple}ml of milk from %HIS_HER(ARG)% nipples\@ Qol_Info_Count_Array:ARG:Qol_Count_UncMilkDrank > 0 ? %" "%(Including unconsciously {Qol_Info_Count_Array:ARG:Qol_Count_UncMilkDrank}ml) #\@.
SIF ARG == MASTER && (Qol_Info_Count_Array:ARG:Qol_Count_MilkDrankBottle > 0 || Qol_Info_Count_Array:ARG:Qol_Count_MilkDrankNipple > 0)
	PRINTFORML So far you drank {Qol_Info_Count_Array:ARG:Qol_Count_MilkDrankBottle}ml of milk from bottles, and {Qol_Info_Count_Array:ARG:Qol_Count_MilkDrankNipple}ml straight from the tap.
	
SIF Qol_Info_Dates_Array:ARG:Qol_Dates_DeflowerOrgasm > 0
	PRINTFORML \@ ARG == MASTER ? You # %HE_SHE(ARG,1)%\@ had a vaginal orgasm while losing \@ ARG == MASTER ? your # her\@ virginity.
	
SIF Qol_Info_Dates_Array:ARG:Qol_Dates_Quad > 0
	PRINTFORML \@ ARG == MASTER ? You # %HE_SHE(ARG,1)%\@ had an unbelievable quadruple orgasm on day {Qol_Info_Dates_Array:ARG:Qol_Dates_Quad}%Qol_Info_World_Str(ARG, Qol_Dates_Quad)%.
SIF Qol_Info_Dates_Array:ARG:Qol_Dates_Quint > 0
	PRINTFORML \@ ARG == MASTER ? You # %HE_SHE(ARG,1)%\@ had an earth-shattering quintuple orgasm on day {Qol_Info_Dates_Array:ARG:Qol_Dates_Quint}%Qol_Info_World_Str(ARG, Qol_Dates_Quint)%.
	
SIF ARG != MASTER && Qol_Info_Count_Array:ARG:Qol_Count_Kiss > 0
	PRINTFORML Through actions, you kissed %HIM_HER(ARG)% %PRINT_PLUR("time", Qol_Info_Count_Array:ARG:Qol_Count_Kiss)%\@ Qol_Info_Count_Array:ARG:Qol_Count_UncKiss > 0 ? %" "%(Including unconsciously %PRINT_PLUR("time", Qol_Info_Count_Array:ARG:Qol_Count_UncKiss)%) #\@.
SIF ARG != MASTER && Qol_Info_Count_Array:ARG:Qol_Count_Hug > 0
	PRINTFORML Through actions, you hugged %HIM_HER(ARG)% %PRINT_PLUR("time", Qol_Info_Count_Array:ARG:Qol_Count_Hug)%\@ Qol_Info_Count_Array:ARG:Qol_Count_UncKiss > 0 ? %" "%(Including unconsciously %PRINT_PLUR("time", Qol_Info_Count_Array:ARG:Qol_Count_UncHug)%) #\@.
SIF ARG != MASTER && Qol_Info_Count_Array:ARG:Qol_Count_Headpat > 0
	PRINTFORML Through actions, you patted %HIM_HER(ARG)% %PRINT_PLUR("time", Qol_Info_Count_Array:ARG:Qol_Count_Headpat)%\@ Qol_Info_Count_Array:ARG:Qol_Count_UncKiss > 0 ? %" "%(Including unconsciously %PRINT_PLUR("time", Qol_Info_Count_Array:ARG:Qol_Count_UncHeadpat)%) #\@.
SIF ARG != MASTER && CFLAG:ARG:ダメ出し
	PRINTFORML Persuasion attempts towards the unprotected sex on dangerous day: {CFLAG:ARG:ダメ出し}
SIF ARG != MASTER && Qol_Info_Count_Array:ARG:Qol_Count_Birth > 0
	PRINTFORML You had children with %HIM_HER(ARG)% %PRINT_PLUR("time", Qol_Info_Count_Array:ARG:Qol_Count_Birth)%.
SIF ARG != MASTER && Qol_Info_Count_Array:ARG:Qol_Count_Fap > 0
	PRINTFORML You fantasized about %HIM_HER(ARG)% %PRINT_PLUR("time", Qol_Info_Count_Array:ARG:Qol_Count_Fap)% while masturbating, spilling {Qol_Info_Count_Array:ARG:Qol_Count_FapSemen}ml worth of semen.
	
;set skills
SIF Qol_Info_Dates_Array:ARG:Qol_Dates_LewdLips > 0
	PRINTFORML \@ ARG == MASTER ? You # %HE_SHE(ARG,1)%\@ started craving kisses on day {Qol_Info_Dates_Array:ARG:Qol_Dates_LewdLips}%Qol_Info_World_Str(ARG, Qol_Dates_LewdLips)%.
SIF Qol_Info_Dates_Array:ARG:Qol_Dates_Masturb > 0
	PRINTFORML \@ ARG == MASTER ? You # %HE_SHE(ARG,1)%\@ became addicted to masturbation on day {Qol_Info_Dates_Array:ARG:Qol_Dates_Masturb}%Qol_Info_World_Str(ARG, Qol_Dates_Masturb)%.
SIF Qol_Info_Dates_Array:ARG:Qol_Dates_LewdCervix > 0
	PRINTFORML \@ ARG == MASTER ? Your # %HIS_HER(ARG,1)%\@ cervix became erogenous on day {Qol_Info_Dates_Array:ARG:Qol_Dates_LewdCervix}%Qol_Info_World_Str(ARG, Qol_Dates_LewdCervix)%.
SIF Qol_Info_Dates_Array:ARG:Qol_Dates_Musicality > 0
	PRINTFORML \@ ARG == MASTER ? You # %HE_SHE(ARG,1)%\@ became proficient at music on day {Qol_Info_Dates_Array:ARG:Qol_Dates_Musicality}%Qol_Info_World_Str(ARG, Qol_Dates_Musicality)%.
SIF Qol_Info_Dates_Array:ARG:Qol_Dates_Sound > 0
	PRINTFORML \@ ARG == MASTER ? You # %HE_SHE(ARG,1)%\@ cultivated perfect pitch on day {Qol_Info_Dates_Array:ARG:Qol_Dates_Sound}%Qol_Info_World_Str(ARG, Qol_Dates_Sound)%.
SIF Qol_Info_Dates_Array:ARG:Qol_Dates_Mixing > 0
	PRINTFORML \@ ARG == MASTER ? You # %HE_SHE(ARG,1)%\@ learned how to handle medicine production on day {Qol_Info_Dates_Array:ARG:Qol_Dates_Mixing}%Qol_Info_World_Str(ARG, Qol_Dates_Mixing)%.
SIF Qol_Info_Dates_Array:ARG:Qol_Dates_Finger > 0
	PRINTFORML \@ ARG == MASTER ? You # %HE_SHE(ARG,1)%\@ became very skilled with \@ ARG == MASTER ? your # %HIS_HER(ARG)%\@ fingers on day {Qol_Info_Dates_Array:ARG:Qol_Dates_Finger}%Qol_Info_World_Str(ARG, Qol_Dates_Finger)%.
SIF Qol_Info_Dates_Array:ARG:Qol_Dates_Tongue > 0
	PRINTFORML \@ ARG == MASTER ? You # %HE_SHE(ARG,1)%\@ developed unmatched tongue skill on day {Qol_Info_Dates_Array:ARG:Qol_Dates_Tongue}%Qol_Info_World_Str(ARG, Qol_Dates_Tongue)%.
SIF Qol_Info_Dates_Array:ARG:Qol_Dates_LewdChest > 0
	PRINTFORML \@ ARG == MASTER ? Your # %HIS_HER(ARG,1)%\@ chest became extra erogenous on day {Qol_Info_Dates_Array:ARG:Qol_Dates_LewdChest}%Qol_Info_World_Str(ARG, Qol_Dates_LewdChest)%.
SIF Qol_Info_Dates_Array:ARG:Qol_Dates_LewdVagina > 0
	PRINTFORML \@ ARG == MASTER ? Your # %HIS_HER(ARG,1)%\@ vagina became extra erogenous on day {Qol_Info_Dates_Array:ARG:Qol_Dates_LewdVagina}%Qol_Info_World_Str(ARG, Qol_Dates_LewdVagina)%.
SIF Qol_Info_Dates_Array:ARG:Qol_Dates_LewdAnus > 0
	PRINTFORML \@ ARG == MASTER ? Your # %HIS_HER(ARG,1)%\@ anus became extra erogenous on day {Qol_Info_Dates_Array:ARG:Qol_Dates_LewdAnus}%Qol_Info_World_Str(ARG, Qol_Dates_LewdAnus)%.
;extra
SIF Qol_Info_Dates_Array:ARG:Qol_Dates_FirstPeriod > 0
	PRINTFORML \@ ARG == MASTER ? You # %HE_SHE(ARG,1)%\@ had \@ ARG == MASTER ? your # %HIS_HER(ARG)%\@ period on day {Qol_Info_Dates_Array:ARG:Qol_Dates_FirstPeriod}%Qol_Info_World_Str(ARG, Qol_Dates_FirstPeriod)%.
SIF Qol_Info_Dates_Array:ARG:Qol_Dates_LoveSemen > 0
	PRINTFORML \@ ARG == MASTER ? You # %HE_SHE(ARG,1)%\@ developed a refined taste for semen on day {Qol_Info_Dates_Array:ARG:Qol_Dates_LoveSemen}%Qol_Info_World_Str(ARG, Qol_Dates_LoveSemen)%.
SIF Qol_Info_Dates_Array:ARG:Qol_Dates_SexKnow > 0
	PRINTFORML \@ ARG == MASTER ? You # %HE_SHE(ARG,1)%\@ learned about sex in its entirety on day {Qol_Info_Dates_Array:ARG:Qol_Dates_SexKnow}%Qol_Info_World_Str(ARG, Qol_Dates_SexKnow)%.
	
;orgasm can happen from so many other things, so remove that check
SIF ARG != MASTER && IS_FEMALE(ARG) && Qol_Info_Dates_Array:ARG:Qol_Dates_Semen > 0 && Qol_Info_Dates_Array:ARG:Qol_Dates_Creampie > 0 ;&& Qol_Info_Dates_Array:ARG:Qol_Dates_Orgasm > 0
	PRINTFORML She constantly thinks about nothing but having sex with you, having had her first pleasures as a woman together with you.
	
;hypnosis
SIF ARG == MASTER && Qol_Info_Count_Array:ARG:Qol_Count_Hypnosis > 0
	PRINTFORML In total, you have used hypnosis %PRINT_PLUR("time", Qol_Info_Count_Array:ARG:Qol_Count_Hypnosis)%\@ Qol_Info_Count_Array:ARG:Qol_Count_HypnosisFail > 0 ? %" "%(Including failures %PRINT_PLUR("time", Qol_Info_Count_Array:ARG:Qol_Count_HypnosisFail)%) #\@.
	
IF ARG != MASTER && Qol_Info_Count_Array:ARG:Qol_Count_Hypnos_Hostility + Qol_Info_Count_Array:ARG:Qol_Count_Hypnos_Consent + Qol_Info_Count_Array:ARG:Qol_Count_Hypnos_Arouse + Qol_Info_Count_Array:ARG:Qol_Count_CommonSense
	PRINTFORM In total, %HE_SHE(ARG)% has been hypnotized %PRINT_PLUR("time", Qol_Info_Count_Array:ARG:Qol_Count_Hypnos_Hostility + Qol_Info_Count_Array:ARG:Qol_Count_Hypnos_Consent + Qol_Info_Count_Array:ARG:Qol_Count_Hypnos_Arouse + Qol_Info_Count_Array:ARG:Qol_Count_CommonSense)%
	LOCAL:1 = 0
	LOCAL:2 = 0
	LOCAL:3 = 0
	LOCAL:4 = 0
	FOR LOCAL, 1, CHARANUM
		LOCAL:1 += Qol_Info_Count_Array:LOCAL:Qol_Count_Hypnos_Hostility
		LOCAL:2 += Qol_Info_Count_Array:LOCAL:Qol_Count_Hypnos_Consent
		LOCAL:3 += Qol_Info_Count_Array:LOCAL:Qol_Count_Hypnos_Arouse
		LOCAL:4 += Qol_Info_Count_Array:LOCAL:Qol_Count_CommonSense
	NEXT
	LOCALS =
	SIF LOCAL:1 > 0
		LOCALS += @"%HIS_HER(ARG)% hostility was suppressed %PRINT_PLUR("time", LOCAL:1)%、"
	SIF LOCAL:2 > 0
		LOCALS += @"fake consent was given %PRINT_PLUR("time", LOCAL:2)%、"
	SIF LOCAL:3 > 0
		LOCALS += @"%HE_SHE(ARG)% was aroused to %HIS_HER(ARG)% limit %PRINT_PLUR("time", LOCAL:3)%、"
	SIF LOCAL:4 > 0
		LOCALS += @"%HIS_HER(ARG)% common sense was altered %PRINT_PLUR("time", LOCAL:4)%、"
	SIF STRLENS(LOCALS)
		PRINTFORM , from which %LIST_IN_STRING(LOCALS)%.
	CALL PRINT_BREAK
	PRINTFORML
ENDIF

;encounters
IF ARG == MASTER
	SIF Qol_Info_Count_Array:ARG:Qol_Count_EncountWon
		PRINTFORML You have defeated your opponent in random encounters %PRINT_PLUR("time", Qol_Info_Count_Array:ARG:Qol_Count_EncountWon)%.
	SIF Qol_Info_Count_Array:ARG:Qol_Count_EncountLost
		PRINTFORML You have lost the fight in random encounters %PRINT_PLUR("time", Qol_Info_Count_Array:ARG:Qol_Count_EncountLost)%.
	SIF Qol_Info_Count_Array:ARG:Qol_Count_EncountMolest
		PRINTFORML You have been molested in random encounters %PRINT_PLUR("time", Qol_Info_Count_Array:ARG:Qol_Count_EncountMolest)%.
ENDIF

;activate with description
@QoL_Info_Write(ARG = -1, ARG:1, ARGS)
SIF ARG == -1
	ARG = TARGET
SIF ARG == MASTER && !INRANGE(ARG:1, 13, 28) && !GROUPMATCH(ARG:1, Qol_Dates_Bj, Qol_Dates_Semen, Qol_Dates_Creampie, Qol_Dates_ACreampie, Qol_Dates_Lactation, Qol_Dates_DeflowerOrgasm)
	RETURN 0
SIF GROUPMATCH(ARG:1, Qol_Dates_Creampie, Qol_Dates_Lactation, Qol_Dates_DeflowerOrgasm) && !IS_FEMALE(ARG) ;sex-locked
	RETURN 0
SIF Qol_Info_Dates_Array:ARG:(ARG:1) ;ignore already activated or disabled entries
	RETURN 0
	
SIF !SHIRAHU(ARG) && ARG != MASTER ;skip if time stop for target description
	GOTO SKIP
	
SELECTCASE ARG:1
	CASE Qol_Dates_Meet, Qol_Dates_Yearn, Qol_Dates_Love, Qol_Dates_GF, Qol_Dates_FBuddy, Qol_Dates_Lust, Qol_Dates_DeepLove
	CASE Qol_Dates_Bj, Qol_Dates_Lactation, Qol_Dates_Ejac
	CASE Qol_Dates_LewdLips, Qol_Dates_Masturb, Qol_Dates_LewdCervix, Qol_Dates_Musicality, Qol_Dates_Sound, Qol_Dates_Mixing, Qol_Dates_Finger, Qol_Dates_Tongue, Qol_Dates_LewdChest, Qol_Dates_LewdVagina, Qol_Dates_LewdAnus, Qol_Dates_Quad, Qol_Dates_Quint, Qol_Dates_FirstPeriod, Qol_Dates_LoveSemen, Qol_Dates_SexKnow
	CASE Qol_Dates_Engagement, Qol_Dates_Marriage, Qol_Dates_Concubine
	CASE Qol_Dates_Orgasm
		IF TALENT:ARG:羞恥心 == 1
			PRINTFORMDW Realizing that %HE_SHE(ARG)% just climaxed in front of you, %CALLNAME:ARG%'s face turns bright red with shame...
		ELSEIF CFLAG:ARG:2 >= 1500
			PRINTFORMDW After experiencing the first climax of %HIS_HER(ARG)% life with you, %CALLNAME:ARG% hugs you tightly and rubs %HIS_HER(ARG)% cheeks with yours...
		ELSE
			PRINTFORMDW %BREAKENG(@"After experiencing the first climax of %HIS_HER(ARG)% life with you, %CALLNAME:ARG% seems somewhat bewildered as %HE_SHE(ARG)% tries to regain %HIS_HER(ARG)% senses...")%
		ENDIF
	CASE Qol_Dates_Semen
		SIF ARG == MASTER
			GOTO SKIP
		SELECTCASE ARGS
			CASE "condom"
				PRINTFORMDW %CALLNAME:ARG% is playing with a condom with great interest, feeling very curious after seeing semen for the first time...
			CASE "69", "bj"
				PRINTFORMDW %CALLNAME:ARG% spits out a handful of semen %HE_SHE(ARG)% received for the first time into %HIS_HER(ARG)% palm and stares at it with interest...
			CASE "hj", "tj"
				PRINTFORMDW %CALLNAME:ARG% looks at the semen with great interest, seeing it for the first time...
			CASE "thigh"
				PRINTFORMDW %CALLNAME:ARG% scoops up the very first load of semen %HE_SHE(ARG)% received with %HIS_HER(ARG)% fingertips and stares at it with interest...
			CASE "foot", "foam"
				PRINTFORMDW %CALLNAME:ARG% gazes curiously at the first load of semen %HE_SHE(ARG)% received...
		CASEELSE
			PRINTFORMDW %CALLNAME:ARG% seems very curious about seeing semen for the first time...
		ENDSELECT
	CASE Qol_Dates_Creampie
		SIF ARG == MASTER
			GOTO SKIP
		SELECTCASE ARGS
			CASE "vag"
				SIF CFLAG:ARG:2 < 1500
					GOTO SKIP2
				PRINTFORMDW %BREAKENG(@"%CALLNAME:ARG% is stroking %HIS_HER(ARG)% belly, almost as though %HE_SHE(ARG)%'s cherishing the very first load of semen %HE_SHE(ARG)% received inside of %HIM_HER(ARG)%...")%
		CASEELSE
			$SKIP2
			PRINTFORMDW %BREAKENG(@"%CALLNAME:ARG% realizes that %HE_SHE(ARG)% just received a very first load of semen into %HIS_HER(ARG)% womb, looking surprised at the sudden warmth spreading through %HIS_HER(ARG)% body...")%
		ENDSELECT
	CASE Qol_Dates_ACreampie
		SIF ARG == MASTER
			GOTO SKIP
		PRINTFORMDW %CALLNAME:ARG% stares curiously at the very first load of semen dripping from %HIS_HER(ARG)% anus...
	CASE Qol_Dates_DeflowerOrgasm
		IF ARG == MASTER
			PRINTFORML You thrash about and convulse after having an orgasm from your very first vaginal sex...
		ELSE
			PRINTFORML %CALLNAME:ARG% thrashes about and convulses after having an orgasm from her very first vaginal sex...
		ENDIF
CASEELSE
	PRINTFORMW QoL_Info_Write Date Error! ARG:1 - {ARG:1}
ENDSELECT
$SKIP
Qol_Info_Dates_Array:ARG:(ARG:1) = DAY
Qol_Info_World_Array:ARG:(ARG:1) = FLAG:周回数

IF GROUPMATCH(ARG:1, Qol_Dates_Meet) ;add as needed
	IF !IN_HOME(CFLAG:ARG:現在位置) && CFLAG:ARG:現在位置 != OMANEKIBEYA()
		LOCALS = %DATENAME_SPOT_TR()%
	ELSE
		LOCALS = %AT_IN_ON(CFLAG:ARG:現在位置)%
	ENDIF
	SIF !(CFLAG:ARG:現在位置 == OMANEKIBEYA()) ;do not print when you're doing it in the private room since it's glitched (position 998)
		LOCALS += " at the " + GET_MAPNAME(GET_MAPID(CFLAG:ARG:現在位置))
	Qol_Info_Dates_Str:ARG:(ARG:1) '= LOCALS
ENDIF

;@Qol_Info_Penis(ARG)

@Qol_Info_Reset_Category(CHARA, CATEGORY, VALID_CONDITION)
#DIM CHARA
#DIM CATEGORY
#DIM VALID_CONDITION

;if the condition was already reached before, set it to -1 to mark it as invalid 
IF VALID_CONDITION && Qol_Info_Dates_Array:CHARA:CATEGORY == 0
	Qol_Info_Dates_Array:CHARA:CATEGORY = -1
;if the condition is no longer valid, reset the date
ELSEIF !VALID_CONDITION && Qol_Info_Dates_Array:CHARA:CATEGORY
	Qol_Info_Dates_Array:CHARA:CATEGORY = 0
ENDIF
Qol_Info_World_Array:CHARA:CATEGORY = -1

@Qol_Info_Reset(ARG)
CALL Qol_Info_Reset_Category(ARG, Qol_Dates_Meet, CFLAG:ARG:面識)
CALL Qol_Info_Reset_Category(ARG, Qol_Dates_Yearn, TALENT:ARG:思慕 || TALENT:ARG:恋慕)
CALL Qol_Info_Reset_Category(ARG, Qol_Dates_Love, TALENT:ARG:恋慕)
CALL Qol_Info_Reset_Category(ARG, Qol_Dates_GF, TALENT:ARG:恋人)
CALL Qol_Info_Reset_Category(ARG, Qol_Dates_FBuddy, TALENT:ARG:セフレ || TALENT:ARG:愛欲)
CALL Qol_Info_Reset_Category(ARG, Qol_Dates_Lust, TALENT:ARG:愛欲)
CALL Qol_Info_Reset_Category(ARG, Qol_Dates_Orgasm, EXP:ARG:絶頂経験 > 0)
CALL Qol_Info_Reset_Category(ARG, Qol_Dates_Ejac, EXP:ARG:射精経験 > 0)
CALL Qol_Info_Reset_Category(ARG, Qol_Dates_Semen, EXP:ARG:精液経験 > 0)
CALL Qol_Info_Reset_Category(ARG, Qol_Dates_Creampie, EXP:ARG:膣射経験 > 0)
CALL Qol_Info_Reset_Category(ARG, Qol_Dates_ACreampie, EXP:ARG:肛射経験 > 0)
CALL Qol_Info_Reset_Category(ARG, Qol_Dates_Bj, EXP:ARG:口淫経験 > 0)
CALL Qol_Info_Reset_Category(ARG, Qol_Dates_Lactation, EXP:ARG:噴乳経験 > 0)

CALL Qol_Info_Reset_Category(ARG, Qol_Dates_LewdLips, TALENT:ARG:キス魔)
CALL Qol_Info_Reset_Category(ARG, Qol_Dates_Masturb, TALENT:ARG:自慰狂い)
CALL Qol_Info_Reset_Category(ARG, Qol_Dates_LewdCervix, TALENT:ARG:ポルチオ性感)
CALL Qol_Info_Reset_Category(ARG, Qol_Dates_Musicality, TALENT:ARG:音楽知識)
CALL Qol_Info_Reset_Category(ARG, Qol_Dates_Sound, TALENT:ARG:音感)
CALL Qol_Info_Reset_Category(ARG, Qol_Dates_Mixing, TALENT:ARG:調合知識)
CALL Qol_Info_Reset_Category(ARG, Qol_Dates_Finger, TALENT:ARG:器用な指)
CALL Qol_Info_Reset_Category(ARG, Qol_Dates_Tongue, TALENT:ARG:舌使い)
CALL Qol_Info_Reset_Category(ARG, Qol_Dates_LewdChest, TALENT:ARG:淫乳)
CALL Qol_Info_Reset_Category(ARG, Qol_Dates_LewdVagina, TALENT:ARG:淫壺)
CALL Qol_Info_Reset_Category(ARG, Qol_Dates_LewdAnus, TALENT:ARG:尻穴狂い)	

CALL Qol_Info_Reset_Category(ARG, Qol_Dates_FirstPeriod, TALENT:ARG:初潮)
CALL Qol_Info_Reset_Category(ARG, Qol_Dates_LoveSemen, TALENT:ARG:精愛味覚)
CALL Qol_Info_Reset_Category(ARG, Qol_Dates_SexKnow, !TALENT:ARG:無知)

IF TALENT:ARG:処女 == 1
	Qol_Info_Dates_Array:ARG:Qol_Dates_DeflowerOrgasm = 0
ENDIF

IF !EXP:ARG:絶頂経験
	Qol_Info_Count_Array:ARG:Qol_Count_Orgasms = 0
	Qol_Info_Dates_Array:ARG:Qol_Dates_Quad = 0
	Qol_Info_Dates_Array:ARG:Qol_Dates_Quint = 0
ENDIF
SIF !EXP:ARG:Ｖ性交経験
	Qol_Info_Count_Array:ARG:Qol_Count_VSex = 0
SIF !EXP:ARG:Ａ性交経験
	Qol_Info_Count_Array:ARG:Qol_Count_ASex = 0

IF !EXP:ARG:挿入経験
	Qol_Info_Count_Array:ARG:Qol_Count_VGiveSex = 0
	Qol_Info_Count_Array:ARG:Qol_Count_AGiveSex = 0
	Qol_Info_Count_Array:ARG:Qol_Count_UncVGiveSex = 0
	Qol_Info_Count_Array:ARG:Qol_Count_UncAGiveSex = 0
ENDIF
IF !EXP:ARG:口淫経験
	Qol_Info_Count_Array:ARG:Qol_Count_MSex = 0
	Qol_Info_Count_Array:ARG:Qol_Count_MSexCunni = 0
	Qol_Info_Count_Array:ARG:Qol_Count_MSexAnal = 0
	Qol_Info_Count_Array:ARG:Qol_Count_MSexNip = 0
	Qol_Info_Count_Array:ARG:Qol_Count_MSexDeepThroat = 0
ENDIF

SIF !EXP:ARG:精液経験
	Qol_Info_Count_Array:ARG:Qol_Count_Semen = 0
SIF !EXP:ARG:精飲経験
	Qol_Info_Count_Array:ARG:Qol_Count_SemenDrink = 0
SIF !EXP:ARG:膣射経験
	Qol_Info_Count_Array:ARG:Qol_Count_SemenV = 0
SIF !EXP:ARG:肛射経験
	Qol_Info_Count_Array:ARG:Qol_Count_SemenA = 0

IF !EXP:ARG:射精経験
	Qol_Info_Count_Array:ARG:Qol_Count_EjacV = 0
	Qol_Info_Count_Array:ARG:Qol_Count_EjacA = 0
	Qol_Info_Count_Array:ARG:Qol_Count_EjacM = 0
ENDIF

SIF !EXP:ARG:キス経験
	Qol_Info_Count_Array:ARG:Qol_Count_Kiss = 0
SIF !CFLAG:ARG:子供人数
	Qol_Info_Count_Array:ARG:Qol_Count_Birth = 0
IF !EXP:ARG:噴乳経験
	Qol_Info_Count_Array:ARG:Qol_Count_MilkDrankBottle = 0
	Qol_Info_Count_Array:ARG:Qol_Count_MilkDrankNipple = 0
	Qol_Info_Count_Array:ARG:Qol_Count_MilkLactated = 0
	Qol_Info_Count_Array:ARG:Qol_Count_MilkCollected = 0
ENDIF

SIF !EXP:ARG:無自覚Ｖ経験
	Qol_Info_Count_Array:ARG:Qol_Count_UncVSex = 0
SIF !EXP:ARG:無自覚Ａ経験
	Qol_Info_Count_Array:ARG:Qol_Count_UncASex = 0

SIF !CFLAG:ARG:面識
	Qol_Info_Dates_Str:ARG:Qol_Dates_Meet = ""

;when starting the day
@EVENTTRAIN
#PRI
IF Qol_Info_Dates_Init == 2 ;update to account for worlds
	Qol_Info_Dates_Init = 3
	FOR LOCAL,0,CHARANUM
		FOR LOCAL:1, 0, Qol_Info_Dates_Size
			SIF Qol_Info_Dates_Array:LOCAL:(LOCAL:1)
				Qol_Info_World_Array:LOCAL:(LOCAL:1) = FLAG:周回数
		NEXT
	NEXT	
ELSEIF Qol_Info_Dates_Init < 2 ;init on existing saves and etc
	Qol_Info_Dates_Init = 3
	
	FOR LOCAL,0,CHARANUM
		CALL Qol_Info_Reset(LOCAL)
	NEXT
ENDIF

;at the very end after executing the command and processing its effects (basically before starting a new train turn)
@EVENTCOMEND
#PRI
;would be better in EVENT_MESSAGE_ORGASM.ERB, but it's already cluttered as is
;event occurrences outside of normal gameplay probably won't count, but eh
FOR LOCAL, 1, CHARANUM
	SIF CFLAG:LOCAL:現在位置 != CFLAG:MASTER:現在位置 ;just see that they're together with you, 99% should be accurate
		CONTINUE
	Qol_Info_Count_Array:LOCAL:Qol_Count_Orgasms += EXP_UP(GETNUM(EXP, "絶頂経験"), LOCAL)
	Qol_Info_Count_Array:LOCAL:Qol_Count_Semen += EXP_UP(GETNUM(EXP, "精液経験"), LOCAL)
	SIF !SHIRAHU(LOCAL)
		Qol_Info_Count_Array:LOCAL:Qol_Count_UncSemen += EXP_UP(GETNUM(EXP, "精液経験"), LOCAL)
	Qol_Info_Count_Array:LOCAL:Qol_Count_SemenDrink += EXP_UP(GETNUM(EXP, "精飲経験"), LOCAL)
	Qol_Info_Count_Array:LOCAL:Qol_Count_SemenV += EXP_UP(GETNUM(EXP, "膣射経験"), LOCAL)
	Qol_Info_Count_Array:LOCAL:Qol_Count_SemenA += EXP_UP(GETNUM(EXP, "肛射経験"), LOCAL)
	;doesn't apply properly in ts, sleep rape
	;Qol_Info_Count_Array:LOCAL:Qol_Count_VSex += EXP_UP(GETNUM(EXP, "Ｖ性交経験"), LOCAL)
	;Qol_Info_Count_Array:LOCAL:Qol_Count_ASex += EXP_UP(GETNUM(EXP, "Ａ性交経験"), LOCAL)
	;Qol_Info_Count_Array:LOCAL:Qol_Count_Kiss += EXP_UP(GETNUM(EXP, "キス経験"), LOCAL)
NEXT

@QOL_CHARA_SCORES(C_ID)
#DIM C_ID

#DIM SCORE_NO			; 楽譜番号
#DIM SERIES_NO			; シリーズ番号
#DIM SERIES_SCORE_NO	; シリーズ内の楽譜番号
#DIMS sPrint_Text		        ; HTML_PRINTする文字列TEMP
#DIM SCORE_INFO
#DIM CHARA_SERIES, 50 ;holds the series' the character applies to, may need to be increased at some point
#DIM CHARA_SERIES_COUNT
#DIMS SCORES_HTML, 10 ;keeps a list of html buttons to be printed later
#DIM  SCORES_COUNT ;per album

SERIES_NO = -1
;may contain duplicates 
CHARA_SERIES_COUNT = EXEC_SCORES(楽譜処理モード：キャラ関連シリーズを全取得, NO:C_ID)
ARRAYCOPY "RESULT", "CHARA_SERIES"
;special cases that aren't just "great performance" checks
SELECTCASE C_ID
    CASE [[サニー]], [[ルナ]], [[スター]], [[大妖精]], [[チルノ]] ;sunny, luna, star, daiyousei, or cirno
        CHARA_SERIES:(CHARA_SERIES_COUNT++) = 17 ;fairy wars
    CASE [[文]] ;aya
        CHARA_SERIES:(CHARA_SERIES_COUNT++) = 10 ;shoot the bullet
    CASE [[はたて]] ;hatate
        CHARA_SERIES:(CHARA_SERIES_COUNT++) = 16 ;double spoiler
    CASE [[正邪]] ;seija (not really character-related, but it does kind of relate to her)
        CHARA_SERIES:(CHARA_SERIES_COUNT++) = 21 ;danmaku amanojaku
ENDSELECT
ARRAYSORT CHARA_SERIES, FORWARD, 0, CHARA_SERIES_COUNT

SIF CHARA_SERIES_COUNT <= 0
    RETURN
PRINTFORML
CALL PRINTBUTTON_EX("收集的乐谱",909,TFLAG_HideSongs, , , 1)
SIF TFLAG_HideSongs
    RETURN

sPrint_Text =
FOR LOCAL, 0, CHARA_SERIES_COUNT
    SIF CHARA_SERIES:LOCAL < 0
        BREAK
    SIF SERIES_NO == CHARA_SERIES:LOCAL ;already handled
        CONTINUE
    SCORES_COUNT = 0
    VARSET SCORES_HTML

    SERIES_NO = CHARA_SERIES:LOCAL
    PRINTFORML 【{SERIES_NO + 1,2}:%GET_SERIES_NAME(SERIES_NO)%】
    FOR SERIES_SCORE_NO, 0, 楽譜最大数（シリーズ毎）
        SCORE_NO = 楽譜名開始番号 + SERIES_NO * 楽譜最大数（シリーズ毎）+ SERIES_SCORE_NO
        SCORE_INFO = GET_SCORE_INFO_NO(SCORE_NO)

        ;we don't need to do many further checks since we only look at albums the character is involved in
        SELECTCASE SCORE_INFO
            CASE IS < 楽譜入手方法：ランダム
                SIF FINDELEMENT(nTempScoreInfo, NO:C_ID) < 0
                    CONTINUE
            CASE 楽譜入手方法：シリーズ関連キャラ弾幕勝負
            CASE 楽譜入手方法：シリーズ関連キャラ陥落
            CASE 楽譜入手方法：妖精依頼成功
                ;marisa is also on this album but doesn't qualify for these
                SIF !GROUPMATCH(NO:C_ID, [[サニー]], [[ルナ]], [[スター]], [[大妖精]], [[チルノ]])
                    CONTINUE
            CASE 楽譜入手方法：文依頼成功
            CASE 楽譜入手方法：はたて依頼成功
            CASE 楽譜入手方法：依賴失敗時
            CASEELSE
                CONTINUE
        ENDSELECT

        CALL QOL_DISPLAY_SCORE_MAKE_HTML(SCORES_HTML, SCORES_COUNT, -999, SCORE_NO, SERIES_SCORE_NO)
    NEXT
    CALL QOL_PRINT_SCORES(SCORES_HTML, SCORES_COUNT)
    PRINTL
NEXT

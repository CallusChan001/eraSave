@QOL_COM_ORDER_ELEMENT(ARG:0, ARGS:1, ARG:2, ARG:3 = -1)
SIF ARG:3 < 0
	ARG:3 = ARG
IF TCVAR:(ARG:0):Com_Order_Value == -10000
	TCVAR:(ARG:0):Com_Order_Value = 0
ELSEIF ARG:2 >= 0
	PRINT  + 
ELSE
	PRINT  - 
ENDIF
PRINTFORM %COND_STR("你的", ARG:3 == PLAYER)%%ARGS:1%({ABS(ARG:2)})
TCVAR:(ARG:0):Com_Order_Value += ARG:2

;ARG=CHARA
;ARGS:1=ABL
;ARG:2=Multiplier
;ARG:3=source of the value (target or player)
@QOL_COM_ORDER_ELEMENT_ABL(ARG, ARGS:1, ARG:2, ARG:3 = -1)
SIF ARG:3 < 0
	ARG:3 = ARG
LOCAL = FINDELEMENT(ABLNAME, ARGS:1)
CALL QOL_COM_ORDER_ELEMENT(ARG, @"%ABL_TR(LOCAL)%LV{ABL:(ARG:3):LOCAL}", ABL:(ARG:3):LOCAL * ARG:2, ARG:3)

;ARG=CHARA
;ARGS:1=TALENT
;ARG:2=Value
;ARG:3=source of the value (target or player)
@QOL_COM_ORDER_ELEMENT_TALENT(ARG, ARGS:1, ARG:2, ARG:3 = -1)
SIF ARG:3 < 0
	ARG:3 = ARG
LOCAL = FINDELEMENT(TALENTNAME, ARGS:1)
CALL QOL_COM_ORDER_ELEMENT(ARG, @"%GET_TALENTNAME(LOCAL, TALENT:(ARG:3):LOCAL)%", ARG:2, ARG:3)

;ARG=CHARA
;ARGS:1=MARK
;ARG:2=Multiplier
;ARG:3=source of the value (target or player)
@QOL_COM_ORDER_ELEMENT_MARK(ARG, ARGS:1, ARG:2, ARG:3 = -1)
SIF ARG:3 < 0
	ARG:3 = ARG
LOCAL = FINDELEMENT(MARKNAME, ARGS:1)
CALL QOL_COM_ORDER_ELEMENT(ARG, @"%MARK_TR(LOCAL)%LV{MARK:(ARG:3):LOCAL}", MARK:(ARG:3):LOCAL * ARG:2, ARG:3)

;ARG=CHARA
;ARGS:1=PALAM
;ARG:2=Multiplier
;ARG:3=Max level
;ARG:4=source of the value (target or player)
@QOL_COM_ORDER_ELEMENT_PALAM(ARG, ARGS:1, ARG:2, ARG:3, ARG:4 = -1)
SIF ARG:4 < 0
	ARG:4 = ARG
LOCAL = FINDELEMENT(PALAMNAME, ARGS:1)
CALL QOL_COM_ORDER_ELEMENT(ARG, @"%PALAM_TR(ARGS:1)%LV{GETPALAMLV(PALAM:(ARG:4):LOCAL,ARG:3)}", GETPALAMLV(PALAM:(ARG:4):LOCAL,ARG:3) * ARG:2, ARG:4)

@QOL_COM_ORDER_STANDARD(ARG)
SIF ABL:ARG:親密
	CALL QOL_COM_ORDER_ELEMENT_ABL(ARG, "親密", 1)
SIF ABL:ARG:従順
	CALL QOL_COM_ORDER_ELEMENT_ABL(ARG, "従順", 4)
SIF ABL:ARG:マゾっ気
	CALL QOL_COM_ORDER_ELEMENT_ABL(ARG, "受虐属性", 2)
IF HETEROSEX(ARG,PLAYER) == 1
	SIF ABL:ARG:レズっ気
		CALL QOL_COM_ORDER_ELEMENT_ABL(ARG, "百合属性", 3)
	SIF ABL:ARG:レズ中毒
		CALL QOL_COM_ORDER_ELEMENT_ABL(ARG, "百合中毒", 3)
	SIF TALENT:ARG:性別嗜好 == -1
		CALL QOL_COM_ORDER_ELEMENT_TALENT(ARG, "性別嗜好", 10)
	SIF TALENT:ARG:性的兴趣 > 0
		CALL QOL_COM_ORDER_ELEMENT_TALENT(ARG, "性的兴趣", 7)
	SIF TALENT:ARG:性的兴趣 < 0
		CALL QOL_COM_ORDER_ELEMENT_TALENT(ARG, "性的兴趣", -13)
ELSEIF HETEROSEX(TARGET,PLAYER) == 2
	SIF ABL:ARG:ホモっ気
		CALL QOL_COM_ORDER_ELEMENT_ABL(ARG, "断袖属性", 3)
	SIF ABL:ARG:ゲイ中毒
		CALL QOL_COM_ORDER_ELEMENT_ABL(ARG, "断袖中毒", 3)
	SIF TALENT:ARG:性別嗜好 == -1
		CALL QOL_COM_ORDER_ELEMENT_TALENT(ARG, "性別嗜好", 10)
	SIF TALENT:ARG:性的兴趣 > 0
		CALL QOL_COM_ORDER_ELEMENT_TALENT(ARG, "性的兴趣", 7)
	SIF TALENT:ARG:性的兴趣 < 0
		CALL QOL_COM_ORDER_ELEMENT_TALENT(ARG, "性的兴趣", -13)
ELSE
	SIF TALENT:ARG:性的兴趣 > 0
		CALL QOL_COM_ORDER_ELEMENT_TALENT(ARG, "性的兴趣", 5)
	SIF TALENT:ARG:性的兴趣 < 0
		CALL QOL_COM_ORDER_ELEMENT_TALENT(ARG, "性的兴趣", -10)
ENDIF
SIF MARK:ARG:苦痛刻印
	CALL QOL_COM_ORDER_ELEMENT_MARK(ARG, "苦痛刻印", 5)
IF TALENT:ARG:自尊心 > 0
	T = 4
ELSEIF TALENT:ARG:自尊心 < 0
	T = 1
ELSE
	T = 2
ENDIF
SIF MARK:ARG:不埒刻印
	CALL QOL_COM_ORDER_ELEMENT_MARK(ARG, "不埒刻印", 3 * T)
SIF MARK:ARG:反発刻印
	CALL QOL_COM_ORDER_ELEMENT_MARK(ARG, "反発刻印", -2 * T)

SIF GETPALAMLV(PALAM:ARG:恭順,5)
	CALL QOL_COM_ORDER_ELEMENT_PALAM(ARG, "恭順", 3, 5)
SIF GETPALAMLV(PALAM:ARG:恐怖,5)
	CALL QOL_COM_ORDER_ELEMENT_PALAM(ARG, "恐怖", 3, 5)

;Rape expansion customs
; ;Terror makes the Touhou more likely to do your commands
; SIF GETPALAMLV(PALAM:ARG:Terror,5)
; 	CALL QOL_COM_ORDER_ELEMENT_PALAM(ARG, "Terror", 3, 5)

SIF TALENT:ARG:服従
	CALL QOL_COM_ORDER_ELEMENT_TALENT(ARG, "服従", 10)
SIF TALENT:ARG:態度 > 0 && TALENT:ARG:恋慕 ;adjusted to check for love, as per description
	CALL QOL_COM_ORDER_ELEMENT_TALENT(ARG, "態度", -5)
SIF TALENT:ARG:胆量 > 0
	CALL QOL_COM_ORDER_ELEMENT_TALENT(ARG, "胆量", -5)
SIF TALENT:ARG:態度 < 0
	CALL QOL_COM_ORDER_ELEMENT_TALENT(ARG, "態度", 5)
SIF TALENT:ARG:自尊心 > 0
	CALL QOL_COM_ORDER_ELEMENT_TALENT(ARG, "自尊心", -15)
SIF TALENT:ARG:自尊心 < 0
	CALL QOL_COM_ORDER_ELEMENT_TALENT(ARG, "自尊心", 5)
SIF TALENT:ARG:喜歡引人注目 < 0
	CALL QOL_COM_ORDER_ELEMENT_TALENT(ARG, "喜歡引人注目", 2)
SIF TALENT:ARG:自己愛 < 0
	CALL QOL_COM_ORDER_ELEMENT_TALENT(ARG, "自己愛", -10)
SIF TALENT:ARG:抵抗 < 0
	CALL QOL_COM_ORDER_ELEMENT_TALENT(ARG, "抵抗", -10)
SIF TALENT:ARG:把柄 < 0
	CALL QOL_COM_ORDER_ELEMENT_TALENT(ARG, "把柄", 12)
SIF TALENT:ARG:容易高潮 < 0
	CALL QOL_COM_ORDER_ELEMENT_TALENT(ARG, "容易高潮", 10)
SIF TALENT:ARG:迷信
	CALL QOL_COM_ORDER_ELEMENT_TALENT(ARG, "迷信", 8)

SIF ABL:PLAYER:施虐属性
	CALL QOL_COM_ORDER_ELEMENT_ABL(ARG, "施虐属性", 2, PLAYER)
SIF TALENT:PLAYER:魅惑
	CALL QOL_COM_ORDER_ELEMENT_TALENT(ARG, "魅惑", 6, PLAYER)
SIF TALENT:PLAYER:謎之魅力
	CALL QOL_COM_ORDER_ELEMENT_TALENT(ARG, "謎之魅力", 8, PLAYER)
SIF TALENT:PLAYER:受虐狂
	CALL QOL_COM_ORDER_ELEMENT_TALENT(ARG, "受虐狂", 3, PLAYER)
SIF TALENT:PLAYER:容姿 > 0
	CALL QOL_COM_ORDER_ELEMENT_TALENT(ARG, "容姿", 4, PLAYER)

SIF TCVAR:ARG:泥酔 == 1
	CALL QOL_COM_ORDER_ELEMENT(ARG, "醉了", 20)
SIF CFLAG:負け犬
	CALL QOL_COM_ORDER_ELEMENT(ARG, "败犬", 20)
;custom code: rape expansion
SIF TCVAR:ARG:無理矢理
	CALL QOL_COM_ORDER_ELEMENT(ARG, "强迫", 1000)

CALL QOL_COM_ORDER_AFFINITY(ARG, NO:PLAYER)

@QOL_COM_ORDER_V_INSERT(ARG)
;;NAS: Universal Insertion
;CALL NAS_INSERT_CHECK(ARG, MASTER)
;IF RESULT == -1
;	SKIPDISP 0
;	CALL QOL_COM_ORDER_ELEMENT(ARG, @"没有%CALLNAME:ARG%的合意", -10000)
;	RETURN 0
;ELSEIF RESULT == -2
;	SKIPDISP 0
;	CALL QOL_COM_ORDER_ELEMENT(ARG, "不在安定期", -10000)
;	RETURN 0
;ENDIF
;
;;custom code: Show a message instead of hiding
;CALL Add_COM_ORDER_HOLE(ARG, MASTER, "")
;SIF RESULT
;	RETURN 0

;custom code
IF CFLAG:破瓜キャンセル口上有 && SHIRAHU(ARG) && GROUPMATCH(TALENT:ARG:処女, 1, -1)
	CALL KOJO_MESSAGE_SEND("LOST_VIRGIN_STOP", 0, ARG)
	SELECTCASE RESULT
		CASE 1
			CALL QOL_COM_ORDER_ELEMENT(ARG, @"%CALLNAME:ARG%不允许", -9999)
			RETURN 0
		CASE -1
			CALL QOL_COM_ORDER_ELEMENT(ARG, @"%CALLNAME:ARG%同意了", 10000)
			RETURN 1
	ENDSELECT
ENDIF
CALL QOL_COM_ORDER_STANDARD(ARG)
SIF ABL:ARG:欲望
	CALL QOL_COM_ORDER_ELEMENT_ABL(ARG, "欲望", 3)
SIF ABL:ARG:Ｖ感覚
	CALL QOL_COM_ORDER_ELEMENT_ABL(ARG, "Ｖ感覚", 2)

SIF MARK:ARG:快楽刻印
	CALL QOL_COM_ORDER_ELEMENT_MARK(ARG, "快楽刻印", 3)

SIF PALAM:ARG:潤滑 < PALAMLV:3
	CALL QOL_COM_ORDER_ELEMENT(ARG, "不够湿", -5)
SIF GETPALAMLV(PALAM:ARG:欲情,5)
	CALL QOL_COM_ORDER_ELEMENT_PALAM(ARG, "欲情", 3, 5)
SIF TALENT:ARG:羞恥心 > 0
	CALL QOL_COM_ORDER_ELEMENT_TALENT(ARG, "羞恥心", -2)
SIF TALENT:ARG:快感応答 < 0 && ABL:ARG:欲望 < 20
	CALL QOL_COM_ORDER_ELEMENT_TALENT(ARG, "快感応答", -5)

SIF OTOKOGIRAI(ARG)
	CALL QOL_COM_ORDER_ELEMENT_TALENT(ARG, "性別嗜好", -12)
SIF TALENT:ARG:恋慕 && ASSIPLAY == 0
	CALL QOL_COM_ORDER_ELEMENT_TALENT(ARG, "恋慕", 15)
T = MAX(10,40 - EXP:ARG:Ｖ経験) 
IF TALENT:ARG:処女 && ASSIPLAY == 0
	CALL QOL_COM_ORDER_ELEMENT_TALENT(ARG, "処女", -T)
ELSEIF EXP:ARG:Ｖ経験 < EXPLV:2
	CALL QOL_COM_ORDER_ELEMENT(ARG, "不谙人事", -15)
ENDIF
SIF (TALENT:PLAYER:2 & 3) == 3
	CALL QOL_COM_ORDER_ELEMENT_TALENT(ARG, "性別", 4, PLAYER)
SIF TCVAR:ARG:媚薬
	CALL QOL_COM_ORDER_ELEMENT(ARG, "媚药", 6)

@QOL_COM_ORDER_V_PARTIAL(ARG)
SIF ABL:ARG:Ｖ感覚
	CALL QOL_COM_ORDER_ELEMENT_ABL(ARG, "Ｖ感覚", 2)
T = MAX(10,40 - EXP:ARG:Ｖ経験) 
IF TALENT:ARG:処女 && ASSIPLAY == 0
	CALL QOL_COM_ORDER_ELEMENT_TALENT(ARG, "処女", -T)
ELSEIF EXP:ARG:Ｖ経験 < EXPLV:2
	CALL QOL_COM_ORDER_ELEMENT(ARG, "不谙人事", -15)
ENDIF

@QOL_COM_ORDER_A_INSERT(ARG)
;custom code: Show a message instead of hiding
;CALL Add_COM_ORDER_HOLE(ARG, MASTER, "A")
;SIF RESULT
;	RETURN 0

;custom code
IF CFLAG:口上用アナル処女喪失判定 && SHIRAHU(ARG) && !CFLAG:アナル処女喪失記念日
	CALL KOJO_MESSAGE_SEND("PERMISSION", 4, ARG)
	SELECTCASE RESULT
		CASE -1
			CALL QOL_COM_ORDER_ELEMENT(ARG, @"%CALLNAME:ARG%不允许", -9999)
			RETURN 0
		CASE -1
			CALL QOL_COM_ORDER_ELEMENT(ARG, @"%CALLNAME:ARG%同意了", 10000)
			RETURN 1
	ENDSELECT
ENDIF

CALL QOL_COM_ORDER_STANDARD(ARG)
SIF ABL:ARG:欲望
	CALL QOL_COM_ORDER_ELEMENT_ABL(ARG, "欲望", 3)
SIF ABL:ARG:Ａ感覚
	CALL QOL_COM_ORDER_ELEMENT_ABL(ARG, "Ａ感覚", 2)

SIF MARK:ARG:快楽刻印
	CALL QOL_COM_ORDER_ELEMENT_MARK(ARG, "快楽刻印", 3)

SIF PALAM:ARG:潤滑 < PALAMLV:3
	CALL QOL_COM_ORDER_ELEMENT(ARG, "不够湿", -5)
SIF GETPALAMLV(PALAM:ARG:欲情,5)
	CALL QOL_COM_ORDER_ELEMENT_PALAM(ARG, "欲情", 3, 5)
SIF TALENT:ARG:羞恥心 > 0
	CALL QOL_COM_ORDER_ELEMENT_TALENT(ARG, "羞恥心", -2)
SIF TALENT:ARG:快感応答 < 0 && ABL:ARG:欲望 < 20
	CALL QOL_COM_ORDER_ELEMENT_TALENT(ARG, "快感応答", -5)

SIF OTOKOGIRAI(ARG)
	CALL QOL_COM_ORDER_ELEMENT_TALENT(ARG, "性別嗜好", -12)
SIF TALENT:ARG:恋慕 && ASSIPLAY == 0
	CALL QOL_COM_ORDER_ELEMENT_TALENT(ARG, "恋慕", 15)

SIF TALENT:ARG:淫乱 && ASSIPLAY == 0
	CALL QOL_COM_ORDER_ELEMENT_TALENT(ARG, "淫乱", 15)
SIF EXP:ARG:Ａ経験 < EXPLV:2
	CALL QOL_COM_ORDER_ELEMENT(ARG, "经验不足", -30)
SIF (TALENT:PLAYER:2 & 3) == 3
	CALL QOL_COM_ORDER_ELEMENT_TALENT(ARG, "性別", 4, PLAYER)
SIF TCVAR:ARG:媚薬
	CALL QOL_COM_ORDER_ELEMENT(ARG, "媚药", 6)

@QOL_COM_ORDER_A_PARTIAL(ARG)
SIF ABL:ARG:Ａ感覚
	CALL QOL_COM_ORDER_ELEMENT_ABL(ARG, "Ａ感覚", 2)
SIF EXP:Ａ経験 < EXPLV:2
	CALL QOL_COM_ORDER_ELEMENT(ARG, "经验不足", -30)

@QOL_COM_ORDER_SERVICE(ARG)
CALL QOL_COM_ORDER_STANDARD(ARG)

SIF ABL:ARG:欲望
	CALL QOL_COM_ORDER_ELEMENT_ABL(ARG, "欲望", 1)
SIF ABL:ARG:奉仕精神
	CALL QOL_COM_ORDER_ELEMENT_ABL(ARG, "奉仕精神", 4)
SIF MARK:ARG:快楽刻印
	CALL QOL_COM_ORDER_ELEMENT_MARK(ARG, "快楽刻印", 1)
SIF GETPALAMLV(PALAM:ARG:欲情,5)
	CALL QOL_COM_ORDER_ELEMENT_PALAM(ARG, "欲情", 1, 5)
SIF TALENT:ARG:羞恥心 > 0
	CALL QOL_COM_ORDER_ELEMENT_TALENT(ARG, "羞恥心", -1)
SIF TALENT:ARG:汚臭耐性 > 0
	CALL QOL_COM_ORDER_ELEMENT_TALENT(ARG, "汚臭耐性", 1)
SIF TALENT:ARG:汚臭耐性 < 0
	CALL QOL_COM_ORDER_ELEMENT_TALENT(ARG, "汚臭耐性", -3)
SIF TALENT:ARG:献身的
	CALL QOL_COM_ORDER_ELEMENT_TALENT(ARG, "献身的", 6)

SIF TALENT:ARG:快感応答 < 0 && ABL:ARG:欲望 < 20
	CALL QOL_COM_ORDER_ELEMENT_TALENT(ARG, "快感応答", -1)
SIF TALENT:ARG:恋慕 && ASSIPLAY == 0
	CALL QOL_COM_ORDER_ELEMENT_TALENT(ARG, "恋慕", 5)
SIF (TALENT:PLAYER:2 & 3) == 3
	CALL QOL_COM_ORDER_ELEMENT_TALENT(ARG, "性別", 4, PLAYER)
	
@QOL_COM_ORDER_EXPOSURE(ARG)
CALL QOL_COM_ORDER_STANDARD(ARG)
SIF ABL:ARG:欲望
 	CALL QOL_COM_ORDER_ELEMENT_ABL(ARG, "欲望", 3)
SIF ABL:ARG:露出癖
 	CALL QOL_COM_ORDER_ELEMENT_ABL(ARG, "露出癖", 4)
SIF ABL:ARG:自慰中毒
 	CALL QOL_COM_ORDER_ELEMENT_ABL(ARG, "自慰中毒", 3)
SIF MARK:ARG:快楽刻印
 	CALL QOL_COM_ORDER_ELEMENT_MARK(ARG, "快楽刻印", 3)
SIF TALENT:ARG:自制心
 	CALL QOL_COM_ORDER_ELEMENT_TALENT(ARG, "自制心", -5)
SIF TALENT:ARG:羞恥心 > 0
 	CALL QOL_COM_ORDER_ELEMENT_TALENT(ARG, "羞恥心", -5)
SIF TALENT:ARG:羞恥心 < 0
 	CALL QOL_COM_ORDER_ELEMENT_TALENT(ARG, "羞恥心", 2)
SIF TALENT:ARG:容易自慰
 	CALL QOL_COM_ORDER_ELEMENT_TALENT(ARG, "容易自慰", 5)
SIF TALENT:ARG:快感応答 > 0
 	CALL QOL_COM_ORDER_ELEMENT_TALENT(ARG, "快感応答", 5)
SIF TALENT:ARG:快感応答 < 0 && ABL:ARG:欲望 < 20
 	CALL QOL_COM_ORDER_ELEMENT_TALENT(ARG, "快感応答", -5)
SIF TCVAR:ARG:媚薬
	CALL QOL_COM_ORDER_ELEMENT(ARG, "媚药", 8)

@QOL_COM_ORDER_EXPOSURE_PART(ARG)
SIF ABL:ARG:露出癖
 	CALL QOL_COM_ORDER_ELEMENT_ABL(ARG, "露出癖", 4)
	
@QOL_COM_ORDER_KISS(ARG)
CALL QOL_COM_ORDER_STANDARD(ARG)
SIF ABL:ARG:欲望
 	CALL QOL_COM_ORDER_ELEMENT_ABL(ARG, "欲望", 1)
SIF ABL:ARG:奉仕精神
 	CALL QOL_COM_ORDER_ELEMENT_ABL(ARG, "奉仕精神", 4)
SIF MARK:ARG:快楽刻印
 	CALL QOL_COM_ORDER_ELEMENT_MARK(ARG, "快楽刻印", 2)
SIF GETPALAMLV(PALAM:ARG:欲情,5)
	CALL QOL_COM_ORDER_ELEMENT_PALAM(ARG, "欲情", 1, 5)
SIF TALENT:ARG:羞恥心 > 0
	CALL QOL_COM_ORDER_ELEMENT_TALENT(ARG, "羞恥心", -1)
SIF TALENT:ARG:汚臭耐性 > 0
	CALL QOL_COM_ORDER_ELEMENT_TALENT(ARG, "汚臭耐性", 1)
SIF TALENT:ARG:汚臭耐性 < 0
	CALL QOL_COM_ORDER_ELEMENT_TALENT(ARG, "汚臭耐性", -1)
SIF TALENT:ARG:献身的
	CALL QOL_COM_ORDER_ELEMENT_TALENT(ARG, "献身的", 6)
SIF TALENT:ARG:快感応答 < 0 && ABL:ARG:欲望 < 20
 	CALL QOL_COM_ORDER_ELEMENT_TALENT(ARG, "快感応答", -5)
SIF TALENT:ARG:恋慕 && ASSIPLAY == 0
	CALL QOL_COM_ORDER_ELEMENT_TALENT(ARG, "恋慕", 5)
	
@QOL_COM_ORDER_RECEIVE_V_INSERT(ARG)
;;NAS: Universal Insertion
;CALL NAS_INSERT_CHECK(MASTER,ARG)
;IF RESULT == -1
;	CALL QOL_COM_ORDER_ELEMENT(ARG, @"没有%CALLNAME:ARG%的合意", -10000)
;	RETURN 0
;ELSEIF RESULT == -2
;	SKIPDISP 0
;	CALL QOL_COM_ORDER_ELEMENT(ARG, "不在安定期", -10000)
;	RETURN 0
;ENDIF
;
;
;CALL Add_COM_ORDER_HOLE(MASTER, ARG, "")

SIF RESULT
	RETURN 0
;custom code
IF CFLAG:口上用童貞喪失判定 && SHIRAHU(ARG) && !TALENT:非童貞
	CALL KOJO_MESSAGE_SEND("PERMISSION", 3, ARG)
	SELECTCASE RESULT
		CASE -1
			CALL QOL_COM_ORDER_ELEMENT(ARG, @"%CALLNAME:ARG%不允许", -9999)
			RETURN 0
		CASE -1
			CALL QOL_COM_ORDER_ELEMENT(ARG, @"%CALLNAME:ARG%同意了", 10000)
			RETURN 1
	ENDSELECT
ENDIF

CALL QOL_COM_ORDER_STANDARD(ARG)
SIF ABL:ARG:欲望
 	CALL QOL_COM_ORDER_ELEMENT_ABL(ARG, "欲望", 2)
SIF MARK:ARG:快楽刻印
 	CALL QOL_COM_ORDER_ELEMENT_MARK(ARG, "快楽刻印", 2)
SIF TALENT:ARG:快感応答 > 0
 	CALL QOL_COM_ORDER_ELEMENT_TALENT(ARG, "快感応答", 2)
SIF TALENT:ARG:快感応答 < 0 && ABL:ARG:欲望 < 20
 	CALL QOL_COM_ORDER_ELEMENT_TALENT(ARG, "快感応答", -2)
SIF TALENT:ARG:淫乱 && ASSIPLAY == 0
	CALL QOL_COM_ORDER_ELEMENT_TALENT(ARG, "淫乱", 5)
SIF TALENT:PLAYER:処女
	CALL QOL_COM_ORDER_ELEMENT_TALENT(ARG, "処女", -15, PLAYER)
SIF TALENT:PLAYER:貞操 > 0
	CALL QOL_COM_ORDER_ELEMENT_TALENT(ARG, "貞操", -10, PLAYER)
SIF TALENT:PLAYER:貞操 < 0
	CALL QOL_COM_ORDER_ELEMENT_TALENT(ARG, "貞操", 5, PLAYER)
SIF ABL:PLAYER:技巧
 	CALL QOL_COM_ORDER_ELEMENT_ABL(ARG, "技巧", 4, PLAYER)

@QOL_COM_ORDER_RECEIVE_A_INSERT(ARG)
;custom code: Show a message instead of hiding
;CALL Add_COM_ORDER_HOLE(MASTER, ARG, "A")
;SIF RESULT
;	RETURN 0

;custom code
IF CFLAG:口上用童貞喪失判定 && SHIRAHU(ARG) && !TALENT:非童貞
	CALL KOJO_MESSAGE_SEND("PERMISSION", 3, ARG)
	SELECTCASE RESULT
		CASE -1
			CALL QOL_COM_ORDER_ELEMENT(ARG, @"%CALLNAME:ARG%不允许", -9999)
			RETURN 0
		CASE -1
			CALL QOL_COM_ORDER_ELEMENT(ARG, @"%CALLNAME:ARG%同意了", 10000)
			RETURN 1
	ENDSELECT
ENDIF

CALL QOL_COM_ORDER_STANDARD(ARG)
SIF ABL:ARG:欲望
 	CALL QOL_COM_ORDER_ELEMENT_ABL(ARG, "欲望", 2)
SIF ABL:ARG:奉仕精神
 	CALL QOL_COM_ORDER_ELEMENT_ABL(ARG, "奉仕精神", 4)
SIF MARK:ARG:快楽刻印
 	CALL QOL_COM_ORDER_ELEMENT_MARK(ARG, "快楽刻印", 2)
SIF GETPALAMLV(PALAM:ARG:欲情,5)
	CALL QOL_COM_ORDER_ELEMENT_PALAM(ARG, "欲情", 2, 5)
SIF TALENT:ARG:羞恥心 > 0
	CALL QOL_COM_ORDER_ELEMENT_TALENT(ARG, "羞恥心", -1)
SIF TALENT:ARG:献身的
	CALL QOL_COM_ORDER_ELEMENT_TALENT(ARG, "献身的", 6)
SIF TALENT:ARG:快感応答 > 0
 	CALL QOL_COM_ORDER_ELEMENT_TALENT(ARG, "快感応答", 2)
SIF TALENT:ARG:快感応答 < 0 && ABL:ARG:欲望 < 20
 	CALL QOL_COM_ORDER_ELEMENT_TALENT(ARG, "快感応答", -2)
SIF TALENT:ARG:恋慕 && ASSIPLAY == 0
	CALL QOL_COM_ORDER_ELEMENT_TALENT(ARG, "恋慕", 5)
SIF TALENT:ARG:淫乱 && ASSIPLAY == 0
	CALL QOL_COM_ORDER_ELEMENT_TALENT(ARG, "淫乱", 5)

@QOL_COM_ORDER_GIVE_SERVICE(ARG)
CALL QOL_COM_ORDER_STANDARD(ARG)
SIF ABL:ARG:欲望
 	CALL QOL_COM_ORDER_ELEMENT_ABL(ARG, "欲望", 1)
SIF MARK:ARG:快楽刻印
 	CALL QOL_COM_ORDER_ELEMENT_MARK(ARG, "快楽刻印", 1)
SIF GETPALAMLV(PALAM:ARG:欲情,5)
	CALL QOL_COM_ORDER_ELEMENT_PALAM(ARG, "欲情", 1, 5)
SIF TALENT:ARG:羞恥心 > 0
	CALL QOL_COM_ORDER_ELEMENT_TALENT(ARG, "羞恥心", -1)
SIF TALENT:ARG:快感応答 < 0 && ABL:ARG:欲望 < 20
 	CALL QOL_COM_ORDER_ELEMENT_TALENT(ARG, "快感応答", -2)
SIF TALENT:ARG:快感応答 < 0 && ABL:ARG:欲望 < 20
	CALL QOL_COM_ORDER_ELEMENT_TALENT(ARG, "快感応答", -5)
SIF (TALENT:PLAYER:2 & 3) == 3
	CALL QOL_COM_ORDER_ELEMENT_TALENT(ARG, "性別", -8, PLAYER)
SIF OTOKOGIRAI(ARG)
	CALL QOL_COM_ORDER_ELEMENT_TALENT(ARG, "性別嗜好", -5)

@QOL_COM_ORDER_SADISM_MODIFIERS(ARG)
SIF ABL:ARG:施虐属性
 	CALL QOL_COM_ORDER_ELEMENT_ABL(ARG, "施虐属性", 4)
SIF TALENT:ARG:倒錯的
 	CALL QOL_COM_ORDER_ELEMENT_TALENT(ARG, "倒錯的", 4)
SIF TALENT:ARG:受虐狂
 	CALL QOL_COM_ORDER_ELEMENT_TALENT(ARG, "受虐狂", 4)
SIF TALENT:ARG:小悪魔
 	CALL QOL_COM_ORDER_ELEMENT_TALENT(ARG, "小悪魔", 4)

@QOL_COM_ORDER_PLAYER_SADISM_MODIFIERS(ARG)
SIF TALENT:PLAYER:受虐狂
 	CALL QOL_COM_ORDER_ELEMENT_TALENT(ARG, "受虐狂", 3, PLAYER)

@QOL_COM_ORDER_MULTI_PLAYER_MODIFIERS(ARG)
;placeholder for now

;ARG:1 = dirt source modifiers
@QOL_COM_ORDER_DIRT_CHECK(ARG, ARG:1)
#DIM DIRT_SOURCES, 4
#DIM DIRT_SOURCE_COUNT
Y = 0
VARSET DIRT_SOURCES, -1
DIRT_SOURCE_COUNT = 0
SIF ARG:1 & QOL_COM_ORDER_DIRT_SOURCE_PENIS
	DIRT_SOURCES:(DIRT_SOURCE_COUNT++) = 2
SIF ARG:1 & QOL_COM_ORDER_DIRT_SOURCE_VAGINAL
	DIRT_SOURCES:(DIRT_SOURCE_COUNT++) = 3
SIF ARG:1 & QOL_COM_ORDER_DIRT_SOURCE_ANAL
	DIRT_SOURCES:(DIRT_SOURCE_COUNT++) = 4
SIF ARG:1 & QOL_COM_ORDER_DIRT_SOURCE_MOUTH
	DIRT_SOURCES:(DIRT_SOURCE_COUNT++) = 0

FOR LOCAL:1, 0, DIRT_SOURCE_COUNT
	LOCAL = DIRT_SOURCES:(LOCAL:1)
	;愛液の汚れ
	SIF STAIN:PLAYER:LOCAL & 1
		Y += 1
	;精液の汚れ
	SIF STAIN:PLAYER:LOCAL & 4
		Y += 3
	;アナルの汚れ
	SIF STAIN:PLAYER:LOCAL & 8
		Y += 7
	SIF STAIN:PLAYER:LOCAL & 16
		Y += 15
	Y = Y * (2 - TALENT:ARG:汚臭耐性) / 2
NEXT
SIF ARG:1 & QOL_COM_ORDER_DIRT_SOURCE_WEAKER
	Y /= 3

SIF Y
	CALL QOL_COM_ORDER_ELEMENT(ARG, @"污臭%COND_STR(GET_TALENTNAME(FINDELEMENT(TALENTNAME, "汚臭耐性")), TALENT:ARG:汚臭耐性)%", Y)

@QOL_COM_ORDER_AFFINITY(ARG, ARG:1)
R = ARG:1
LOCALS =
SIF R != PLAYER
	LOCALS '= @" 与%CALLNAME:R%"

IF RELATION:ARG:R > 0 && RELATION:ARG:R < 30
	CALL QOL_COM_ORDER_ELEMENT(ARG, @"%LOCALS%关系极差", -10)
ELSEIF RELATION:ARG:R > 0 && RELATION:ARG:R < 70
	CALL QOL_COM_ORDER_ELEMENT(ARG, @"%LOCALS%关系差", -6)
ELSEIF RELATION:ARG:R > 0 && RELATION:ARG:R < 100
	CALL QOL_COM_ORDER_ELEMENT(ARG, @"%LOCALS%关系不佳", -3)
ELSEIF RELATION:ARG:R >= 100 && RELATION:ARG:R < 130
	CALL QOL_COM_ORDER_ELEMENT(ARG, @"%LOCALS%关系一般", 3)
ELSEIF RELATION:ARG:R >= 100 && RELATION:ARG:R < 170
	CALL QOL_COM_ORDER_ELEMENT(ARG, @"%LOCALS%关系好", 6)
ELSEIF RELATION:ARG:R >= 100 && RELATION:ARG:R >= 170
	CALL QOL_COM_ORDER_ELEMENT(ARG, @"%LOCALS%关系极佳", 10)
ENDIF

@QOL_COM_ORDER_CHECK(ARG,REQUIREMENT)
#DIM REQUIREMENT
;FreeH
; IF TCVAR:ARG:Com_Order_Value < REQUIREMENT && NASCheat:1
; 	CALL COLORMESSAGE("【Bypassed by FreeH】",C_ORANGE,2,1)
; 	TCVAR:ARG:Com_Order_Value = -10000 ;reset it here as SCOM calls COM_ORDER twice
; 	RETURN 1
; ENDIF

PRINTFORM  = {TCVAR:ARG:Com_Order_Value}

SIF TCVAR:ARG:Com_Order_Value < REQUIREMENT
	PRINT  < 
SIF TCVAR:ARG:Com_Order_Value == REQUIREMENT
	PRINT  = 
SIF TCVAR:ARG:Com_Order_Value > REQUIREMENT
	PRINT  > 
PRINT 实行值
PRINTFORM {REQUIREMENT}
;IF !ISSKIP()
;	CALL PRINT_BREAK
;ELSE
;	PRINTL
;ENDIF
SIF TCVAR:ARG:Com_Order_Value < REQUIREMENT
	CALL COLORMESSAGE("【失败!】",C_RED,0,1)
PRINTL
IF TCVAR:ARG:Com_Order_Value < REQUIREMENT
	TCVAR:ARG:Com_Order_Value = -10000 ;reset it here as SCOM calls COM_ORDER twice
	RETURN 0
ENDIF
TCVAR:ARG:Com_Order_Value = -10000 ;reset it here as SCOM calls COM_ORDER twice
RETURN 1

@QOL_COM_ORDER_STANDARD_CHECKS(REQUIREMENT, CHECKS, CHARA, PARTNER = -1)
#DIM REQUIREMENT
#DIM CHECKS
#DIM CHARA
#DIM PARTNER
#DIM PARTNERS, 1

SIF PARTNER != MASTER ;print names when two characters are involved
	PARTNERS:0 = PARTNER

CALL QOL_COM_ORDER_STANDARD_CHECKS_PARTNERS(REQUIREMENT, CHECKS, CHARA, PARTNERS)
RETURN RESULT

@QOL_COM_ORDER_STANDARD_CHECKS_PARTNERS(REQUIREMENT, CHECKS, CHARA, PARTNERS)
#DIM REQUIREMENT
#DIM CHECKS
#DIM CHARA
#DIM REF PARTNERS
#DIM PARTNER_COUNT
PARTNER_COUNT = VARSIZE("PARTNERS")

SIF PARTNER_COUNT && PARTNERS:0 > 0 ;print names when two characters are involved
	PRINTFORM %CALLNAME:CHARA%:

IF CHECKS & QOL_COM_ORDER_VAGINAL_FULL
	CALL QOL_COM_ORDER_V_INSERT(CHARA)
	CHECKS |= QOL_COM_ORDER_DIRT_SOURCE_PENIS
ENDIF
IF CHECKS & QOL_COM_ORDER_ANAL_FULL
	CALL QOL_COM_ORDER_A_INSERT(CHARA)
	CHECKS |= QOL_COM_ORDER_DIRT_SOURCE_PENIS
ENDIF
SIF CHECKS & QOL_COM_ORDER_VAGINAL_PARTIAL
	CALL QOL_COM_ORDER_V_PARTIAL(CHARA)
SIF CHECKS & QOL_COM_ORDER_ANAL_PARTIAL
	CALL QOL_COM_ORDER_A_PARTIAL(CHARA)
IF CHECKS & QOL_COM_ORDER_SERVICE_FULL
	CALL QOL_COM_ORDER_SERVICE(CHARA)
	SIF ABL:CHARA:精液中毒
		CALL QOL_COM_ORDER_ELEMENT_ABL(CHARA, "精液中毒", 1)
	SIF OTOKOGIRAI(CHARA)
		CALL QOL_COM_ORDER_ELEMENT_TALENT(CHARA, "性別嗜好", -5)
ENDIF
IF CHECKS & QOL_COM_ORDER_SERVICE_CUM_FULL
	CALL QOL_COM_ORDER_SERVICE(CHARA)
	SIF ABL:CHARA:精液中毒
		CALL QOL_COM_ORDER_ELEMENT_ABL(CHARA, "精液中毒", 3)
	SIF OTOKOGIRAI(CHARA)
		CALL QOL_COM_ORDER_ELEMENT_TALENT(CHARA, "性別嗜好", -12)
ENDIF
SIF CHECKS & QOL_COM_ORDER_EXPOSURE_FULL
	CALL QOL_COM_ORDER_EXPOSURE(CHARA)
SIF CHECKS & QOL_COM_ORDER_EXPOSURE_PARTIAL
	CALL QOL_COM_ORDER_EXPOSURE_PART(CHARA)
IF CHECKS & QOL_COM_ORDER_KISS_FULL
	CALL QOL_COM_ORDER_KISS(CHARA)
	CHECKS |= QOL_COM_ORDER_DIRT_SOURCE_MOUTH
ENDIF
SIF CHECKS & QOL_COM_ORDER_RECEIVE_VAGINAL_FULL
	CALL QOL_COM_ORDER_RECEIVE_V_INSERT(CHARA)
SIF CHECKS & QOL_COM_ORDER_RECEIVE_ANAL_FULL
	CALL QOL_COM_ORDER_RECEIVE_A_INSERT(CHARA)
SIF CHECKS & QOL_COM_ORDER_GIVE_SERVICE_FULL
	CALL QOL_COM_ORDER_GIVE_SERVICE(CHARA)
IF CHECKS & QOL_COM_ORDER_DUO && PARTNER_COUNT && PARTNERS:0 > 0
	FOR LOCAL, 0, PARTNER_COUNT
		SIF PARTNERS:LOCAL <= 0
			BREAK
		SIF PARTNERS:LOCAL == CHARA
			CONTINUE
		CALL QOL_COM_ORDER_AFFINITY(CHARA, PARTNERS:LOCAL)
	NEXT
ENDIF
SIF CHECKS & QOL_COM_ORDER_SADISM
	CALL QOL_COM_ORDER_SADISM_MODIFIERS(CHARA)
SIF CHECKS & QOL_COM_ORDER_PLAYER_SADISM
	CALL QOL_COM_ORDER_PLAYER_SADISM_MODIFIERS(CHARA)

SIF CHECKS & QOL_COM_ORDER_MULTI_PLAYER
	CALL QOL_COM_ORDER_MULTI_PLAYER_MODIFIERS(CHARA)

CALL QOL_COM_ORDER_DIRT_CHECK(CHARA, CHECKS)

CALL KOJO_CHECK(CHARA, "CAN_COM",, SELECTCOM)

CALL QOL_COM_ORDER_CHECK(CHARA, REQUIREMENT)
RETURN RESULT

@QOL_COM_ORDER_STANDARD_CHECKS_DOUBLE(REQUIREMENT, CHECKS, CHARA, PARTNER = -1)
#DIM REQUIREMENT
#DIM CHECKS
#DIM CHARA
#DIM PARTNER
#DIM SUCCESS

SUCCESS = 1
CALL QOL_COM_ORDER_STANDARD_CHECKS(REQUIREMENT, CHECKS, CHARA, PARTNER)
SUCCESS &= RESULT
IF PARTNER > 0
	CALL QOL_COM_ORDER_STANDARD_CHECKS(REQUIREMENT, CHECKS, PARTNER, CHARA)
	SUCCESS &= RESULT
ENDIF
WAIT
RETURN SUCCESS

@EVENTCOM
#PRI
CVARSET TCVAR, FINDELEMENT(TCVARNAME, "Com_Order_Value"), -10000
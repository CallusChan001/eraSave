@Add_COM_ORDER_HOLE(ARG, nInserter, nHOLE)
#DIMS DYNAMIC nHole
#DIM DYNAMIC nInserter
SIF GROUPMATCH(SELECTCOM,79) ;inchling onahole
	RETURN 0

;custom code: Show a message instead of hiding
CALL MESSAGE_TIGHTNESS_TooTIGHT(@"strict%nHole%", ARG, nInserter)
IF RESULT
	CALL QOL_COM_ORDER_ELEMENT(ARG, "还太紧", -10000)
	RETURN 1
ELSE
	CALL MESSAGE_TIGHTNESS_TooTIGHT(@"reg%nHole%", ARG, nInserter)
	IF RESULT
		CALL QOL_COM_ORDER_ELEMENT(ARG, "还太紧", -10000)
		RETURN 1
	ENDIF
ENDIF

@MESSAGE_TIGHTNESS_TooTIGHT(ARGS, ARG,nInserter)
#DIM nInserter

IF Add_Size_Check(ARGS, ARG, nInserter)
	PRINTFORM %CALLNAME:ARG%
	SELECTCASE ARGS
	CASE "strictA", "regA", "anal"
		LOCALS = %FSYN("anus",,ARG)%
		LOCAL:1 = 2
		LOCAL:2 = 1
	CASE "regU", "strictU"
		LOCALS = %FSYN("urethra",,ARG)%
		LOCAL:1 = 30
		LOCAL:2 = 1
	CASEELSE
		LOCALS = %FSYN("vagina",,ARG)%
		LOCAL:1 = 1
		LOCAL:2 = 0
	ENDSELECT
	PRINTFORM %LOCALS%
	PRINTFORM 太紧了
	PRINTL
	IF Add_HoleSizeCheck(ARG,nInserter,LOCAL:2,0) >= 3
		PRINTFORML 试试用万宝槌来缩减你俩之间的体型差异吧
		;small penis advice
		SIF TALENT:nInserter:250 != 1
			PRINTFORML 或者换小一点的那根试试
		WAIT
	ELSEIF Add_HoleSizeCheck(ARG,nInserter,LOCAL:2,0) >= 2
		; IF TALENT:ARG:SexKnow >= 5 || TALENT:nInserter:SexKnow >= 5
		; 	PRINTFORML Even though %PARSE("you",,,nInserter)% or %PARSE("you",,,ARG)% have\@ EXISTVAR("NAS_SAVE_VER") ?【Forbidden】sexual knowledge # %" ["+GET_TALENTNAME(144,1)%] \@, the size difference is too large to cancel out.
		; 	PRINTFORML You'll need to train %PARSE("your",5,,ARG)% %LOCALS% until %PARSE("you have",5,,ARG)% 50 %EXP_TR(LOCAL:1)% (currently {EXP:ARG:(LOCAL:1)}) before %PARSE("you are",5,,nInserter)% able to insert.
		; ELSE
		IF EXP:ARG:(LOCAL:1) > 50
			PRINTFORML 尽管%CALLNAME:ARG%的%LOCALS%感度良好，但无论是%CALLNAME:nInserter%还是%CALLNAME:ARG%都没有[%GET_TALENTNAME(144,1)%]，无法正确插入。
		ELSE
			PRINTFORML 多多使用爱抚命令来放松%CALLNAME:ARG%的%LOCALS%，直到%CALLNAME:ARG%拥有50点%EXP_TR(LOCAL:1)%（当前为{EXP:ARG:(LOCAL:1)}）。
			PRINTFORML 由于尺寸差异过大，%CALLNAME:nInserter%或%CALLNAME:ARG%还需要[%GET_TALENTNAME(144,1)%]。
		ENDIF
		WAIT
	ELSE
		PRINTFORML 多多使用爱抚命令来放松%CALLNAME:ARG%的%LOCALS%，直到%CALLNAME:ARG%拥有50点%EXP_TR(LOCAL:1)%（当前为{EXP:ARG:(LOCAL:1)}）。
		PRINTFORML 你也可以通过获得[%GET_TALENTNAME(144,1)%]来强行插入。
		WAIT
	ENDIF
	RETURN 1
ENDIF
RETURN 0

@Add_Size_Check(ARGS, ARG = -1, nInserter = -1)
#DIM nInserter
#FUNCTION
SIF ARG == -1
	ARG = TARGET
SIF nInserter == -1
	nInserter = MASTER
;for normal actions
SELECTCASE ARGS 
	;custom code
	CASE "strictA", "regA", "anal"
		RETURNF Add_HoleSizeCheck(ARG,nInserter,1,1)
	CASE "regU", "strictU"
		RETURNF Add_HoleSizeCheck(ARG,nInserter,2,1)
	CASEELSE
		RETURNF Add_HoleSizeCheck(ARG,nInserter,0,1)
ENDSELECT

@Add_HoleSizeCheck(ARG = -1, nInserter = -1, nHole = 0, canDo = 1)
;-2 = ガバガバで気持ちよくない -1 = 刺激が弱い 1= 経験が必要 2= 経験と知識が必要 3= 小人オナホ
#FUNCTION
#DIM InserterSize
#DIM SizeDiff
;k stretching system
;0 = vagina, 1 = anus, 2 = urethra, 3 = mouth, -1 = general
#DIM DYNAMIC nHole
#DIM DYNAMIC nOffset
#DIM nInserter
#DIM canDo
#DIM nVal
VARSET nOffset

;disabled
; IF ARG == MASTER && nInserter == MASTER
; 	RETURNF 0
; ENDIF

SIF ARG == -1
	ARG = TARGET
SIF nInserter == -1
	nInserter = MASTER

SELECTCASE TALENT:nInserter:形状
	CASE 0,3,4
		InserterSize = 0
	CASE 1
		InserterSize = -2
	CASE 2
		InserterSize = -1
	CASE 6
		InserterSize = 1
	CASE 5,10
		InserterSize = 2
ENDSELECT

IF TALENT:nInserter:体型 >= TALENT:ARG:体型
	SizeDiff = (NUM_EXPONENT(TALENT:nInserter:体型 - TALENT:ARG:体型,2) + InserterSize) * 100
ELSE
	SizeDiff = (NUM_EXPONENT(TALENT:nInserter:体型 - TALENT:ARG:体型,2) + InserterSize) * -100
ENDIF
SizeDiff += (HoleStretch:ARG:nHole-600)

; ;after effects
; SIF HasBionicPart(nInserter,33)
; 	SizeDiff -= 300
; SIF HasBionicPart(nInserter,53)
; 	SizeDiff = 0

nVal = SizePointsToValue(SizeDiff)

SELECTCASE canDo
CASE 0
	RETURNF nVal
CASE 1
	;replacement for Com_Size_Check and the jap command.
	;0 = can fit
	;1 = can't
	SELECTCASE nHole
	CASE 0
		LOCAL:1 = 1
	CASE 1
		LOCAL:1 = 2
	CASE 2
		LOCAL:1 = 30
	ENDSELECT

	SELECTCASE nHole
	;CASE 2
		;urethral
	CASEELSE
		SELECTCASE nVal
		CASE 3
			;too big
			RETURNF 1
		CASE 2
			;need both lube or forbidden knowledge if difference is too big
			; SIF (TALENT:nInserter:SexKnow >= 5 || TALENT:ARG:SexKnow >= 5) && EXP:ARG:(LOCAL:1) >= 50
				; RETURNF 0
		CASE 1
			;at this stage, need either high lube or advanced knowledge
			; SIF (TALENT:nInserter:SexKnow >= 2 || TALENT:ARG:SexKnow >= 2) || EXP:ARG:(LOCAL:1) >= 50
				; RETURNF 0
		CASE IS <= 0
			;can fit
			RETURNF 0
		ENDSELECT
	ENDSELECT
	RETURNF 1
CASE -1
	RETURNF SizeDiff
ENDSELECT



@SizePointsToValue(ARG)
#FUNCTION
SELECTCASE ARG
	CASE IS > 1000
		LOCAL = 3
	CASE IS > 600
		LOCAL = 2
	CASE IS > 300
		LOCAL = 1
	CASE IS < -300
		LOCAL = -1
	CASE IS < -600
		LOCAL = -2
	CASEELSE
		RETURNF 0
ENDSELECT
RETURNF LOCAL

@NAS_TIGHTNESS(ARG)
#FUNCTIONS
#DIMS nText

SELECTCASE SizePointsToValue(ARG)
CASE 5
	nText '= @"不，%CALLNAME:MASTER%你塞不进去的"
CASE 4
	nText '= "你他妈在干什么"
CASE 3
	nText '= "太紧了没办法"
CASE 2
	nText '= "极其紧绷"
CASE 1
	nText '= "非常紧致"
CASE 0
	nText '= "刚刚好"
CASE -1
	nText '= "不够紧"
CASE -2
	nText '= "对你而言有点大"
CASE -3
	nText '= "比你的宝贝宽松多了"
CASE -4
	nText '= "几乎裹不住你的宝贝"
CASE -5
	nText '= "牙签搅大缸了"
ENDSELECT

nText += @" ({ARG}点差距)"
RETURNF nText

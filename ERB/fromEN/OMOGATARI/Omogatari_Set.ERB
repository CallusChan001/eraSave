; ;==================================================================================================================================================================================================================================================================================================
; ;EnduranceColors
; ;----------------------------------------------------------
; ;Description
; ;----------------------------------------------------------
; ;Colors for endurance ranks
; ;==================================================================================================================================================================================================================================================================================================
; @EnduranceColors(ARG = 0)
; #FUNCTION
; VARSET LOCAL
; SELECTCASE ARG
; CASE IS >= 6
; LOCAL:20 = 1
; LOCAL = 0x990099
; CASE 5
; LOCAL:20 = 1
; LOCAL = 0xC070C0
; CASE 4
; LOCAL = 0x0078B4
; CASE 3
; LOCAL = 0x66FFFF
; CASE 2
; LOCAL = 0x00FF00
; CASE 1
; LOCAL = 0x70C070
; CASE -2
; LOCAL = 0xFFFF00
; CASE -1
; LOCAL = 0xFFFFCC
; CASE -3
; LOCAL = 0xFFA500
; CASE -4
; LOCAL = 0xFF0000
; CASE -5
; LOCAL:20 = 1
; LOCAL = 0xFFCCFF
; CASEELSE
; LOCAL = 0xC0C0C0
; ENDSELECT	
; RETURNF LOCAL

; @Endurance_Bars(ARG)
; CALL PRINTBUTTON_EX("Endurance", 1880, ProfileFilters:0, , , 1)
; SIF ProfileFilters:0
; 	RETURN
; CALL Endurance_Bar_Individual(ARG,0)
; CALL Endurance_Bar_Individual(ARG,5)
; PRINTL
; ;potty training
; IF CAN_ACCIDENT(ARG,1) || CAN_ACCIDENT(ARG,2)
; 	SIF CAN_ACCIDENT(ARG,1)
; 	CALL Endurance_Bar_Individual(ARG,1)
; 	SIF CAN_ACCIDENT(ARG,2)
; 	CALL Endurance_Bar_Individual(ARG,2)
; 	PRINTL
; ENDIF
; CALL Endurance_Bar_Individual(ARG,3)
; CALL Endurance_Bar_Individual(ARG,4)

; @Endurance_Bar_Individual(ARG,ARG:1)
; VARSET EC_NAME
; VARSET EC_COLORS
; CALLF EnduranceDB(TOSTR(ARG:1))
; SIF !STRLENS(EC_NAME)
; 	RETURN

; SIF !EC_COLORS:0
; 	EC_COLORS:0 = 0xC070C0
; SIF !EC_COLORS:1
; 	EC_COLORS:1 = 0xFFCCFF


; PRINTFORM %EC_NAME,20%
; CALL PRINT_SLIDER(EC_EXP:0, EC_EXP:1, GETVAR(@"%EC_EXP_VAR%:{ARG}:0"), 30, EC_COLORS:0, EC_COLORS:1)
; PRINTFORM {GETVAR(@"%EC_EXP_VAR%:{ARG}:0"), 5} %GET_TALENTNAME_TR(EC_TALENT,GETVAR(@"%EC_VAR%:{ARG}:0")),20,LEFT%

; @MakeEnduranceBar(ARG, ARG:1, ARG:2, ARG:3, ARG:4,ARGS)

; IF ARG:3 == 19 
; LOCAL:19 = EXP_DEMAND_19(0,,ARG,-1)
; LOCAL:20 = EXP_DEMAND_19(0,,ARG)
; LOCAL:21 = EXP_DEMAND_19(0,,ARG,1)
; ELSEIF ARG:3 == 20
; LOCAL:19 = EXP_DEMAND_20(0,,ARG,-1)
; LOCAL:20 = EXP_DEMAND_20(0,,ARG)
; LOCAL:21 = EXP_DEMAND_20(0,,ARG,1)
; ELSEIF ARG:3 == 22
; LOCAL:19 = EXP_DEMAND_22(0,,ARG,-1)
; LOCAL:20 = EXP_DEMAND_22(0,,ARG)
; LOCAL:21 = EXP_DEMAND_22(0,,ARG,1)
; ELSEIF ARG:3 == 23
; LOCAL:19 = EXP_DEMAND_23(0,,ARG,-1)
; LOCAL:20 = EXP_DEMAND_23(0,,ARG)
; LOCAL:21 = EXP_DEMAND_23(0,,ARG,1)
; ELSE
; LOCAL:19 = EXP_DEMAND_21(0,,ARG,-1)
; LOCAL:20 = EXP_DEMAND_21(0,,ARG)
; LOCAL:21 = EXP_DEMAND_21(0,,ARG,1)
; ENDIF

; PRINTFORML %" "*2%%ARGS%: 
; LOCALS '= @"%TOSTR(ARG:1)%"
; IF (ARG:2)-1 < -5
; PRINTFORM %LOCALS,15,RIGHT%
; SETCOLOR C_PINK
; PRINTFORM %"MAX ",5,RIGHT%
; RESETCOLOR
; ELSE
; LOCALS += @"/%TOSTR((LOCAL:19))%"
; PRINTFORM %LOCALS+" ",15,RIGHT%
; CALL PRINT_RANK((ARG:2)-1, "MAX_5_SCALE")
; PRINTFORM %" "+TOSTR((ARG:2)-1),3%
; ENDIF

; IF ARG:2 > 0
; LOCAL:1 = ABS(ARG:1)-ABS((LOCAL:19))
; LOCAL:2 = ABS((LOCAL:20))-ABS((LOCAL:19))
; ELSEIF ARG:2 == 0 && ARG:1 > 0
; LOCAL:1 = 1
; LOCAL:2 = 1
; ELSE
; LOCAL:1 = ABS((LOCAL:19))-ABS(ARG:1)
; LOCAL:2 = ABS((LOCAL:19))
; ENDIF

; SIF LOCAL:2 == 0
;     LOCAL:2 = -1
; LOCAL:3 = 100 * LOCAL:1 / LOCAL:2

; SELECTCASE LOCAL:3
; CASE IS >= 100
; LOCALS = 青
; CASE IS >= 75
; LOCALS = 緑
; CASE IS >= 50
; LOCALS = 黄色
; CASE IS >= 25
; LOCALS = オレンジ
; CASEELSE
; LOCALS = 赤
; ENDSELECT

; LOCAL:4 = BARCOLORSET(LOCALS)
; CALL PRINT_COLORBAR, LOCAL:1, LOCAL:2, 50, UNICODE(0x2585), UNICODE(0x2585), 0x404040, LOCAL:4

; CALL PRINT_RANK((ARG:2), "MAX_5_SCALE")
; PRINTFORM %" "+TOSTR((ARG:2)),3%

; IF ARG:1 <= (LOCAL:20)
; CALL PRINT_COLORBAR, 0,1, 50, UNICODE(0x2585), UNICODE(0x2585), BARCOLORSET("緑"), 0x404040
; ELSEIF ARG:2 >= 5 && ARG:1 > LOCAL:20
; CALL PRINT_COLORBAR, 1,1, 50, UNICODE(0x2585), UNICODE(0x2585), BARCOLORSET("青"), 0x404040
; ELSE
; LOCAL:1 = ABS(ARG:1)-ABS((LOCAL:20))
; LOCAL:2 = ABS((LOCAL:21))-ABS((LOCAL:20))

; SIF LOCAL:2 == 0
;     LOCAL:2 = 1
; LOCAL:3 = 100 * LOCAL:1 / LOCAL:2

; SELECTCASE LOCAL:3
; CASE IS >= 100
; LOCALS = 青
; CASE IS >= 75
; LOCALS = 緑
; CASE IS >= 50
; LOCALS = 黄色
; CASE IS >= 25
; LOCALS = オレンジ
; CASEELSE
; LOCALS = 赤
; ENDSELECT
; CALL PRINT_COLORBAR, LOCAL:1, LOCAL:2, 50, UNICODE(0x2585), UNICODE(0x2585), BARCOLORSET(LOCALS), 0x404040
; ENDIF

; LOCALS '= @" %TOSTR(ARG:1)%"
; IF (ARG:2)+1 > 5
; SETCOLOR C_P_PURPLE
; PRINTFORM %" MAX",4%
; RESETCOLOR
; ELSE
; LOCALS += @"/%TOSTR((LOCAL:21))%"
; CALL PRINT_RANK((ARG:2)+1, "MAX_5_SCALE")
; PRINTFORM %" "+TOSTR((ARG:2)+1)%
; ENDIF

; PRINTFORM %LOCALS,15,LEFT%
; PRINTL
; PRINTFORM %GET_TALENTNAME_TR(ARG:4,(ARG:2)-1), 20%
; PRINTFORM %GET_TALENTNAME_TR(ARG:4,(ARG:2)), 55%
; PRINTFORM %GET_TALENTNAME_TR(ARG:4,(ARG:2)+1), 55, RIGHT%
; PRINTFORML
; PRINTFORM \@ARG:2 >= 5?#\@


; ;-------------------------------------------------
; ;separated mod actions to it's own function
; ;these are passive 
; ;-------------------------------------------------
; @PASSIVE_ACTIONS(ARG)

; ;unfuck buffs
; PeeHold:ARG:1 = 0
; PooHold:ARG:1 = 0
; ;-------------------------------------------------
; ;Body Part Health
; ;-------------------------------------------------
; CALL CrippleEffects(ARG)


; ;-------------------------------------------------
; ;Player Pitfalls
; ;-------------------------------------------------
; CALL PlayerPitfall(ARG)


; ;find dead bodies
; FOR LOCAL, 0, CHARANUM
; 	SIF CFLAG:LOCAL:現在位置 != CFLAG:ARG:現在位置
; 		CONTINUE
; 	SIF !IsDead:LOCAL:0
; 		CONTINUE
; 	IF !KnowsDeadBodies:ARG:LOCAL && ARG != LOCAL && ARG != MASTER && !IsDead:ARG:0 && !FLAG:70 && !CFLAG:(LOCAL):出禁 && !CFLAG:ARG:睡眠 && BASE:ARG:0 > 500
; 		PRINTFORML %CALLNAME:ARG% found %CALLNAME:LOCAL%'s dead body!
; 		CALL FIND_DEATH(ARG,LOCAL,1)
; 		IF KilledBy:LOCAL:0 == MASTER && CFLAG:MASTER:現在位置 == CFLAG:ARG:現在位置 && !TALENT:LOCAL:Raider
; 			SIF GROUPMATCH(ARG, 12,36,76,72, 90,97)
; 				GOTO NoMurderReaction
; 			SIF TALENT:ARG:貞操 < 0
; 				GOTO NoMurderReaction
		 
; 			CALL SET_REP(ARG,18,,1)
; 			SIF FLAG:POSTAL < 3
; 			CALL GET_ANGRY(ARG, 1)
; 		ENDIF
; 		$NoMurderReaction
; 		CALL ReportDeadBody(ARG,LOCAL)
; 	ENDIF
; NEXT

; IF TALENT:ARG:Slave
; 	MARK:ARG:反発刻印 = 0
; ENDIF

; IF FLAG:DoL && SHIRAHU(MASTER)
; 	IF CAN_SEE_NPC(ARG,MASTER)
; 		IF CFLAG:ARG:300 == CFLAG:MASTER:300
; 		ELSE
; 		SIF !DT_EXIST(@"Movement_{ARG}")
; 		PRINTFORMW %CALLNAME:ARG% has spotted you!
; 		CALL ForceGoAndMove(ARG, CFLAG:MASTER:300)
; 		ENDIF
; 	ELSEIF !RAND:20 && GET_MAPID(CFLAG:ARG:300) == GET_MAPID(CFLAG:MASTER:300) && CFLAG:ARG:300 != SUKIMA() && SHIRAHU(ARG)
; 		PRINTFORMW %CALLNAME:ARG% has decided to look for you!
; 		CALL ForceGoAndMove(ARG, CFLAG:MASTER:300)
; 	ENDIF
; ENDIF

; IF MARK:ARG:反発刻印 >= 4 && nRyona
; 	IF CAN_SEE_NPC(ARG,MASTER)
; 		PRINTFORML As %CALLNAME:ARG%'s eyes meet yours, %HE_SHE(ARG)% brandishes %HIS_HER(ARG)% weapon and points it at you, provoking a fight... 
; 		CALL KNIFE_FIGHT(ARG,MASTER,1,1)
; 		SOURCE:反感 = 300
; 	ENDIF
; ENDIF

; ;achievements
; SIF WetBed >= 5000
; 	CALL AL_NOTIFY_ACHIEVEMENT_COMPLETION("wetBedPee5000")
; SIF 充填率(TARGET, 4, MASTER) >= 3000 && TARGET != MASTER
; 	CALL AL_NOTIFY_ACHIEVEMENT_COMPLETION("filling3000")
; SIF CFLAG:MASTER:うふふ == 2 && FLAG:70
; 	CALL AL_NOTIFY_ACHIEVEMENT_COMPLETION("rapedInTSP")

; @OPEN_CARY_SET
; LOCAL = LINECOUNT
; PRINTFORML How armed should Gensokyo be?
; PRINTL [-1] No one should have guns. Life in Gensokyo should be peaceful.
; PRINTL [ 0] Weaponry should be distributed to those that are worthy and have their society be advanced enough
; PRINTL [ 1] Yes
; PRINTL [ 2] Yes (But with high-grade stuff)
; PRINTL [ 3] Everybody wants a piece of me
; PRINTFORML [ 4] Lets go POSTAL
; INPUT 
; SELECTCASE RESULT
; 	CASE -1
; 		PRINTFORMW Liebermode has been turned on. Only the AIA and faction NPCs have guns. All other NPCs run away from you
; 		FLAG:POSTAL = -1
; 	CASE 0
; 		PRINTFORMW Postal mode won't be used (Normal Mode Selected).
; 		FLAG:POSTAL = -0
; 	CASE 1
; 		PRINTFORMW Hestonworld mode has been turned on. Everybody in Gensokyo has a gun.
; 		PRINTFORMW They will immediately go hostile as soon as you pull one out or start breaking the law.
; 		FLAG:POSTAL = 1
; 	CASE 2
; 		PRINTFORMW Hestonworld mode has been turned on. Everybody in Gensokyo has a gun.
; 		PRINTFORMW They will immediately go hostile as soon as you pull one out or start breaking the law.
; 		PRINTFORMW This mode also allows for grade 6 weapons or higher.
; 		FLAG:POSTAL = 2
; 	CASE 3
; 		PRINTFORMW %CALLNAME:MASTER% is now Gensokyo's Most Wanted. 
; 		PRINTFORMW %PARSE("You")% will always be wanted, everyone will shoot on sight. 
; 		FLAG:POSTAL = 3
; 	CASE 4
; 		PRINTFORMW Welcome to POSTAL Mode.
; 		PRINTFORMW Everybody in Gensokyo has a gun.
; 		PRINTFORMW Everyone will shoot you on sight.
; 		PRINTFORMW Everyone will shoot EACH OTHER on sight. 
; 		PRINTFORMW Hit squads will come and shoot EVERYONE on sight. 
; 		PRINTFORMW Keep your girls safe...
; 		FLAG:POSTAL = 4
; ENDSELECT
; PRINTL 

; @PERMADEATH_SET
; LOCAL = LINECOUNT
; PRINTFORML How should death work?
; PRINTL [-1] All characters respawn
; PRINTL [ 0] Only gods, fairies, ghosts, Hourais, and essential characters will respawn.
; PRINTL [ 1] No respawns
; PRINTL [ 2] Permanent death
; INPUT 
; SELECTCASE RESULT
; 	CASE -1
; 		PRINTFORMW Regeneration mode has been turned on. All NPCs will resurrect after they are killed
; 		PermaDeath = -1
; 	CASE 0
; 		PRINTFORMW Permadeath mode won't be used (Normal Mode Selected).
; 		PRINTFORMW Some characters will resurrect automatically.
; 		PermaDeath = 0
; 	CASE 1
; 		PRINTFORMW No Respawn mode has been turned on.
; 		PRINTFORMW All characters that die must be resurrected with expensive means.
; 		PermaDeath = 1
; 	CASE 2
; 		PRINTFORMW Dead is dead. 
; 		PRINTFORMW If a character dies, they are permanently dead.
; 		PermaDeath = 2
; ENDSELECT
; PRINTL 



; @AddMissingRelations
; FOR LOCAL,0,CHARANUM
; 	FOR LOCAL:1,0,CHARANUM
; 		SIF !RELATION:LOCAL:(LOCAL:1) && LOCAL != LOCAL:1
; 			RELATION:LOCAL:(LOCAL:1) = 100
; 		SIF RELATION:LOCAL:(LOCAL:1) && LOCAL == LOCAL:1
; 			RELATION:LOCAL:(LOCAL:1) = 0
; 	NEXT
; NEXT

; @EVENTLOAD
; #LATER
; CALL INIT_SCREEN_MESSAGE(@"Revamping EXP curve") ;nas loading
; CALL AddMissingRelations
; CALLF REVAMP_EXP_CURVE()
; CALL CALCULATE_WEAPONS_AND_PRESETS()

; @RelocateMakaiIdiots(ARG)
; #FUNCTION
; #DIM LivingPlace
; #DIM DateSpace

; ;NAS: Player Housing
; IF FINDELEMENT(PlayerLandGuests,ARG) > -1
; 	IF INRANGE(PlayerLandGuestLiving:(FINDELEMENT(PlayerLandGuests,ARG)),1901,1997)
; 		LivingPlace = PlayerLandGuestLiving:(FINDELEMENT(PlayerLandGuests,ARG))
; 	ELSE
; 		LivingPlace = AvailableHousingAreas()
; 		PlayerLandGuestLiving:(FINDELEMENT(PlayerLandGuests,ARG)) = AvailableHousingAreas()
; 	ENDIF
; 	IF MAIN_MAP == 19
; 	CFLAG:ARG:初期位置 = PlayerLandGuestLiving:(FINDELEMENT(PlayerLandGuests,ARG))
; 	ENDIF
; 	DateSpace = 1910
; 	GOTO BYPASS
; ENDIF

; IF SaveIsEZB
; 	SELECTCASE ARG
; 	; CASE 51
; 	; 	LivingPlace = 235
; 	; CASE 47
; 	; 	;rika can stay where the fuck she is
; 	; 	LivingPlace = 234
; 	; CASE 72
; 	; 	LivingPlace = 233
; 	; CASE 52
; 	; 	LivingPlace = 232
; 	; CASE 102
; 	; 	LivingPlace = 229
; 	; CASE 40
; 	; 	LivingPlace = 208
; 	; CASE 64
; 	; 	LivingPlace = 209
; 	; 	CFLAG:ARG:起床時間 = 0
; 	; 	CFLAG:ARG:就寝時間 = 0
; 	; CASE 29
; 	; 	LivingPlace = 235
; 	CASEELSE
; 		;EVERYONE ELSE GO TO GAPPY
; 		LivingPlace = 0
; 		DateSpace = 0
; 		CFLAG:ARG:初期位置 = LivingPlace
; 		CFLAG:ARG:神社在住 = LivingPlace
; 		CFLAG:ARG:自宅位置 = DateSpace
; 		CFLAG:ARG:よく行く地域 = MAIN_MAP
; 		RETURNF 1
; 	ENDSELECT
; 	CFLAG:ARG:よく行く地域 = MAIN_MAP
; ELSE
; 	SELECTCASE ARG
; 	CASE 45
; 	LivingPlace = 1102
; 	DateSpace = 1110
; 	CASE 46
; 	LivingPlace = 235
; 	DateSpace = 270
; 	CASE 47
; 	LivingPlace = 234
; 	DateSpace = 270
; 	CASE 48
; 	LivingPlace = 1116
; 	DateSpace = 1110
; 	CASE 102
; 	LivingPlace = 1149
; 	DateSpace = 1140
; 	CASE 103
; 	LivingPlace = 1150
; 	DateSpace = 1140
; 	CASE 104
; 	LivingPlace = 1155
; 	DateSpace = 1130
; 	CASE 105
; 	LivingPlace = 1156
; 	DateSpace = 1130
; 	CASE 146
; 	LivingPlace = 1169
; 	CASE 147
; 	LivingPlace = 1157
; 	CASE 148
; 	LivingPlace = 1110
; 	CASE 150
; 	LivingPlace = 951
; 	CASE 151
; 	LivingPlace = 950
; 	CASE 152
; 	LivingPlace = 949
; 	CASEELSE
; 		;Myouren Temple blocker before 2011
; 		IF CFLAG:ARG:自宅位置/100 == 1 && GET_YEAR() < 2011
; 		LivingPlace = 0
; 		DateSpace = 0
; 		ELSE
; 		RETURNF 0
; 		ENDIF
; 	ENDSELECT
; ENDIF

; $BYPASS
; SIF !DateSpace
; 	DateSpace = GET_MAP_REPLACEMENT(LivingPlace)

; IF CFLAG:ARG:初期位置 != SUKIMA()
; ;make sure you actually live in makai
; CFLAG:ARG:初期位置 = LivingPlace
; CFLAG:ARG:神社在住 = LivingPlace
; ENDIF

; CFLAG:ARG:自宅位置 = DateSpace
; RETURNF LivingPlace


; @RandomPlayerMC(ARG)
; CALL モブ子画像リセット(0)
; CALL ランダム素質付与(0,"町娘")

; SELECTCASE RAND:5
; CASE 0
; 	NAME:0 = Player
; 	CALLNAME:0 = Player
; CASE 1
; 	NAME:0 = Reina
; 	CALLNAME:0 = Reina
; CASE 2
; 	NAME:0 = Testies Cos 1
; 	CALLNAME:0 = Testies
; 	CALLF ProfessionalKiller(0)
; 	CALLF ICanGoAllNight(0)
; CASE 3
; 	NAME:0 = Pops
; 	CALLNAME:0 = Pops
; CASE 4
; 	CALLNAME:0 = %ランダムキャラ_命名(0)%
; 	NAME:0 = %CALLNAME:0%

; CASE 5
; 	NAME:0 = Anon
; 	CALLNAME:0 = Anon
; CASE 6
; 	NAME:0 = Prankfag
; 	CALLNAME:0 = Prankfag
; CASE 7
; 	NAME:0 = Stranger
; 	CALLNAME:0 = Stranger	
; ENDSELECT



; ;this is to actually randomize characters AFTER their roll
; @RANDOM_MC(ARG)
; {
; #DIMS AvaliableTypes =
; 	"Paniel",
; 	"PanielSex",
; 	"Paniel",		
; 	"河童",
; 	"山童",
; 	"白狼天狗",
; 	"鴉天狗",
; 	"玉兎",
; 	"化け狸",
; 	"茨たぬき",
; 	"イナバ",
; 	"妖精",
; 	"メイド妖精",
; 	"ゾンビフェアリー",
; 	"人妻",
; 	"町娘",
; 	"泡姫",
; 	"サキュバス",
; 	"鬼",
; 	"化け狐",
; 	"化け猫",
; 	"Makai",
; 	"Makai"
; }
; #DIMS DYNAMIC ExclusiveRace
; [SKIPSTART]
; CALL Name_Array_Set
; NAME:MASTER = %nameArray:MASTER:na_Name%
; CALLNAME:MASTER = %nameArray:MASTER:na_Callname%
; FOR LOCAL,40,50
; 	ABL:MASTER:LOCAL = RAND:18
; NEXT
; [SKIPEND]
; FOR LOCAL,0, 301
; 	TALENT:ARG:LOCAL = 0
; NEXT

; FOR LOCAL,0,100
; 	ABL:ARG:LOCAL = 0
; NEXT
; MAXBASE:ARG:0 = 2000
; MAXBASE:ARG:1 = 2000

; ;CALL SpawnMobEnemy(ARG,RAND(0,51))

; CALL MAKE_YUKIZURI(ARG,AvaliableTypes:RAND(VARSIZE("AvaliableTypes")))
; CFLAG:MASTER:出禁 = 0
; TALENT:MASTER:行きずり = 0

; ;dirty 3-4x increase for max level of 24
; FOR LOCAL,40,60
; 	CALLF CONVERT_TO_20_SYSTEM(ARG,LOCAL)
; NEXT
; CALL BackstoyBonuses

; ;name making function
; ;ARG: character ID. Set to -1 to use the temp name
; ;LoGShits: treat like its Legend of Gensokyo
; 	;0: John Smith
; 	;1: John 'New Beginner' Smith
; 	;2: New Beginner
; @NameChecker(ARG,nForce=-1,PrintMode = 0,nonNormalNick=0,LoGShits=-1)
; #FUNCTIONS
; #DIM nVar
; #DIM nForce
; #DIM nonNormalNick
; #DIM PrintMode
; #DIMS DYNAMIC html
; #DIM CONST nicknameColor = 0x70C070
; #DIMS DYNAMIC htmlFullName,2
; #DIMS DYNAMIC htmlFirstName,2
; #DIMS DYNAMIC htmlLastName,2
; #DIMS DYNAMIC htmlMiddleName,2
; #DIMS DYNAMIC htmlCallName,2
; #DIMS DYNAMIC htmlPrefix,2
; #DIMS DYNAMIC htmlSuffix,2
; #DIMS DYNAMIC htmlNameType
; #DIM DYNAMIC highlightStage
; #DIM DYNAMIC LoGShits
; highlightStage = 0
; SIF LoGShits == -1
; 	LoGShits = SaveIsEZB

; ;get names
; IF INRANGE(ARG,0,CHARANUM-1)
; 	IF SaveIsEZB && LogShits == 0
; 		htmlCallName:1 '= ALTNAME:ARG:0
; 	ELSE
; 		htmlCallName:1 '= ALTNAME_OR_CALLNAME(ARG)
; 	ENDIF
; 	htmlFirstName:1   '= nameArray:ARG:na_FirstName
; 	htmlMiddleName:1  '= nameArray:ARG:na_MiddleName
; 	htmlLastName:1    '= nameArray:ARG:na_LastName
; 	htmlPrefix:1	  '= nameArray:ARG:na_Prefix
; 	htmlSuffix:1	  '= nameArray:ARG:na_Suffix
; 	htmlFullName:1	  '= nameArray:ARG:na_Name
; 	htmlNameType	  '= nameArray:ARG:na_NameType
; ELSE
; 	htmlFirstName:1   '= nameArrayTemp:na_FirstName
; 	htmlMiddleName:1  '= nameArrayTemp:na_MiddleName
; 	htmlLastName:1    '= nameArrayTemp:na_LastName
; 	htmlPrefix:1	  '= nameArrayTemp:na_Prefix
; 	htmlSuffix:1	  '= nameArrayTemp:na_Suffix
; 	htmlFullName:1	  '= nameArrayTemp:na_Name
; 	htmlCallName:1	  '= nameArrayTemp:na_CallName
; 	htmlNameType	  '= nameArrayTemp:na_NameType
; ENDIF

; ;non normal nickname
; IF !GROUPMATCH(TOLOWER(htmlCallName:1),TOLOWER(htmlFirstName:1),TOLOWER(htmlLastName:1))
; 	nonNormalNick = 1
; 	highlightStage = 3
; ELSE
; 	SIF GROUPMATCH(TOLOWER(htmlCallName:1),TOLOWER(htmlFirstName:1))
; 		highlightStage = 1
; 	SIF GROUPMATCH(TOLOWER(htmlCallName:1),TOLOWER(htmlLastName:1))
; 		highlightStage = 2
; ENDIF

; IF LoGShits
; 	nonNormalNick = 1
; 	highlightStage = 3
; ELSEIF LoGShits == 0 && SaveIsEZB && STRLENS(htmlFirstName:1) && STRLENS(htmlLastName:1)
; 	nonNormalNick = 0
; 	highlightStage = 1
; ENDIF

; ;lilys and others
; IF htmlCallName:1 == htmlFullName:1
; 	nonNormalNick = 0
; 	highlightStage = 4
; ENDIF


; ;set names
; htmlFirstName '= htmlFirstName:1
; htmlMiddleName'= htmlMiddleName:1
; htmlLastName  '= htmlLastName:1
; htmlPrefix	  '= htmlPrefix:1
; htmlSuffix	  '= htmlSuffix:1
; htmlCallName  '= @"\@ STRLENS(htmlFirstName:1) && STRLENS(htmlLastName:1) && (LoGShits != 2 && !(LoGShits == 0 && SaveIsEZB)) ? '%htmlCallName:1%' # %htmlCallName:1%\@"
; IF PrintMode == 2
; 	htmlFirstName:1  '= @"<font color='#\@ highlightStage == 1 ? %TO_HEX(nicknameColor)% # %TO_HEX(GETCONFIG("TEXT COLOR"))% \@'>%htmlFirstName%</font>"
; 	htmlMiddleName:1 '= @"<font color='#%TO_HEX(GETCONFIG("TEXT COLOR"))%'>%htmlMiddleName%</font>"
; 	htmlLastName:1   '= @"<font color='#\@ highlightStage == 2 ? %TO_HEX(nicknameColor)% # %TO_HEX(GETCONFIG("TEXT COLOR"))% \@'>%htmlLastName%</font>"
; 	htmlCallName:1   '= @"<font color='#%TO_HEX(nicknameColor)%'>%htmlCallName%</font>"
; 	htmlPrefix:1 '= @"<font color='#%TO_HEX(GETCONFIG("TEXT COLOR"))%'>%htmlPrefix%</font>"
; 	htmlSuffix:1 '= @"<font color='#%TO_HEX(GETCONFIG("TEXT COLOR"))%'>%htmlSuffix%</font>"
; ENDIF

; $NAMESORT

; IF GROUPMATCH(TOLOWER(htmlNameType),TOLOWER("Japanese"),TOLOWER("Chinese"),TOLOWER("Korean"))
; 	nVar = nNameSorting:0
; ELSEIF GROUPMATCH(TOLOWER(htmlNameType),TOLOWER("Vehicle"))
; 	nVar = 0
; 	GOTO VehicleCheck
; ELSE
; 	nVar = nNameSorting:1
; ENDIF

; SIF nForce >= 0
; 	nVar = nForce

; ;0 = smart
; ;1 = FirstName MiddleName LastName
; ;2 = LastName MiddleName FirstName
; ;3 = FirstName 'Nick' LastName
; ;4 = LastName 'Nick' FirstName

; SELECTCASE nVar
; CASE 0
; 	SELECTCASE TOLOWER(htmlNameType)
; 	CASE TOLOWER("Japanese"), TOLOWER("Chinese"), TOLOWER("Korean"), TOLOWER("Vehicle")
; 		$VehicleCheck
; 		IF nonNormalNick
; 			nVar = 4
; 		ELSE
; 			nVar = 2
; 		ENDIF
; 		GOTO LastFirst
; 	CASEELSE
; 		IF nonNormalNick
; 			nVar = 3
; 		ELSE
; 			nVar = 1
; 		ENDIF
; 		GOTO FirstLast
; 	ENDSELECT
; CASE 1, 3
; 	$FirstLast
; 	IF PrintMode == 1
; 		;callname fallback
; 		IF !STRLENS(htmlFirstName) || !STRLENS(htmlLastName) || LoGShits == 2
; 			SETCOLOR nicknameColor
; 			PRINTFORM %htmlCallName:1%
; 			SIF PrintMode == 1
; 			RESETCOLOR
; 			RETURNF
; 		ENDIF

; 		;prefix
; 		IF STRLENS(htmlPrefix)
; 			PRINTFORM %htmlPrefix%
; 			PRINTFORM %" "%
; 			SIF PrintMode == 1
; 			RESETCOLOR
; 		ENDIF

; 		;first name
; 		IF STRLENS(htmlFirstName)
; 			SIF highlightStage == 1
; 				SETCOLOR nicknameColor
; 			PRINTFORM %htmlFirstName%
; 			SIF STRLENS(htmlLastName) || STRLENS(htmlMiddleName)
; 				PRINTFORM %" "%
; 			SIF PrintMode == 1
; 			RESETCOLOR
; 		ENDIF
; 		;middle name
; 		SELECTCASE nVar
; 		CASE 1
; 			IF htmlMiddleName:1 != "" && htmlMiddleName:1 != "no"
; 				PRINTFORM %htmlMiddleName%
; 				SIF STRLENS(htmlLastName:1)
; 					PRINTFORM %" "%
; 			ENDIF
; 		CASE 3
; 			IF nonNormalNick
; 				SIF highlightStage == 3
; 					SETCOLOR nicknameColor
; 				PRINTFORM '%htmlCallName:1%'
; 				RESETCOLOR
; 				SIF STRLENS(htmlLastName:1)
; 					PRINTFORM %" "%
; 			ENDIF
; 		ENDSELECT
; 		;last name
; 		IF STRLENS(htmlLastName)
; 			SIF highlightStage == 2
; 				SETCOLOR nicknameColor
; 			PRINTFORM %htmlLastName%
; 			SIF PrintMode == 1
; 			RESETCOLOR
; 		ENDIF

; 		;suffix
; 		IF STRLENS(htmlSuffix)
; 			PRINTFORM %htmlSuffix%
; 			PRINTFORM %" "%
; 			SIF PrintMode == 1
; 			RESETCOLOR
; 		ENDIF
; 		RETURNF
; 	ELSE
; 		;callname fallback
; 		IF !STRLENS(htmlFirstName:1) || !STRLENS(htmlLastName:1) || LoGShits == 2
; 			RETURNF htmlCallName
; 		ENDIF

; 		LOCALS =
; 		;prefix
; 		SIF STRLENS(htmlPrefix)
; 			LOCALS += htmlPrefix+" "

; 		LOCALS += htmlFirstName
; 		SIF STRLENS(htmlLastName) || STRLENS(htmlMiddleName)
; 			LOCALS += " "
; 		SELECTCASE nVar
; 		CASE 1
; 			IF htmlMiddleName:1 != "" && htmlMiddleName:1 != "no"
; 				LOCALS += htmlMiddleName
; 				SIF STRLENS(htmlLastName:1)
; 					LOCALS += " "
; 			ENDIF
; 		CASE 3
; 			IF nonNormalNick
; 				LOCALS += htmlCallName
; 				SIF STRLENS(htmlLastName:1)
; 					LOCALS += " "
; 			ENDIF
; 		ENDSELECT
; 		LOCALS += htmlLastName
; 		;suffix
; 		SIF STRLENS(htmlSuffix)
; 			LOCALS += htmlSuffix
; 		RETURNF LOCALS
; 	ENDIF
; CASE 2, 4
; 	$LastFirst
; 	IF PrintMode == 1
; 		;callname fallback
; 		IF !STRLENS(htmlFirstName) || !STRLENS(htmlLastName) || LoGShits == 2
; 			SETCOLOR nicknameColor
; 			PRINTFORM %htmlCallName:1%
; 			SIF PrintMode == 1
; 			RESETCOLOR
; 			RETURNF
; 		ENDIF

; 		;prefix
; 		IF STRLENS(htmlPrefix)
; 			PRINTFORM %htmlPrefix%
; 			PRINTFORM %" "%
; 			SIF PrintMode == 1
; 			RESETCOLOR
; 		ENDIF

; 		;last name
; 		IF STRLENS(htmlLastName)
; 			SIF highlightStage == 2 && PrintMode == 1
; 				SETCOLOR nicknameColor
; 			PRINTFORM %htmlLastName%
; 			SIF STRLENS(htmlLastName) || STRLENS(htmlMiddleName)
; 				PRINTFORM %" "%
; 			SIF PrintMode == 1
; 			RESETCOLOR
; 		ENDIF
; 		;middle name
; 		SELECTCASE nVar
; 		CASE 2
; 			IF htmlMiddleName:1 != ""
; 				PRINTFORM %htmlMiddleName%
; 				SIF STRLENS(htmlLastName:1)
; 					PRINTFORM %" "%
; 			ENDIF
; 		CASE 4
; 			IF nonNormalNick
; 				SIF highlightStage == 3
; 					SETCOLOR nicknameColor
; 				PRINTFORM '%htmlCallName:1%'
; 				RESETCOLOR
; 				SIF STRLENS(htmlLastName:1)
; 					PRINTFORM %" "%
; 			ENDIF
; 		ENDSELECT
; 		;first name
; 		IF STRLENS(htmlFirstName)
; 			SIF highlightStage == 1 && PrintMode == 1
; 				SETCOLOR nicknameColor
; 			PRINTFORM %htmlFirstName%
; 			SIF PrintMode == 1
; 			RESETCOLOR
; 		ENDIF

; 		;suffix
; 		IF STRLENS(htmlSuffix)
; 			PRINTFORM %htmlSuffix%
; 			PRINTFORM %" "%
; 			SIF PrintMode == 1
; 			RESETCOLOR
; 		ENDIF
; 		RETURNF
; 	ELSE
; 		;callname fallback
; 		IF !STRLENS(htmlFirstName:1) || !STRLENS(htmlLastName:1) || LoGShits == 2
; 			RETURNF htmlCallName
; 		ENDIF

; 		LOCALS =
; 		;prefix
; 		SIF STRLENS(htmlPrefix)
; 			LOCALS += htmlPrefix+" "

; 		LOCALS += htmlLastName
; 		SIF STRLENS(htmlFirstName:1) || STRLENS(htmlMiddleName:1)
; 			LOCALS += " "
; 		SELECTCASE nVar
; 		CASE 2
; 			IF htmlMiddleName:1 != ""
; 				LOCALS += htmlMiddleName
; 				SIF STRLENS(htmlFirstName:1)
; 					LOCALS += " "
; 			ENDIF
; 		CASE 4
; 			IF nonNormalNick
; 				LOCALS += htmlCallName
; 				SIF STRLENS(htmlFirstName:1)
; 					LOCALS += " "
; 			ENDIF
; 		ENDSELECT
; 		LOCALS += htmlFirstName
; 		;suffix
; 		SIF STRLENS(htmlSuffix)
; 			LOCALS += htmlSuffix
; 		RETURNF LOCALS
; 	ENDIF
; ENDSELECT

; RETURNF LOCALS

; ;use these functions if you want to add tw: omogatari based content into your dialogue
; ;use a TRYCALLF to call a function
; [SKIPSTART]

; @ExampleFunction
; #DIM RequiredKnowledge = 1
; TRYCALLF Omogatari_Is()
; SIF RESULT
;   RequiredKnowledge = 3

; [SKIPEND]

; ;This is a consolidated example used for my Shinki dialogue
; [SKIPSTART]
; ;For Neodev compatibility I'll have to use a bunch of TRYCALLs
; ;Calls:
; ;pee, scat, omutsu, ryona, necro, factions
; @K102_VersionCheck(nVCheck)
; #FUNCTION
; #DIMS nVCheck

; SELECTCASE nVCheck
; CASE "pee"
; TRYCALLF Omogatari_Pee()
; RETURNF TFLAG:853
; CASE "scat"
; TRYCALLF Omogatari_Scat()
; RETURNF TFLAG:853
; CASE "omutsu"
; TRYCALLF Omogatari_Omutsu()
; RETURNF TFLAG:853
; CASE "ryona"
; TRYCALLF Omogatari_Ryona()
; RETURNF TFLAG:853
; CASE "necro"
; TRYCALLF Omogatari_Necro()
; RETURNF TFLAG:853
; CASE "raids"
; TRYCALLF Omogatari_Raids()
; RETURNF TFLAG:853
; CASEELSE
; TRYCALLF Omogatari_Is()
; RETURNF TFLAG:853
; ENDSELECT

; [SKIPEND]


; @Omogatari_Is
; #FUNCTION
; TFLAG:853 = 1

; @Omogatari_Pee
; #FUNCTION
; [SKIPSTART]
; Uses a bit system
; 0: diuretic play (pee during orgasms)
; 1: accidents
; 2: pee drinking
; [SKIPEND]

; TFLAG:853 = nPee

; @Omogatari_Scat
; #FUNCTION
; [SKIPSTART]
; Uses a bit system
; 0: laxative play (poo during orgasms)
; 1: enemas
; 2: accidents
; 3: poo play
; [SKIPEND]
; TFLAG:853 = nScat

; @Omogatari_Omutsu
; #FUNCTION
; [SKIPSTART]
; simple toggle
; this toggles the diaper system
; [SKIPEND]
; TFLAG:853 = nOmutsu

; @Omogatari_Ryona
; #FUNCTION
; [SKIPSTART]
; 1: ryona enabled
; 2: ryona and gore enabled
; [SKIPEND]
; TFLAG:853 = nRyona

; @Omogatari_Necro
; #FUNCTION
; [SKIPSTART]
; 1: necrophilia enabled
; [SKIPEND]
; TFLAG:853 = nNecro

; @Omogatari_Raids
; #FUNCTION
; [SKIPSTART]
; mob raids where groups of pawns are spawned to kill the player or another character.

; based off fetish settinsgs, specificly ryona, factions, and days before a raid)

; Go to Omogatari.ERH to find all of the factions, specificly their names at FactionNames 
; [SKIPEND]
; TFLAG:853 = 0

; SIF !nRyona
; 	RETURNF

; SIF !nRaids || !nFactions || SaveIsEZB
; 	RETURNF

; SIF FLAG:POSTAL == -1
; 	RETURNF

; TFLAG:853 = 1
; RETURNF 1

; @Omogatari_PeeHold(ARG)
; #FUNCTION
; [SKIPSTART]
; cumuliative pee holding stat
; [SKIPEND]
; TFLAG:853 = PeeHold:ARG:2

; @Omogatari_PooHold(ARG)
; #FUNCTION
; [SKIPSTART]
; cumuliative poo holding stat
; [SKIPEND]
; TFLAG:853 = PooHold:ARG:2

; @Omogatari_SoiledState(ARG, ExcreteType, SoilBool, SoilThreshold = 50)
; #FUNCTION
; #DIM SoilBool
; #DIM ExcreteType
; #DIM SoilThreshold
; [SKIPSTART]
; ; SoiledDiaper
; ; checks to see if the 2hu's underwear is soiled enough to give a change
; ; ARGS: ARG (target), ExcreteType (check pee, poo), 
; ; SoilBool (0: return as bool, 1: return as percentage, 2: reutrn as absolute value)
; [SKIPEND]
; TFLAG:853 = SoiledDiaper(ARG, ExcreteType, SoilBool, SoilThreshold)


; @Omogatari_SkillCheck(ARG,nSkill,nRequire)
; #FUNCTION
; #DIM nSkill
; #DIM nRequire
; TFLAG:853 = 0

; SIF ABL:ARG:nSkill >= nRequire
; 	TFLAG:853 = 1

; RETURNF TFLAG:853

; ;For Neodev compatibility I'll have to use a bunch of TRYCALLs
; ;Calls:
; ;pee, scat, omutsu, ryona, necro, factions
; @VINUM_OMOGATARI_FEATURE_CHECK(nVCheck)
; #FUNCTION
; #DIMS nVCheck
; #DIM nSkill
; #DIM nRequire

; SELECTCASE nVCheck
; CASE "pee"
; TRYCALLF Omogatari_Pee()
; RETURNF TFLAG:853
; CASE "scat"
; TRYCALLF Omogatari_Scat()
; RETURNF TFLAG:853
; CASE "omutsu"
; TRYCALLF Omogatari_Omutsu()
; RETURNF TFLAG:853
; CASE "ryona"
; TRYCALLF Omogatari_Ryona()
; RETURNF TFLAG:853
; CASE "necro"
; TRYCALLF Omogatari_Necro()
; RETURNF TFLAG:853
; CASE "raids"
; TRYCALLF Omogatari_Raids()
; RETURNF TFLAG:853
; CASEELSE
; TRYCALLF Omogatari_Is()
; RETURNF TFLAG:853
; ENDSELECT


; @REVAMP_EXP_CURVE
; #DIM REC_
; #FUNCTION
; CALLF SetMaxLevel()
; PALAMLV:0 = 0
; PALAMLV:1 = 100
; PALAMLV:2 = 500
; PALAMLV:3 = 3000
; PALAMLV:4 = 10000
; PALAMLV:5 = 30000
; PALAMLV:6 = 60000
; PALAMLV:7 = 100000
; PALAMLV:8 = 150000
; PALAMLV:9 = 250000
; PALAMLV:10 = 400000
; PALAMLV:11 = 600000
; PALAMLV:12 = 900000
; PALAMLV:13 = 1500000
; PALAMLV:14 = 3000000
; PALAMLV:15 = 5000000

; ;EasyBattle
; ; EZB_THRESHOLDS:0 = 0
; ; EZB_THRESHOLDS:1 = 100
; ; EZB_THRESHOLDS:2 = 200
; ; EZB_THRESHOLDS:3 = 400
; ; EZB_THRESHOLDS:4 = 600
; ; EZB_THRESHOLDS:5 = 800
; ; EZB_THRESHOLDS:6 = 1000
; ; EZB_THRESHOLDS:7 = 1200
; ; EZB_THRESHOLDS:8 = 1400
; ; EZB_THRESHOLDS:9 = 1600
; ; EZB_THRESHOLDS:10 = 1800
; ; EZB_THRESHOLDS:11 = 2000
; ; EZB_THRESHOLDS:12 = 2200
; ; EZB_THRESHOLDS:13 = 2400
; ; EZB_THRESHOLDS:14 = 2700


; ;Add 2 levels for the current level
; ;Level 14 = EXPLV:16
; 	REC_EXP_REV:0 = 0
; 	REC_EXP_REV:1 = 1
; 	REC_EXP_REV:2 = 1
; 	REC_EXP_REV:3 = 1
; 	REC_EXP_REV:4 = 3
; 	;D
; 	REC_EXP_REV:5 = 6
; 	REC_EXP_REV:6 = 20
; 	;C
; 	REC_EXP_REV:7 = 50
; 	REC_EXP_REV:8 = 79
; 	REC_EXP_REV:9 = 126
; 	;B
; 	REC_EXP_REV:10 = 200
; 	REC_EXP_REV:11 = 271
; 	REC_EXP_REV:12 = 368
; 	;A
; 	REC_EXP_REV:13 = 500
; 	REC_EXP_REV:14 = 630
; 	REC_EXP_REV:15 = 794
; 	;S
; 	REC_EXP_REV:16 = 1000
; 	REC_EXP_REV:17 = 1189
; 	REC_EXP_REV:18 = 1414
; 	REC_EXP_REV:19 = 1681
; 	;Extra
; 	REC_EXP_REV:20 = 2000
; 	REC_EXP_REV:21 = 2212
; 	;Phantasm
; 	REC_EXP_REV:22 = 2445
; 	REC_EXP_REV:23 = 2705
; 	REC_EXP_REV:24 = 2990
; 	REC_EXP_REV:25 = 3307
; 	REC_EXP_REV:26 = 3657
; 	REC_EXP_REV:27 = 4004
; 	REC_EXP_REV:28 = 4472
; 	REC_EXP_REV:29 = 4945
; 	REC_EXP_REV:30 = 5468
; 	REC_EXP_REV:31 = 6047
; 	;OverDrive
; 	REC_EXP_REV:32 = 6687
; 	REC_EXP_REV:33 = 7395
; 	REC_EXP_REV:34 = 8178
; 	REC_EXP_REV:35 = 9043
; 	REC_EXP_REV:36 = 10000
; 	REC_EXP_REV:37 = 11058
; 	REC_EXP_REV:38 = 12228
; 	REC_EXP_REV:39 = 13522
; 	REC_EXP_REV:40 = 14953
; 	REC_EXP_REV:41 = 16535
; 	;TriUltra
; 	REC_EXP_REV:42 = 18285
; 	REC_EXP_REV:43 = 20220
; 	REC_EXP_REV:44 = 22360
; 	REC_EXP_REV:45 = 24727
; 	REC_EXP_REV:46 = 27343
; 	REC_EXP_REV:47 = 30237
; 	REC_EXP_REV:48 = 33437
; 	REC_EXP_REV:49 = 36975
; 	REC_EXP_REV:50 = 40888
; 	REC_EXP_REV:51 = 45215
; 	;QuadUltra
; 	REC_EXP_REV:52 = 50000
; 	REC_EXP_REV:53 = 56000
; 	REC_EXP_REV:54 = 61000
; 	REC_EXP_REV:55 = 64000
; 	REC_EXP_REV:56 = 67000
; 	REC_EXP_REV:57 = 70000
; 	REC_EXP_REV:58 = 75000
; 	REC_EXP_REV:59 = 80000
; 	REC_EXP_REV:60 = 85000
; 	REC_EXP_REV:61 = 90000
; 	REC_EXP_REV:62 = 95000
; 	REC_EXP_REV:63 = 100000
; 	REC_EXP_REV:64 = 110000
; 	REC_EXP_REV:65 = 120000
; 	REC_EXP_REV:66 = 130000
; 	REC_EXP_REV:67 = 140000
; 	REC_EXP_REV:68 = 150000
; 	REC_EXP_REV:69 = 160000
; 	REC_EXP_REV:70 = 170000
; 	REC_EXP_REV:71 = 185000
; 	REC_EXP_REV:72 = 200000
; 	REC_EXP_REV:73 = 215000
; 	REC_EXP_REV:74 = 230000
; 	REC_EXP_REV:75 = 245000
; 	REC_EXP_REV:76 = 265000
; 	REC_EXP_REV:77 = 285000
; 	REC_EXP_REV:78 = 305000
; 	REC_EXP_REV:79 = 325000
; 	REC_EXP_REV:80 = 350000
; 	REC_EXP_REV:81 = 375000
; 	REC_EXP_REV:82 = 400000
; 	REC_EXP_REV:83 = 425000
; 	REC_EXP_REV:84 = 450000
; 	REC_EXP_REV:85 = 475000
; 	REC_EXP_REV:86 = 500000
; 	REC_EXP_REV:87 = 525000
; 	REC_EXP_REV:88 = 550000
; 	REC_EXP_REV:89 = 575000
; 	REC_EXP_REV:90 = 600000
; 	REC_EXP_REV:91 = 625000
; 	REC_EXP_REV:92 = 650000
; 	REC_EXP_REV:93 = 700000
; 	REC_EXP_REV:94 = 750000
; 	REC_EXP_REV:95 = 800000
; 	REC_EXP_REV:96 = 850000
; 	REC_EXP_REV:97 = 900000
; 	REC_EXP_REV:98 = 950000
; 	REC_EXP_REV:99 = 1000000

; 	;NO level rework
; 	REC_EXP:0 = 0
; 	REC_EXP:1 = 1
; 	REC_EXP:2 = 4
; 	;D
; 	REC_EXP:3 = 20
; 	;C
; 	REC_EXP:4 = 50
; 	;B
; 	REC_EXP:5 = 200
; 	;A
; 	REC_EXP:6 = 500
; 	;S
; 	REC_EXP:7 = 1000
; 	;Extra
; 	REC_EXP:8 = 2000
; 	;Phantasm
; 	REC_EXP:9 = 2445
; 	;OverDrive
; 	REC_EXP:10 = 6687
; 	;TriUltra
; 	REC_EXP:11 = 18285
; 	;QuadUltra
; 	REC_EXP:12 = 50000
; FOR LOCAL,0,VARSIZE("EXPLV")
; 	EXPLV:LOCAL = REC_EXP:LOCAL
; NEXT


; @IdentityCrsis()
; PRINTFORML Who do you want to be?
; CALL SHOW_CHARA_LIST_TR("陥落")
; LOCAL:1 = RESULT
; SELECTCASE LOCAL:1
; 	CASE 999
; 		PRINTFORML You lose interest, and you are stil who you are.
; 	CASEELSE
; 		PRINTFORML You are now %NAME:(LOCAL:1)%.
; 		MASTER = LOCAL:1
; 		PLAYER = LOCAL:1
; 		TFLAG:運搬 = LOCAL:1

; 		[SKIPSTART]
; 		CFLAG:DEBUG_Target:初期位置 = CSVCFLAG (DEBUG_Target, GETNUM(CFLAG, "初期位置"))
; 		CFLAG:DEBUG_Target:神社在住 = CFLAG:DEBUG_Target:初期位置
; 		CFLAG:DEBUG_Target:自宅位置 = CSVCFLAG (DEBUG_Target, GETNUM(CFLAG, "自宅位置"))
; 		CALLF RelocateMakaiIdiots(DEBUG_Target)
; 		SIF CFLAG:DEBUG_Target:現在位置 == SUKIMA()
; 			CFLAG:DEBUG_Target:現在位置 = CFLAG:DEBUG_Target:初期位置
; 		[SKIPEND]
; 		MAIN_MAP = CFLAG:(LOCAL:1):自宅位置/100

; 		TRYCALLFORM ROOMSETTING_{MAIN_MAP}	
; 		CALL MAP_DEFAULTRESIDENT(MAIN_MAP,1)
; 		デフォルト初期位置 = CFLAG:MASTER:初期位置	
; 		RETURN 1
; ENDSELECT
; RETURN 0



; @TitleRanks(ARG)
; #FUNCTIONS
; #DIM nAbility
; ; IF nLevelRework
; ; 	SELECTCASE ABL:ARG:nAbility
; ; 	CASE IS >= 50
; ; 		LOCALS = God of Transcended Gods of Doom
; ; 	CASE IS >= 46
; ; 		LOCALS = Transcended God of Doom
; ; 	CASE IS >= 44
; ; 		LOCALS = God of Transcended Gods
; ; 	CASE IS >= 42
; ; 		LOCALS = Transcended God
; ; 	CASE IS >= 40
; ; 		LOCALS = God of Gods
; ; 	CASE 38, 39
; ; 		LOCALS = Master God
; ; 	CASE IS >= 37
; ; 		LOCALS = Expert God
; ; 	CASE IS >= 35
; ; 		LOCALS = God
; ; 	CASE IS >= 33
; ; 		LOCALS = Rookie God
; ; 	CASE IS >= 30
; ; 		LOCALS = Demigod
; ; 	CASE IS >= 27
; ; 		LOCALS = Transcended Legend
; ; 	CASE IS >= 25
; ; 		LOCALS = Transcended Master
; ; 	CASE IS >= 23
; ; 		LOCALS = Transcended Expert
; ; 	CASE IS >= 21
; ; 		LOCALS = Transcended
; ; 	CASE 20
; ; 		LOCALS = Legendary Master
; ; 	CASE 19
; ; 		LOCALS = Planet-Leading Master
; ; 	CASE 18
; ; 		LOCALS = Planet-Known Master
; ; 	CASE 17
; ; 		LOCALS = Japan-Leading Master
; ; 	CASE 16
; ; 		LOCALS = Japanese-Known Master
; ; 	CASE 15
; ; 		LOCALS = Strong Master
; ; 	CASE 14
; ; 		LOCALS = Master
; ; 	CASE 13
; ; 		LOCALS = Strong Expert
; ; 	CASE 12
; ; 		LOCALS = Expert
; ; 	CASE 11
; ; 		LOCALS = Very skilled Professional
; ; 	CASE 10
; ; 		LOCALS = Skilled Professional
; ; 	CASE 9
; ; 		LOCALS = Solid Professional
; ; 	CASE 8
; ; 		LOCALS = Employable Professional
; ; 	CASE 7
; ; 		LOCALS = Weak Professional
; ; 	CASE 6
; ; 		LOCALS = Capable Amateur
; ; 	CASE 5
; ; 		LOCALS = Significant Familiarity
; ; 	CASE 4
; ; 		LOCALS = Some Familiarity
; ; 	CASE 3
; ; 		LOCALS = Basic Familiarity
; ; 	CASE 2
; ; 		LOCALS = Beginner
; ; 	CASE 1
; ; 		LOCALS = Utter Beginner
; ; 	CASE 0
; ; 		LOCALS = Barely heard of it
; ; 	ENDSELECT
; ; ELSE
; 	; SELECTCASE ABL:ARG:nAbility
; 	; CASE IS >= 10
; 	; 	LOCALS = God of Transcended Gods of Doom
; 	; CASE 9
; 	; 	LOCALS = God of Gods
; 	; CASE 8
; 	; 	LOCALS = God
; 	; CASE 7
; 	; 	LOCALS = Transcended
; 	; CASE 6
; 	; 	LOCALS = Legendary Master
; 	; CASE 5
; 	; 	LOCALS = Master
; 	; CASE 4
; 	; 	LOCALS = Expert
; 	; CASE 3
; 	; 	LOCALS = Employable Professional
; 	; CASE 2
; 	; 	LOCALS = Some Familiarity
; 	; CASE 1
; 	; 	LOCALS = Beginner
; 	; CASE 0
; 	; 	LOCALS = Barely heard of it
; 	; ENDSELECT
; ; ENDIF

; LOCALS '= @"%RankString(ARG)% Rank"

; RETURNF LOCALS

; @RankString(ARG)
; #FUNCTIONS
; SELECTCASE ARG
; CASE 10
; RETURNF "QuadUltra"
; CASE 9
; RETURNF "TriUltra"
; CASE 8
; RETURNF "OverDrive"
; CASE 7
; RETURNF "Phantasm"
; CASE 6
; RETURNF "Extra"
; CASE 5
; RETURNF "S"
; CASE 4
; RETURNF "A"
; CASE 3
; RETURNF "B"
; CASE 2
; RETURNF "C"
; CASE 1
; RETURNF "D"
; CASE 0
; RETURNF "E"
; ENDSELECT


; @StateComplienceMode()
; #FUNCTIONS
; SELECTCASE nSJW
; 	CASE 5
; 	RETURNF @"DIVINE PURITY"
; 	CASE 4
; 	RETURNF @"Strict"
; 	CASE 3
; 	RETURNF @"Moderate"
; 	CASE 2
; 	RETURNF @"Lax"
; 	CASE 1
; 	RETURNF @"/EGG/ Approved"
; 	CASE 0
; 	RETURNF @"Disabled"
; ENDSELECT


; @EasyImage(LOCALS,nPath,nScale = 100, WidthOverride, HeightOverride, nAlign = "left", nMaxScaling, setID)
; #DIMS nPath
; #DIM nScale
; #DIM nID
; #DIM HeightOverride
; #DIM WidthOverride
; #DIMS nAlign
; #DIM nMaxScaling
; #DIM setID

; $IdLottery
; IF setID
; nID = setID
; ELSE
; nID = RAND(1000000,10000000)
; ENDIF

; IF !GCREATED(nID)
; 	SIF 描画開始行数 == 0
; 		描画開始行数 = LINECOUNT

; 	GCREATEFROMFILE nID, @"%nPath%"
; 	SPRITECREATE @"%LOCALS%", nID
; 	$MakeImage
; 	SELECTCASE nMaxScaling
; 	CASE 0
; 	SIF !WidthOverride
; 		WidthOverride = SPRITEWIDTH(LOCALS)
; 	SIF !HeightOverride
; 		HeightOverride = SPRITEHEIGHT(LOCALS)
; 	CASE 1
; 		WidthOverride = MIN(SPRITEWIDTH(LOCALS),WidthOverride)
; 		HeightOverride = MIN(SPRITEHEIGHT(LOCALS),HeightOverride)
; 	ENDSELECT

; 	HTML_PRINT @"<p align='%nAlign%'><img src='%LOCALS%' height='{HeightOverride*nScale/100}px' width='{WidthOverride*nScale/100}px' ypos='0px'></p>"
; 	CALL ピクセル自動改行((HeightOverride*nScale/100))
; 	CALL 画像描画終了
; ELSEIF setID
; 	GOTO MakeImage
; ELSE
; CALL ピクセル自動改行((HeightOverride*nScale/100))
; GOTO IdLottery
; ENDIF

; @GiveFreeClothesSet
; #DIMS DYNAMIC  NewItems
; #DIM DYNAMIC nWeap
; #DIM DYNAMIC pottyPanties, 5
; #DIM DYNAMIC pottyPantiesCount, 5
; CALL SELECT_CLOTHES(MASTER, "今日の衣装")
; CALL CLOTHES_SETTING_TRAIN(MASTER)

; ;pantsu
; EQUIP:MASTER:6 = GLOBAL:997

; FOR LOCAL,1,24
; 	SIF (LOCAL == 6 && !GROUPMATCH(nStartingBackstory,997)) || LOCAL == 10 || !EQUIP:MASTER:LOCAL
; 		CONTINUE
; 	BoughtClothing:LOCAL:(EQUIP:MASTER:LOCAL) = 1
; 	NewItems += @"%CAPITALIZE(CLOTHES_TR(CLOTHNAME(LOCAL, EQUIP:MASTER:LOCAL)))%/"
; NEXT

; PRINTFORML You were given these clothing:
; FOR LOCAL,0,25
; 	LOCALS = %SPLIT_SINGLE(NewItems, LOCAL, "/")%
; 	SIF LOCALS == ""
; 		CONTINUE
; 	PRINTFORML ・%LOCALS%
; NEXT
; BoughtClothing:3:1 = 1
; PRINTFORML ・%CAPITALIZE(CLOTHES_TR(CLOTHNAME(3, 1)))%

; nWeap = ARMUP(MASTER,1)
; IF !GROUPMATCH(nWeap,0,1)
; PRINTL
; PRINTFORML You were also given the weapon that you would've had as an NPC
; PRINTFORML ・%GET_STR(MASTER, "Weapon", nWeap, "FullName")%
; DevelopedWeapon:(nWeap) = 1
; CALLF Create_weapon(nWeap)
; ENDIF

; ;backtory weapons
; CALL BackStoryWeapons
; IF RESULT:1
; 	PRINTFORML Backstory bonus weapons:
; 	FOR LOCAL,1,100
; 		SIF !RESULT:LOCAL
; 			BREAK
; 		PRINTFORML ・%GET_STR(MASTER, "Weapon", RESULT:LOCAL, "FullName")%
; 		DevelopedWeapon:(RESULT:LOCAL) = 1
; 		CALLF Create_Weapon(nWeap)
; 	NEXT
; ENDIF

; PRINTL
; IF nPee || nScat
; PRINTFORML Based on your potty training, you are also given some free underwear:
; ELSE
; PRINTFORML You are also given some free underwear:
; ENDIF
; IF nOmutsu
; 	SELECTCASE EffectivePottyLevel(MASTER)
; 	CASE IS <= -4
; 		;FantastaBab
; 		pottyPanties = 103
; 		pottyPantiesCount = 12
; 	CASE IS <= -2
; 		;ComfiDry
; 		pottyPanties = 101
; 		pottyPantiesCount = 12
; 	CASE IS < 0
; 		;Secreta + GN
; 		pottyPanties = 72, 73
; 		pottyPantiesCount = 24, 12
; 	CASEELSE
; 		$UNDIES
; 		pottyPanties = 1, 2, 19, 98
; 	ENDSELECT
; ELSE
; 	GOTO UNDIES
; ENDIF

; FOR LOCAL, 0, VARSIZE("pottyPanties")
; 	IF pottyPanties:LOCAL
; 		PRINTFORML ・%UNDIES_NAME_WITH_BRAND(MASTER,pottyPanties:LOCAL,1)% %COND_STR(@"x{pottyPantiesCount:LOCAL}", pottyPantiesCount:LOCAL)%
; 		BoughtClothing:6:(pottyPanties:LOCAL) = pottyPantiesCount:LOCAL ? pottyPantiesCount:LOCAL # 1
; 	ENDIF
; NEXT

; SIF !benchMarkStart
; WAIT





; @RandomName(ARG, nAllow = 1023)
; #DIM nAllow
; #DIMS sexFlag
; #DIMS ethFlag
; #DIMS buildString
; #DIMS buildStringFamily
; IF IS_FEMALE(ARG)
; 	sexFlag '= "F"
; ELSE
; 	sexFlag '= "M"
; ENDIF
; $LOOP
; SELECTCASE RAND(1000)
; CASE 0 TO 400
; 	;western
; 	SIF !GETBIT(nAllow,0)
; 		GOTO LOOP
; 	ethFlag '= "K"
; 	nameArray:ARG:na_NameType '= "Western"	
; CASE 400 TO 450
; 	;chinese
; 	SIF !GETBIT(nAllow,1)
; 		GOTO LOOP
; 	ethFlag '= ""
; 	nameArray:ARG:na_NameType '= "Chinese"
; CASEELSE
; 	;jap
; 	SIF !GETBIT(nAllow,2)
; 		GOTO LOOP
; 	ethFlag '= "J"
; 	nameArray:ARG:na_NameType '= "Japanese"
; ENDSELECT

; ;build name
; IF ethFlag != ""
; 	buildStringFamily '= @"_%ethFlag%"
; 	buildString '= buildStringFamily+@"%sexFlag%"
; ENDIF
; TRYCALLFORM GENERATE_FIRST_NAME%buildString%()
; LOCALS:1 = %RESULTS%
; TRYCALLFORM GENERATE_FAMILY_NAME%buildStringFamily%()
; LOCALS:2 = %RESULTS%

; nameArray:ARG:na_FirstName = %LOCALS:1%
; nameArray:ARG:na_LastName = %LOCALS:2%

; ;set callname
; SELECTCASE RAND:4
; CASE 0
; CALLNAME:ARG = %LOCALS:2%
; CASEELSE
; CALLNAME:ARG = %LOCALS:1%
; ENDSELECT

; ;check for conflicting names
; IF ConflictingName(ARG) != -1
; 	CALLNAME:ARG = %LOCALS:2%
; 	;we fucked up again so recreate name
; 	SIF ConflictingName(ARG) != -1
; 		GOTO LOOP
; ENDIF

; NAME:ARG = %NameChecker(ARG)%


; ;checks to see if callname is being used by another, then it switches to last name
; @ConflictingName(ARG,nType = 0, ARGS)
; #FUNCTION
; #DIM nType

; FOR LOCAL, 0, CHARANUM
; 	SIF LOCAL == ARG
; 		CONTINUE
; 	SELECTCASE nType
; 	CASE 0
; 		IF ARGS != ""
; 		SIF TOLOWER(CALLNAME:LOCAL) == TOLOWER(ARGS)
; 			RETURNF LOCAL
; 		ELSE
; 		SIF TOLOWER(CALLNAME:LOCAL) == TOLOWER(CALLNAME:ARG)
; 			RETURNF LOCAL
; 		ENDIF
; 	CASE 1
; 	;firstname
; 		SIF TOLOWER(nameArray:LOCAL:na_FirstName) == TOLOWER(nameArray:ARG:na_FirstName)
; 			RETURNF LOCAL
; 	CASE 2
; 	;lastname
; 		SIF TOLOWER(nameArray:LOCAL:na_LastName) == TOLOWER(nameArray:ARG:na_LastName)
; 			RETURNF LOCAL	
; 	ENDSELECT
; NEXT
; RETURNF -1


; @newGenderSystemConvert(ARG)
; ;;#;  PRINTFORML {ARG} (gender: {TALENT:ARG:2})
; SELECTCASE TALENT:ARG:2
; CASE 1
; 	;CALL COLORMESSAGE(@"Fixing incorrect vagina properties for %CALLNAME:ARG%...",C_YELLOW,1,1)
; 	CALLF NGSC_VAG_ADD(ARG)
; 	TALENT:ARG:2 = 1
; 	TALENT:ARG:DressingAs = 1
; CASE 2
; 	CALLF NGSC_PENIS_ADD(ARG)
; 	TALENT:ARG:2 = 2
; 	TALENT:ARG:DressingAs = 2
; CASE 3
; 	CALLF NGSC_VAG_ADD(ARG)
; 	CALLF NGSC_PENIS_ADD(ARG)
; 	TALENT:ARG:2 = 1
; 	TALENT:ARG:DressingAs = 1
; CASE 4
; 	;NB
; 	TALENT:ARG:2 = 0
; CASE 5
; 	;NB V
; 	CALLF NGSC_VAG_ADD(ARG)
; 	TALENT:ARG:2 = 0
; CASE 6
; 	;NB P
; 	CALLF NGSC_PENIS_ADD(ARG)
; 	TALENT:ARG:2 = 0
; CASE 7
; 	;Andro
; 	CALLF NGSC_VAG_ADD(ARG)
; 	CALLF NGSC_PENIS_ADD(ARG)
; 	TALENT:ARG:2 = 2
; 	TALENT:ARG:DressingAs = 2
; CASE 9
; 	;Reverse Trap
; 	CALLF NGSC_VAG_ADD(ARG)
; 	TALENT:ARG:2 = 1
; 	TALENT:ARG:DressingAs = 2
; CASE 10
; 	; Trap
; 	CALLF NGSC_PENIS_ADD(ARG)
; 	TALENT:ARG:2 = 2
; 	TALENT:ARG:DressingAs = 1
; CASE 11
; 	;NB P
; 	CALLF NGSC_VAG_ADD(ARG)
; 	CALLF NGSC_PENIS_ADD(ARG)
; 	TALENT:ARG:2 = 0
; CASE 19
; 	;Herm Trap
; 	CALLF NGSC_VAG_ADD(ARG)
; 	CALLF NGSC_PENIS_ADD(ARG)
; 	TALENT:ARG:2 = 2
; 	TALENT:ARG:DressingAs = 1
; ENDSELECT
; IF !HAS_PENIS(ARG)
; 	TALENT:ARG:形状 = 0
; 	MAXBASE:ARG:精力 = 0
; 	MAXBASE:ARG:5 = 0
; ELSE
; 	IF TALENT:ARG:形状 == 0 || MAXBASE:ARG:精力 == 0 || MAXBASE:ARG:5 == 0
; 		TALENT:ARG:形状 = 3
; 		MAXBASE:ARG:5 = 1500
; 		MAXBASE:ARG:精力 = MAX(MAXBASE:ARG:5,1000)
; 	ENDIF
; ENDIF


; @NASTitle
; #FUNCTION
; #DIM nVal
; VARSET nVal
; ; SIF nUnfair
; ; 	RETURNF 2

; SIF GETBIT(VINUM_OMOGATARI_FEATURE_CHECK("pee"),1) || GETBIT(VINUM_OMOGATARI_FEATURE_CHECK("scat"),2)
; 	SETBIT nVal, 2

; SIF (nFactions && nRaids) || nSocialFighting
; 	SETBIT nVal, 1

; SIF nSex
; 	SETBIT nVal, 0

; RETURNF nVal

; @NASTitleSTR
; #FUNCTIONS

; RETURNF @"eraNAS: %NASTitleSTR_Only(1)%"

; @NASTitleSTR_Only(ARG)
; #FUNCTIONS
; LOCALS =



; IF !ARG
; ; SIF GETBIT(NASTitle(),0)
; ; 	LOCALS += "Affection・"

; ; SIF GETBIT(NASTitle(),1)
; ; 	LOCALS += "Action・"

; ; SIF GETBIT(NASTitle(),2)
; ; 	LOCALS += "Accident・"

; SIF SUBSTRING(LOCALS,STRLENS(LOCALS)-2) == "・"
; 	LOCALS '= SUBSTRING(LOCALS,0,STRLENS(LOCALS)-2)

; LOCALS '= @"New %LOCALS% Story"
; ELSE
; 	SIF GETBIT(NASTitle(),0)
; 		LOCALS += "Nurse・"

; 	SIF GETBIT(NASTitle(),1)
; 		LOCALS += "Arm・"

; 	SIF GETBIT(NASTitle(),2)
; 		LOCALS += "Spurt・"
; ENDIF

; SIF SUBSTRING(LOCALS,STRLENS(LOCALS)-2) == "・"
; 	LOCALS '= SUBSTRING(LOCALS,0,STRLENS(LOCALS)-2)

; RETURNF LOCALS

; @NASTitleAbriv
; #FUNCTIONS
; RETURNF "NAS"

; @NASTitleFetish
; #FUNCTIONS
; LOCALS =

; SIF GETBIT(NASTitle(),0)
; 	LOCALS += "N"

; SIF GETBIT(NASTitle(),1)
; 	LOCALS += "A"

; SIF GETBIT(NASTitle(),2)
; 	LOCALS += "S"

; RETURNF @"%LOCALS%"



; @charaKnowsSex(ARG, nLevelReq = 0)
; #FUNCTION
; #DIM nLevelReq

; RETURNF (TALENT:ARG:SexKnow >= nLevelReq && nSex)

; @bladderTraitToPart(ARG)
; IF !IsBionicPart(ARG,74,0)
; 	BodyPartRemoved:ARG:74 = 0
; 	BodyPartRemoved:ARG:72 = 0
; 	CALLF AddBionic(ARG,74,106-(TALENT:ARG:BladderSize),0)
; ENDIF
; IF !IsBionicPart(ARG,67,0)
; 	BodyPartRemoved:ARG:67 = 0
; 	BodyPartRemoved:ARG:66 = 0
; 	CALLF AddBionic(ARG,67,115-(TALENT:ARG:BowelSize),0)
; ENDIF


; @RevertLevels(ARG)
; #FUNCTION
; ;UnFuckedExp is used as a flag to see if it's in the rebalanced level system or not
; ; IF !CFLAG:ARG:UnFuckedExp && nLevelRework
; ; 	;;#;PRINTFORML Converting exp for %CALLNAME:ARG%
; ; 	FOR LOCAL:1,40,75
; ; 		SELECTCASE LOCAL:1
; ; 		CASE 40 TO 60, 50 TO 56, 66 TO 69, 71, 72
; ; 		CASEELSE
; ; 		CONTINUE
; ; 		ENDSELECT
; ; 		CALLF CONVERT_TO_20_SYSTEM(ARG,LOCAL:1,0)
; ; 	NEXT
; ; 	FOR LOCAL:1 ,46, 50
; ; 		CALLF CONVERT_TO_20_SYSTEM(ARG,LOCAL:1,1)
; ; 	NEXT
; ; 	CFLAG:ARG:UnFuckedExp = 1
; ; ELSEIF CFLAG:ARG:UnFuckedExp && !nLevelRework
; ; 	FOR LOCAL:1,40,75
; ; 		SELECTCASE LOCAL:1
; ; 		CASE 40 TO 60, 50 TO 56, 66 TO 69, 71, 72
; ; 		CASEELSE
; ; 		CONTINUE
; ; 		ENDSELECT
; ; 		CALLF REVERT_TO_6_SYSTEM(ARG,LOCAL:1,0)
; ; 	NEXT
; ; 	FOR LOCAL:1 ,46, 50
; ; 		CALLF REVERT_TO_6_SYSTEM(ARG,LOCAL:1,1)
; ; 	NEXT
; ; 	CFLAG:ARG:UnFuckedExp = 0
; ; ENDIF

; IF CFLAG:ARG:UnFuckedExp
; 	FOR LOCAL:1,40,75
; 		SELECTCASE LOCAL:1
; 		CASE 40 TO 60, 50 TO 56, 66 TO 69, 71, 72
; 		CASEELSE
; 		CONTINUE
; 		ENDSELECT
; 		CALLF REVERT_TO_6_SYSTEM(ARG,LOCAL:1,0)
; 	NEXT
; 	FOR LOCAL:1 ,46, 50
; 		CALLF REVERT_TO_6_SYSTEM(ARG,LOCAL:1,1)
; 	NEXT
; 	FOR LOCAL:1 ,0, 64
; 		CALLF REVERT_TO_6_SYSTEM(ARG,LOCAL:1,2)
; 	NEXT
; 	CFLAG:ARG:UnFuckedExp = 0
; ENDIF
; ;leveling machine
; FOR LOCAL:1,40,75
; 	SELECTCASE LOCAL:1
; 	CASE 40 TO 60, 50 TO 56, 66 TO 69, 71, 72
; 	CASEELSE
; 	CONTINUE
; 	ENDSELECT
; 	ABL:ARG:(LOCAL:1) = MIN(MaxNonHLevel,ABL:ARG:(LOCAL:1))
; NEXT
; FOR LOCAL:1,46, 50
; 	TALENT:ARG:(LOCAL:1) = MIN(MaxNonHLevel,TALENT:ARG:(LOCAL:1))
; NEXT

; @FIND_DUPES(ARG)
; #FUNCTION
; #DIM DYNAMIC nCOUNT
; FOR LOCAL,0,CHARANUM
; 	IF NO:LOCAL == ARG && LOCAL != ARG
; 		nCOUNT ++
; 		RESULT:(nCOUNT+1) = LOCAL
; 		;idk here, probably mark it for deletion?
; 	ENDIF
; NEXT
; RETURNF nCOUNT


; ;As NAS uses a different become-character system from other braches,
; ;PLAYING_AS checks for both the Narikiri flag and the MASTER ID to check.
; @PLAYING_AS(ARG)
; #FUNCTION
; ;NAS
; SIF MASTER == ARG
; 	RETURNF 1
; ;Other Branches
; SIF FLAG:なりきり == ARG
; 	RETURNF 1
; RETURNF 0

; @DRUG_EFFECTIVENESS(ARG,nStrength,AddictionFormula = 0)
; #FUNCTION
; #DIM nStrength
; #DIM AddictionFormula
; SELECTCASE AddictionFormula
; CASE 0
; 	DrugExp:ARG:0 += RAND:(nStrength/10)
; CASE 1
; 	;for pain
; 	DrugExp:ARG:0 += RAND:(nStrength/50000)
; ENDSELECT

; SELECTCASE DrugAddict:ARG:0
; CASE IS >= 6
; 	TIMES nStrength, 0
; CASE 5
; 	TIMES nStrength, 0.20
; CASE 4
; 	TIMES nStrength, 0.35
; CASE 3
; 	TIMES nStrength, 0.50
; CASE 2
; 	TIMES nStrength, 0.75
; CASE 1
; 	TIMES nStrength, 0.90
; CASE 0
; 	TIMES nStrength, 1.00
; CASE -1
; 	TIMES nStrength, 1.25
; CASE -2
; 	TIMES nStrength, 1.50
; CASE -3
; 	TIMES nStrength, 2.00
; CASE -4
; 	TIMES nStrength, 2.50
; CASE IS <= -5
; 	TIMES nStrength, 3.00
; ENDSELECT

; ;Body Size
; SELECTCASE TALENT:ARG:100
; CASE -5
; 	TIMES nStrength, 10.00
; CASE -4
; 	TIMES nStrength, 4.00
; CASE -3
; 	TIMES nStrength, 2.1
; CASE -2
; 	TIMES nStrength, 1.70
; CASE -1
; 	TIMES nStrength, 1.30
; CASE 0
; 	TIMES nStrength, 1.00
; CASE 1
; 	TIMES nStrength, 0.75
; CASE 2
; 	TIMES nStrength, 0.5
; CASE 5
; 	TIMES nStrength, 0.30
; ENDSELECT

; RETURNF nStrength

; ;==================================================
; ;Universal Placeholder Lines
; ;==================================================
; @KOJO_Placeholder(ARG)
; SELECTCASE ARG
; CASE 0
; 	PRINTFORMDL %CALLNAME:TARGET% moans abnormally as you play with %HIM_HER(TARGET)%.
; CASE 1
; 	PRINTFORMDL %CALLNAME:TARGET% tries to speak with you, but runs out of dialogue lines to say.
; CASE 2
; 	PRINTFORMDL %CALLNAME:TARGET% cries in orgasm, but you're unable to understand what %HES_SHES(TARGET)% saying.
; CASE 3
; 	PRINTFORMDL %CALLNAME:TARGET% tries to convince you to do something, but can't get the words out.
; CASE 4
; 	PRINTFORMDL %CALLNAME:TARGET% does an emotionless reaction to what you just did.
; CASE 5
; 	PRINTFORMDL You put your thingy in %CALLNAME:TARGET%'s you-know-what, and you do it.
; CASE 300
; 	PRINTDATADL
; 	DATAFORM %CALLNAME:TARGET% listens to you with great interest.
; 	DATAFORM %CALLNAME:TARGET% looks distracted while you're talking.
; 	DATAFORM %CALLNAME:TARGET% responds to your conversation by striking a question about you.
; 	ENDDATA
; ENDSELECT
; PRINTFORMDW An awkward silence fills the ERB file.
; PRINTL
; SELECTCASE CFLAG:TARGET:性格傾向
; CASE 1
; 	SELECTCASE ARG
; 	CASE 0
; 		PRINTFORML 「%MOAN("m")%～... %MOAN("h")%～～～」
; 		PRINTFORMDL Seems like %CALLNAME:TARGET% is enjoying your sexual play.
; 	CASE 1

; 	CASE 2
; 		PRINTDATAL
; 		DATAFORM 「Ah! Ahhh～～～」
; 		DATAFORM 「%STUTTER("I'm")% %STUTTER("cumming")%～」
; 		ENDDATA
; 	CASE 3
; 		PRINTDATAL
; 		DATAFORM 「Can we do this?」
; 		DATAFORM 「%CALLNAME:MASTER%...」
; 		DATAFORM 「We should do... uh...」
; 		DATAFORM 「Do you think this is a good idea?」
; 		DATAFORM 「What about this?」
; 		ENDDATA	
; 	CASE 4 
; 		PRINTDATAL
; 		DATAFORM 「...」
; 		DATAFORM 「%CALLNAME:MASTER%...」
; 		DATAFORM 「Does this... feel good to you?」
; 		DATAFORM 「I don't think we're supposed to do this...」
; 		ENDDATA	
; 	ENDSELECT		
; CASEELSE
; ENDSELECT
; PRINTW

; @MyouTempleName
; #FUNCTIONS

; SIF CHARANUM >= 174
; 	RETURNF nameArray:[[Myouren]]:na_FirstName

; RETURNF "Buddhist"

; @NASVersionName(ARG=1)
; #FUNCTIONS
; LOCALS '= @"TW: \@ GAMEBASE_VERSION <= 0 ? %eraTW_Version% # %TOSTR(GAMEBASE_VERSION,"0,.###")% \@ - NAS: %NAS_VERSION%"
; SIF ARG
; 	LOCALS '= @"(%LOCALS%)"
; RETURNF LOCALS

; ;In order to avoid having to write stuff like \@(local:1) == 2?%" "%and the others#\@
; @COND_STR_TWO(ARGS, ARGS:1, CONDITION)
; #FUNCTIONS
; #DIM CONDITION
; IF CONDITION
; 	RETURNF @"%ARGS%"
; ELSE
; 	RETURNF @"%ARGS:1%"
; ENDIF

; @DecimalPlace(ARG,deciPlaces = 1)
; #FUNCTIONS
; #DIM deciPlaces

; RETURNF @"{ARG/NUM_EXPONENT(10,deciPlaces)}.{ABS(ARG)-(ABS(ARG)/NUM_EXPONENT(10,deciPlaces)*NUM_EXPONENT(10,deciPlaces))}"

; ;New Palam num which shows decimals
; ;ARG	Number
; ;ARG:1	Formatting
; ;ARG:2	Absolute Vaue
; ;ARG:3  Measurement
; @PALAM_NUM_NAS(ARG,ARG:1=0,ARG:2,usingSI=-50,ARGS="")
; #FUNCTIONS
; #DIMS deciNum
; #DIM origNum
; #DIM usingSI
; origNum = ARG
; ARG = ABS(origNum)

; VARSET LOCALS
; FOR LOCAL, 0, 7
; 	SELECTCASE ARG:1
; 	CASE 0
; 		; do not use until over 100K
; 		IF LOCAL == 0 && ARG < 100000
; 			LOCALS:1 '= @"{ARG}"
; 			LOCAL--
; 			BREAK
; 		ENDIF

; 		IF ABS(ARG) < 100000
; 			IF ABS(ARG) >= 10000
; 				LOCALS:1 '= DecimalPlace(ARG/100,1)
; 			ELSEIF ABS(ARG) >= 1000
; 				LOCALS:1 '= DecimalPlace(ARG/10,2)
; 			ELSE
; 				LOCALS:1 '= @"{ARG}"
; 				LOCAL--
; 			ENDIF
; 			BREAK
; 		ENDIF
; 	CASE 1
; 		IF ABS(ARG) < 1000000
; 			LOCALS:1 '= DecimalPlace(ARG/100,1)
; 			;LOCAL--
; 			BREAK
; 		ENDIF
; 	CASE 2
; 		IF ABS(ARG) < 1000000
; 			LOCALS:1 '= DecimalPlace(ARG/10,2)
; 			;LOCAL--
; 			BREAK
; 		ENDIF
; 	CASE 3
; 		IF LOCAL == 0 && ARG < 100000
; 			LOCALS:1 '= @"{ARG}"
; 			LOCAL--
; 			BREAK
; 		ENDIF
; 		IF ABS(ARG) < 1000000
; 			LOCALS:1 '= DecimalPlace(ARG/100,0)
; 			;LOCAL--         
; 			BREAK
; 		ENDIF
; 	ENDSELECT
; 	ARG /= 1000
; NEXT
; ;custom code. stop used SI numbers and increased visible cap to 64bit max
; IF usingSI == -50
; 	SELECTCASE LOCAL
; 		CASE 0
; 		CASE 1
; 			LOCALS += "k"
; 		CASE 2
; 			LOCALS += "M"
; 		CASE 3
; 			LOCALS += "B"
; 		CASE 4
; 			LOCALS += "T"
; 		CASE 5
; 			LOCALS += "qd"
; 		CASE 6
; 			LOCALS += "Qn"
; 	ENDSELECT
; ELSE
; 	LOCALS += SI_PREFIX((3*LOCAL)+usingSI,1)
; ENDIF
; IF !STRLENS(LOCALS) && ARGS != "g"
; 	LOCALS += CAPITALIZE(ARGS)
; ELSE
; 	LOCALS += ARGS
; ENDIF

; SIF !ARG:2
; LOCALS:2 '= @"\@ origNum < 0 ? - # \@"

; ;数値の桁数に応じて間隔を調整
; LOCALS = %LOCALS:2%%LOCALS:1%%LOCALS%

; RETURNF LOCALS


; ;returns true if all passed characters are in the same location as ARG
; @IS_HERE_NAS(ARG = -1, ARG:1=-1, ARG:2=-1, ARG:3=-1, ARG:4=-1, ARG:5=-1, ARG:6=-1, ARG:7=-1, ARG:8=-1, ARG:9=-1)
; #FUNCTION
; SIF ARG == -1
; 	ARG = MASTER
; LOCAL:1 = FINDELEMENT(ARG, -1)
; SIF LOCAL:1 == -1
;     LOCAL:1 = 10
; FOR LOCAL, 1, LOCAL:1
;     SIF CFLAG:ARG:現在位置 != CFLAG:(ARG:LOCAL):現在位置
;         RETURNF 0
; NEXT
; RETURNF 1

; ;NAS Reverse service now services YOU
; @NAS_COM_REVSERVICE(ID_COM)
; #FUNCTION
; #DIM ID_COM
; SIF INRANGE(ID_COM, 80, 85) || GROUPMATCH(ID_COM, 120, 121, 140, 501, 505, 508, 509, 510, 511, 512)
; 	RETURNF 1
; SIF GROUPMATCH(ID_COM, 99) ;com custom code, modded actions: onaholejob
; 	RETURNF 1

; ;NAS services filters commands servicing the touhou
; @NAS_COM_SERVICE(ID_COM)
; #FUNCTION
; #DIM ID_COM
; SIF GROUPMATCH(ID_COM, 2, 96, 123, 124)
; 	RETURNF 1
; RETURNF 0

; @CUSTOM_OPTION_41
; PRINTFORML [ 41] - Change Character Portraits

; @CUSTOM_OPTION_RESULT_41
; #DIM C_ID

; LINESTART = LINECOUNT
; DO
; REDRAW 0
; CLEARLINE LINECOUNT - LINESTART
; PRINTFORML Choose who's character's portraits.
; DRAWLINE
; SIF FLAG:並び替え
; 	CALL CHARASORT_EX
; FOR LOCAL:1, 0, EX_CHARANUM
; 	IF FLAG:並び替え
; 		LOCAL = RESULT:(LOCAL:1)
; 		SIF LOCAL < 0
; 			CONTINUE
; 	ELSE
; 		LOCAL = LOCAL:1
; 		SIF LOCAL >= CHARANUM
; 			BREAK
; 	ENDIF
; 	PRINTFORMLC [{LOCAL, 3}] %CALLNAME:LOCAL%\@ LOCAL == MASTER ? %" (You)"% # \@
; 	RESETCOLOR
; NEXT
; PRINTL 　
; DRAWLINE
; PRINTFORM [999] Finish
; PRINTL

; $LOOP
; INPUT
; C_ID = RESULT
; IF C_ID >= 0 && C_ID <= CHARANUM
; 	gLineCount = LINECOUNT
; 	DO
; 	CLEARLINE LINECOUNT - LINECOUNT
; 	DRAWLINE
; 	PRINTFORM Editing 
; 	CALLF NameChecker(C_ID,,1)
; 	PRINTL
; 	DRAWLINE
; 	CALL CHAR_EDITOR_NAS_PAGE_7(C_ID, 1)
; 	PRINTFORML 
; 	PRINTBUTTON "[9999] End Customization", 9999
; 	INPUT
; 	SELECTCASE RESULT
; 	CASE 9999 ;custom code
; 		BREAK
; 	CASEELSE
; 		TRYCALLFORM CHAR_EDITOR_NAS_RESULT_7(C_ID, 1, RESULT)
; 	ENDSELECT
; 	LOOP 1
; ELSEIF RESULT == 999
; 	PRINTW Settings applied.
; 	RETURN
; ELSE
; ENDIF
; LOOP 1


; ;year string
; ;under year 0 means before common era
; ;show CE from year 0 to 1000
; @YearSTR(ARG)
; #FUNCTIONS

; SELECTCASE ARG
; CASE IS > 1000
; 	RETURNF @"{ARG}"
; CASE IS < 0
; 	RETURNF @"{ABS(ARG)} BCE"
; CASEELSE
; 	RETURNF @"{ARG} CE"
; ENDSELECT

; @MONEYSTR_HTML(ARG)
; #FUNCTIONS
; #DIMS DYNAMIC html
; html '= 金額表示(ARG)

; RETURNF MO_TALENT(html, @"\@ ARG < 0 ? - #\@¥%DIGIT_GROUP(ARG)%")

; @CHARISMA_HTML(ARG)
; #FUNCTIONS
; #DIMS DYNAMIC html
; html '= @"%PALAM_NUM_NAS(ARG,1,1)% CM"

; RETURNF MO_TALENT(html, @"\@ ARG < 0 ? - #\@%DIGIT_GROUP(ARG)% CM")

; @BASIC_STATE_HTML(C_ID, OP)
; #DIM C_ID
; #DIMS OP
; #DIMS DYNAMIC html
; VARSET html

; DRAWLINEFORM ━
; html '= "■"
; html += NameChecker(C_ID,,2,,)
; ;custom code
; IF SaveIsEZB
; ;#; html += @"(ID:{C_ID}, NO:{NO:C_ID}, RIVAL:{LoG_RivalID(C_ID)})"
; ELSE
; ;#; html += @"(ID:{C_ID}, NO:{NO:C_ID})"
; ENDIF
; html += @"(Favor: %PRINT_RANK_HTML(CFLAG:C_ID:好感度, "MAX_1M")% {CFLAG:C_ID:好感度} "
; html += @"Trust: %PRINT_RANK_HTML(CFLAG:C_ID:信頼度, "MAX_20000")% {CFLAG:C_ID:信頼度} "
; html += @"Agreement: %PRINT_RANK_HTML(CFLAG:C_ID:合意判定, "MAX_1000")% {CFLAG:C_ID:合意判定})"
; ;MASTERならば所持金を記載
; IF C_ID == MASTER
; 	html += @"(Money: %MONEYSTR_HTML(MONEY)%)"
; 	SIF MONEY:2
; 	html += @" (Charisma: %CHARISMA_HTML(MONEY:2)%)"
; 	SIF ITEM:131
; 	html += @" (%nameArray:33:na_LastName% Blanks: {ITEM:131})"
; 	SIF KOMAFUDA:MASTER ;qol custom code
; 		html += @" (Gambling Den Chips: {KOMAFUDA:MASTER})"
; 	html += " "
; ENDIF
; IF NOTICE_CYCLE(C_ID) && HAS_VAGINA(C_ID)
; ;モブ物色中判定
; 	IF STRCOUNT(OP, "「調教中」") || SELECTCOM == 444
; 		CALL NEW_CYCLE_PRINT(C_ID, , "「HTML」")
; 	ELSE
; 		CALL NEW_CYCLE_PRINT(C_ID, 1, "「等幅」/「HTML」")
; 	ENDIF
; 	html += RESULTS
; ENDIF
; IF IsDead:C_ID:0
; 	SETCOLOR C_D_RED
; 	html += @"%MO_TALENT(@"Died in day {DeathDay:C_ID:0}", DeathText:C_ID:0)%"
; ENDIF
; SIF C_ID != MASTER && NOTICE_CYCLE(C_ID)
; 	SETCOLOR C_AQUA
; IF CFLAG:C_ID:生解禁 == 2
; 	html += @"%MO_TALENT(@" Allows unprotected sex on dangerous day")%"
; ELSEIF CFLAG:C_ID:生解禁 == 1
; 	html += @"%MO_TALENT(@" Allows unprotected sex")%"
; ELSEIF GETBIT(CFLAG:C_ID:既成事実, 1)
; 	html += @"%MO_TALENT(@" Has consented to sex")%"
; ENDIF
; RESETCOLOR
; SIF PushDownFilter:TARGET:0
; 	html += @"%MO_TALENT(@" Pushdown Consent Revoked", @"%CALLNAME:C_ID% is unable to push you down on %HIS_HER(C_ID)% own.", TOSTR(C_YELLOW,"X6"))%"
; SIF PushDownFilter:TARGET:1
; 	html += @"%MO_TALENT(@" Can rape you with TSP", @"%CALLNAME:C_ID% can rape you with %HIS_HER(C_ID)% own time stop.", TOSTR(C_YELLOW,"X6"))%"
; SIF PushDownFilter:TARGET:2
; 	html += @"%MO_TALENT(@" Has consented to TSP rape", @"%CALLNAME:C_ID% can be raped with time stop without any repercussions.", TOSTR(C_YELLOW,"X6"))%"
; SIF PushDownFilter:TARGET:4
; 	html += @"%MO_TALENT(@" Can hypnotize you", @"%CALLNAME:C_ID% can hypnotize you with %HIS_HER(C_ID)% own Hypnosis Youjutsu.", TOSTR(C_YELLOW,"X6"))%"
; SIF PushDownFilter:TARGET:3
; 	html += @"%MO_TALENT(@" Has consented to hypnosis", @"%CALLNAME:C_ID% can be hypnotized with Hypnosis Youjutsu without any repercussions.", TOSTR(C_YELLOW,"X6"))%"
; HTML_PRINT html
; ;end of HTML edits

; ;ここだけBASE基本表示で独立させてもいいかもって感じに使い勝手良さそう
; CALL Add_STAMINA_BAR(C_ID, 28, 1)
; PRINTFORM 　　
; CALL BASE_BAR(C_ID, "気力", 28, "青", "")
; IF Has_Penis(C_ID)
; 	PRINTFORM 　　
; 	CALL BASE_BAR(C_ID, "精力", 28, "黄","「改行」")
; ELSEIF !LINEISEMPTY()
; 	PRINTFORML
; ENDIF
; IF BASE:C_ID:酒気
; 	CALL BASE_BAR(C_ID, "酒気", 28, "赤", "")
; 	PRINTFORM 　　	
; ENDIF
; SIF BASE:C_ID:Hypno
; 	CALL BASE_BAR(C_ID, "Hypno", 28, "紫",)


; [SKIPSTART]
; ;poo bar
; IF GETBIT(nPee, 1)
; CALL PeeBar(C_ID,21)
; ENDIF
; PRINTFORM 　  
; IF GETBIT(nScat, 2)
; CALL PooBar(C_ID,21)
; ENDIF
; PRINTFORML
; [SKIPEND]

; IF NOTICE_LUST(C_ID)
; 	;記述が整理できるという理由で微妙に閾値変更
; 	SELECTCASE CFLAG:C_ID:溜まってる度
; 	CASE IS >= 900
; 		SETCOLOR C_PINK
; 	CASE IS >= 800
; 		SETCOLOR C_RED	
; 	CASE IS >= 690
; 		SETCOLOR C_D_ORANGE
; 	CASE IS >= 500
; 		SETCOLOR C_ORANGE		
; 	CASE IS >= 334
; 		SETCOLOR C_YELLOW
; 	ENDSELECT
; 	PRINTFORMD Sexual Frustration: 
; 	CALL PRINT_COLORBAR(CFLAG:C_ID:溜まってる度, 1000, 20, UNICODE(0x2585), UNICODE(0x2585), C_PINK, 0x4f414e)
; 	PRINTFORM %" "+TOSTR(CFLAG:C_ID:溜まってる度 / 10),5,LEFT%
; 	PRINTFORMD ％
; 	RESETCOLOR
; ENDIF

; SIF TALENT:C_ID:ESP
; CALL BASE_BAR(C_ID, "法力", 28, "オレンジ") 
; SIF TALENT:C_ID:ESP && MAXBASE:C_ID:TSP
; PRINTFORM 　　
; SIF MAXBASE:C_ID:TSP
; CALL BASE_BAR(C_ID, "TSP", 28, "水色", "")
; IF C_ID == MASTER
; ELSE
; 	IF SaveIsEZB
; 		IF LoG_RivalWins(LoG_RivalID(C_ID))
; 			SETCOLOR C_YELLOW
; 			PRINTFORM 　★Beaten
; 			RESETCOLOR
; 		ENDIF
; 		PRINTFORML 　★Record: {LoG_RivalWins(LoG_RivalID(C_ID))}-{LoG_RivalLosses(LoG_RivalID(C_ID))}-{LoG_RivalDraws(LoG_RivalID(C_ID))} (W-L-D)
; 	ELSE
; 		SIF CFLAG:(C_ID):弾幕勝負勝利 == 1
; 			PRINTFORM ★Beaten In Combat
; 	ENDIF
; 	SIF CFLAG:(C_ID):ムシバトル直接勝利 == 1
; 		PRINTFORM ★Beaten at Bug Battle
; 	SIF CFLAG:(C_ID):料理勝負勝利 == 1
; 		PRINTFORM ★Beaten In Cooking Competition
; 	;qol custom code, show currently used dialogue
; 	;first see if we have something on the current line to determine if we want to add extra spacing
; 	SIF CFLAG:(C_ID):弾幕勝負勝利 || CFLAG:(C_ID):ムシバトル直接勝利 == 1 || CFLAG:(C_ID):料理勝負勝利 == 1 || SaveIsEZB
; 		PRINTFORM 　　　　
; 	CALL QoL_DetailedInfo(Qol_Info_Dialogue, C_ID)
; 	PRINTFORML
; ENDIF

; @RECOVER_NAS(ARG,AMOUNT,BASE_ID,ARGS:1)
; #DIM BASE_ID
; #DIM AMOUNT
; #DIM COLOR_SET
; SIF AMOUNT == 0 || !CHECKE_BASE(ARG, ARGS)
; 	RETURN
; ;回復処理

; IF GROUPMATCH(BASE_ID,0)
; BASE:ARG:(BASE_ID) = LIMIT(BASE:ARG:(BASE_ID) + AMOUNT, -MAXBASE:ARG:(BASE_ID), MAXBASE:ARG:(BASE_ID))
; ELSEIF GROUPMATCH(BASE_ID,0,4,17)
; BASE:ARG:(BASE_ID) = MAX(BASE:ARG:(BASE_ID) + AMOUNT, 0)
; ELSE
; BASE:ARG:(BASE_ID) = LIMIT(BASE:ARG:(BASE_ID) + AMOUNT, 0, MAXBASE:ARG:(BASE_ID))
; ENDIF
; ;表示処理
; SIF AMOUNT > 0 && AMOUNT < 100 && ARGS:1 == ""
; 	RETURN
; IF CFLAG:ARG:現在位置 == CFLAG:MASTER:現在位置 || DT_EXIST("lcCombatants")
; 	;custom code, edited, use space to always show the note
; 	LOCALS = \@ STRLENS(ARGS:1) && ARGS:1 != " " ? （%ARGS:1%） # \@
; 	IF GROUPMATCH(BASE_ID,4,17)
; 		IF AMOUNT < 0
; 			COLOR_SET = C_GREEN
; 		ELSEIF AMOUNT > 0
; 			COLOR_SET = C_RED
; 		ENDIF
; 	ELSE
; 		IF AMOUNT > 0
; 			COLOR_SET = C_GREEN
; 		ELSEIF AMOUNT < 0
; 			COLOR_SET = C_RED
; 		ENDIF
; 	ENDIF

; 	;Custom code, translate BASE-name
; 	LOCALS '= @"%BASE_TR(BASENAME:BASE_ID)%\@ AMOUNT >= 0 ? ＋ # －\@{ABS(AMOUNT)} （%CALLNAME:ARG%）%LOCALS%"
; 	IF DT_EXIST("TGC_Map")
;         CALL TGC_LogAdd(LOCALS, COLOR_SET)
; 	ELSE
; 		CALL COLORMESSAGE(LOCALS,COLOR_SET,1)
; 	ENDIF
; ENDIF

; IF BASE_ID == 0 && ARG == MASTER
; 	SIF SaveAchievementClaimed("rapedInTSP")
; 	CALL RECOVER_NAS(ARG,AMOUNT/5,8)
; ENDIF


; @SexAnywhereIndicator(ARG)
; #FUNCTIONS
; #DIM IsPublic
; VARSET IsPublic
; VARSET LOCALS

; FOR LOCAL, 0, CHARANUM
; 	SIF CFLAG:LOCAL:現在位置 == CFLAG:MASTER:現在位置
; 		CONTINUE
; 	SIF LOCAL == MASTER
; 		CONTINUE
; 	SIF CFLAG:LOCAL:現在位置 == ARG
; 		IsPublic = 1
; 	SIF CAN_MOVE(CFLAG:LOCAL:現在位置, ARG) & 2
; 		IsPublic = 1
; NEXT
; SIF WITH_MOB()
; 	IsPublic = 2
; SIF DATE_HITOGOMI()
; 	IsPublic = 2

; IF OUTROOF(ARG)
; 	SETCOLOR COLOR("ORANGE")
; 	LOCALS '= "Outside"	
; ELSEIF (ROOMDATA:(ARG % 100) & 場所_風呂) ||  (ROOMDATA:(ARG % 100) & 場所_トイレ)
; 	SETCOLOR COLOR("緑")
; 	LOCALS '= "Bathroom"
; ELSEIF (ROOMDATA:(ARG % 100) & 場所_プライベート)
; 	SETCOLOR COLOR("緑")
; 	LOCALS '= "Private"
; ELSE
; 	SETCOLOR COLOR("黄")
; 	LOCALS '= "Public"	
; ENDIF

; IF IsPublic
; 	SETCOLOR COLOR("赤")
; 	LOCALS += " - Populated"
; ENDIF
; RETURNF LOCALS

; @PlaceIsPublic(ARG)
; #FUNCTION
; #DIM IsPublic
; VARSET IsPublic
; VARSET LOCALS

; FOR LOCAL, 0, CHARANUM
; 	SIF CFLAG:LOCAL:現在位置 == CFLAG:MASTER:現在位置
; 		CONTINUE
; 	SIF LOCAL == MASTER
; 		CONTINUE
; 	SIF CFLAG:LOCAL:現在位置 == ARG
; 		IsPublic = 1
; 	SIF CAN_MOVE(CFLAG:LOCAL:現在位置, ARG) & 2
; 		IsPublic = 1
; NEXT

; IF OUTROOF(ARG)
; 	RETURNF 0
; ELSEIF (ROOMDATA:(ARG % 100) & 場所_風呂) ||  (ROOMDATA:(ARG % 100) & 場所_トイレ)
; 	RETURNF 0
; ELSEIF (ROOMDATA:(ARG % 100) & 場所_プライベート)
; 	RETURNF 0
; ELSE
; 	RETURNF 1
; ENDIF

; IF IsPublic
; 	RETURNF 2
; ENDIF


; @BusinessHours(ARG,ARG:1)
; ;開店時間・閉店時間
; IF INRANGE(TIME:0, ARG, ARG:1) == 0 ;logging tweak
; 	PRINTFORML Outside of business hours.
; 	PRINTFORMW Opening Hours: %時刻表示(ARG)% To %時刻表示(ARG:1)%
; 	RETURN -1
; ENDIF

; @UNIQUE_COM_BUY_MEDS_NAS
; #DIM 買うもの
; #DIM CONST UCBMNAS_PAD_COUNT = 36, 36, 30, 25, 20, 16, 16, 16
; #DIM CONST UCBMNAS_PAD_COST = 500, 650, 1000, 1500, 2000, 2500, 3000, 4500
; DRAWLINE
; CALL LIST_ITEM("うさぎ薬品")
; DRAWLINE
; PRINTFORML Please select items to purchase. Available money:\\%DIGIT_GROUP(MONEY)%
; PRINTL
; VARSET LOCALS
; PRINTL Drugs
; CALL ITEM_SHOPPING(GETNUM(ITEM, "惚れ薬"), "Getting high favor the easy way")
; CALL ITEM_SHOPPING(GETNUM(ITEM, "睡眠薬"), "Don't abuse this, okay?")
; CALL ITEM_SHOPPING(GETNUM(ITEM, "栄養ドリンク"), "Contains 1000mg of taurine")
; CALL ITEM_SHOPPING(GETNUM(ITEM, "精力剤"), "Filthy rich purveyor")
; CALL ITEM_SHOPPING(GETNUM(ITEM, "ウコンドリンク"), "Use before ingesting alcohol")
; CALL ITEM_SHOPPING(GETNUM(ITEM, "栄養強化剤"), "Supplements that can be mixed into food that often lack nutrition.")
; ;========================================================
; PRINTL Medical
; CALL ITEM_SHOPPING(GETNUM(ITEM, "包帯"), "Used for hiding injured spots and stopping bleeding")
; CALL ITEM_SHOPPING(GETNUM(ITEM, "SurgeryKit"), "Used for surgery and for installation of new parts.")
; CALL ITEM_SHOPPING(GETNUM(ITEM, "Ibuprofen"), "Used for relieving against minor pain")
; CALL ITEM_SHOPPING(GETNUM(ITEM, "Morphine"), "Used for relieving against moderate pain")

; ;========================================================
; PRINTL Padding
; ;NAS: Pads
; IF UndiesCanSoil("liquid")
; 	FOR LOCAL,0,VARSIZE("UNDERWEAR_PAD_TYPES")
; 	CALLF UNDERWEAR_PAD_TYPES(UNDERWEAR_PAD_TYPES:LOCAL)
; 	CALL EX_SHOPPING(UNDERWEAR_PAD_TYPES_ITEMS:LOCAL, @"%UNDERWEAR_PAD_TYPES:LOCAL% Pad Pack", @"Contains {UCBMNAS_PAD_COUNT:LOCAL} pads made for %UNDERWEAR_PAD_TYPES_PURPOSE% ({UNDERWEAR_PAD_TYPES_LIQUID}ml)", UCBMNAS_PAD_COST:LOCAL, UCBMNAS_PAD_COUNT:LOCAL)
; 	NEXT
; ENDIF
; IF nOmutsu
; CALL EX_SHOPPING(GETNUM(ITEM, "DiapeBooster"), "Diaper Booster Pack", "Contains 20 diaper boosters", 1200, 20)
; ENDIF
; ;========================================================
; PRINTL Other
; CALL EX_SHOPPING(GETNUM(ITEM, "ローション"), "Bottle of Lotion", "Large bottle of lubricant lotion. Probably enough for 5 uses.", 1000, 5)
; CALL EX_SHOPPING(GETNUM(ITEM, "コンドーム"), "Condom value pack", "Contains 50 condoms", 1000, 50)
; CALL EX_SHOPPING(GETNUM(ITEM, "ピル"), @"%PLURALIZER(ITEMNAME_TR(49),5)% (5pcs)", "Bright family planning", 5000, 5)
; CALL ITEM_SHOPPING(GETNUM(ITEM, "瓶"), "An empty bottle that can be used to store milk. Don't let it go to waste again!", ITEM:瓶 ? -(40*(ITEM:瓶))#0) ;addition custom code
; IF TARGET == [[てゐ]] && !ITEM:兎符「開運大紋」
; 	;NAS: color tewi's deal
; 	SELECTCASE CREST_ITEMPRICE()
; 	CASE IS < ITEMPRICE:130
; 		SETCOLOR C_GREEN
; 	CASE IS >= 50000
; 		SETCOLOR C_D_RED
; 	CASE IS >= 30000
; 		SETCOLOR C_RED
; 	CASE IS >= 20000
; 		SETCOLOR C_ORANGE
; 	CASE IS > 10000
; 		SETCOLOR C_YELLOW
; 	ENDSELECT
; 	CALL EX_SHOPPING(GETNUM(ITEM, "兎符「開運大紋」"), ITEMNAME_TR(130), @"Lucky item that increases the chance of perverted dreams (Bought {FLAG:開運大紋購入回数} times)", CREST_ITEMPRICE(), 1)
; 	RESETCOLOR
; ENDIF
; DRAWLINE
; PRINTL [999] Return
; INPUT

; IF RESULT == 999
; 	RETURN -1
; ELSEIF RESULT == GETNUM(ITEM, "兎符「開運大紋」") && TARGET == [[てゐ]] && !ITEM:兎符「開運大紋」
; 	CALL BOTTAKURI
; ELSEIF RESULT == GETNUM(ITEM, "ローション")
; 	CALL ITEM_CARTON(RESULT, 1000, 5)
; ELSEIF RESULT == GETNUM(ITEM, "コンドーム")
; 	CALL ITEM_CARTON(RESULT, 1000, 50)
; ELSEIF RESULT == GETNUM(ITEM, "ピル")
; 	CALL ITEM_CARTON(RESULT, 5000, 5)
; ELSEIF RESULT == GETNUM(ITEM, "DiapeBooster")
; 	CALL ITEM_CARTON(RESULT, 1200, 20)
; ELSEIF GROUPMATCH(RESULT,310, 329, 301, 302, 303, 330, 331, 332,322)
; 	P = FINDELEMENT(UNDERWEAR_PAD_TYPES_ITEMS,RESULT)
; 	IF P == -1
; 		RESTART
; 	ENDIF
; 	P:1 = UCBMNAS_PAD_COST:P
; 	P:2 = UCBMNAS_PAD_COUNT:P
; 	CALL ITEM_CARTON(UNDERWEAR_PAD_TYPES_ITEMS:P, P:1, P:2)

; ELSE
; 	買うもの = RESULT
; 	CALL ITEMDATA(買うもの, "TYPE:うさぎ薬品")
; 	IF RESULT && ITEMSALES:買うもの >= 1 && ITEM:買うもの < 所持数制限
; 		CALL ITEMDATA(買うもの, "購入")
; 		SIF !RESULT
; 			RESTART
; 	ELSE
; 		RESTART
; 	ENDIF
; ENDIF
; RESTART

; @SkillTrainerMenu(ARG)
; #DIM STM_LINECOUNT
; #DIMS STM_INT = "EXP", "JUEL"
; #DIMS STM_CATEGORY = "Experience", "Gems"
; #DIM DYNAMIC STM_PAGE
; #DIMS STM_NAME
; #DIM STM_AMOUNT
; #DIM STM_COUNT
; #DIM PADDING = 32
; STM_LINECOUNT = LINECOUNT
; IF !GETBIT(CharaQuestline:102:0:0,3)
; 	PRINTFORML You don't know how to use this.
; 	PRINTFORMW Maybe if you befriend the matronly devil, %HE_SHE(102)% might teach you how to use it.
; 	RETURN 3
; ENDIF

; DO
; 	CLEARLINE LINECOUNT - STM_LINECOUNT
; 	DRAWLINE
; 	PRINTFORML Please pick a skill to level up:
; 	DRAWLINE
; 	FOR LOCAL,0, VARSIZE(STM_INT:STM_PAGE)
; 		SELECTCASE STM_PAGE
; 		CASE 0
; 		STM_NAME '= EXP_TR(LOCAL)
; 		SIF !STRLENS(STM_NAME)
; 			CONTINUE
; 		STM_AMOUNT = EXP:ARG:LOCAL
; 		CASE 1
; 		STM_NAME '= PALAM_TR(PALAMNAME:LOCAL)
; 		SIF !STRLENS(STM_NAME)
; 			CONTINUE
; 		STM_AMOUNT = JUEL:ARG:LOCAL
; 		ENDSELECT
; 		LOCALS '= @"%STM_NAME,25,LEFT%: %PALAM_NUM_NAS(STM_AMOUNT),5,LEFT%"
; 		PRINTBUTTON @"%LOCALS,PADDING,LEFT%", STM_PAGE*1000+LOCAL
; 		STM_COUNT ++
; 		IF PADDING % (MAXWIDTH()/PADDING) == 0
; 			PRINTL
; 			STM_COUNT = 0
; 		ENDIF
; 	NEXT
; 	PRINTL
; 	FOR LOCAL, 0, VARSIZE("STM_CATEGORY")
; 		SIF STM_PAGE == LOCAL
; 			SETCOLOR 0x00FFFF
; 		;exception for player character
; 		PRINTBUTTON STM_CATEGORY:LOCAL, 15000+LOCAL
; 		RESETCOLOR
; 		PRINTFORM 　　
; 	NEXT
; 	PRINTL
; 	PRINTFORML [-99] - Leave 
; 	INPUT
; 	SELECTCASE RESULT
; 	CASE -99
; 		RETURN 3
; 	CASE 15000 TO 15000+VARSIZE("STM_CATEGORY")
; 		STM_PAGE = (RESULT)-15000
; 	CASE IS >= 1000
; 		PRINTFORML You use the skilltrainer.
; 		CALL JUEL_UP_SPECIAL(ARG,PALAMNAME:(RESULT-1000),-1,20000,1); Gems
; 		WAIT
; 		RETURN 1
; 	CASE IS >= 0
; 		PRINTFORML You use the skilltrainer.
; 		CALL EVENT_Get_EXP(ARG, RESULT, 200); EXP
; 		WAIT
; 		RETURN 1
; 	ENDSELECT
; LOOP 1

; ;permission list for stuff
; @HAVE_PERMS_LIST(HPL_LOCATION,HPL_ACTION,HPL_CHARA)
; #FUNCTION
; #DIM HPL_LOCATION
; #DIMS HPL_ACTION
; #DIM HPL_PERM
; #DIM REF HPL_CHARA

; HPL_PERM = 1
; VARSET HPL_CHARA, -1
; SELECTCASE HPL_ACTION
; CASE "logging"
; 	SELECTCASE CFLAG:MASTER:300
; 		CASE 25, 妖精の大樹
; 			HPL_CHARA:0 = 1
; 		CASE GET_MAP_REPLACEMENT(433)
; 			HPL_CHARA:0 = 53
; 			HPL_CHARA:1 = 61
; 			HPL_CHARA:2 = 62
; 			HPL_CHARA:3 = 72
; 		CASE GET_MAP_REPLACEMENT(805)
; 			HPL_CHARA:0 = 29
; 			HPL_CHARA:1 = 42
; 	ENDSELECT
; CASE "foraging"
; 	SELECTCASE CFLAG:MASTER:300
; 		CASE GET_MAP_REPLACEMENT(438)
; 			HPL_CHARA:0 = 68
; 		CASE GET_MAP_REPLACEMENT(833)
; 			HPL_CHARA:0 = 34
; 		CASE GET_MAP_REPLACEMENT(855)
; 			HPL_CHARA:0 = 142
; 	ENDSELECT
; [SKIPSTART]
; CASE "street stall"
; 	SELECTCASE HPL_LOCATION
; 		CASE GET_MAP_REPLACEMENT(2)
; 			HPL_CHARA:0 = 1
; 		CASE GET_MAP_REPLACEMENT(102)
; 			HPL_CHARA:0 = 55
; 		CASE GET_MAP_REPLACEMENT(401)
; 			HPL_CHARA:0 = 62
;             HPL_CHARA:1 = 72
; 		CASE GET_MAP_REPLACEMENT(703)
; 			HPL_CHARA:0 = 51
; 		CASE GET_MAP_REPLACEMENT(805)
; 			HPL_CHARA:0 = 29
; 			HPL_CHARA:1 = 42
; 		CASE GET_MAP_REPLACEMENT(811)
; 			HPL_CHARA:0 = 31
; 			HPL_CHARA:1 = 32
; 			HPL_CHARA:2 = 33
; 		CASE GET_MAP_REPLACEMENT(832)
; 			HPL_CHARA:0 = 34
; 	ENDSELECT
; [SKIPEND]
; ENDSELECT

; ;no character
; SIF HPL_CHARA:0 == -1 || FLAG:催眠強度 > 50
; 	GOTO HAVE_PERMS

; ;get any
; FOR LOCAL, 0, VARSIZE("HPL_CHARA")
; 	SIF HPL_CHARA:LOCAL < 0
; 		BREAK
; 	SIF ABL:(HPL_CHARA:LOCAL):親密 >= 5
; 		GOTO HAVE_PERMS
; 	SIF CFLAG:(HPL_CHARA:LOCAL):弾幕勝負勝利 && HPL_ACTION == "foraging"
; 		GOTO HAVE_PERMS
; 	SIF TCVAR:(HPL_CHARA:LOCAL):Common_Sense_Alteration_Status > 50
; 		GOTO HAVE_PERMS
; NEXT
; RETURNF -1
; $HAVE_PERMS
; RETURNF 1
; 	; CALL HAVE_PERMS(CFLAG:MASTER:300,"foraging")


; @HAVE_PERMS(HP_LOCATION,HP_ACTION)
; #DIM HP_LOCATION
; #DIMS HP_ACTION
; #DIM HP_PERM_CHARA,10

; SELECTCASE HAVE_PERMS_LIST(HP_LOCATION,HP_ACTION,HP_PERM_CHARA)
; CASE -1
; 	DRAWLINE
; 	SELECTCASE HP_ACTION
; 	CASE "logging"
; 	PRINTFORML Logging here without permission feels like a bad idea.
;     PRINTFORML Might be best to get closer to the local boss.
; 	PRINTFORML Get Intimacy 5 with any of the following first:
; 	CASE "foraging"
; 	SELECTCASE CFLAG:MASTER:300
; 	CASE 438
; 		PRINTFORML Foraging here without permission feels extremely dangerous...
; 	CASE 855
; 		PRINTFORML The thought of foraging here without permission fills you with dread...
; 	CASEELSE
; 		PRINTFORML Foraging here without permission feels like a bad idea...
; 	ENDSELECT
;     PRINTFORML Might be best to get closer to the local boss.
; 	PRINTFORML Get Intimacy 5 or beat any of the following in combat first:
; 	CASE "street stall"
; 	PRINTFORML It's a bit difficult operating without permission...
;     PRINTFORML Might be best to get closer to the local boss.
; 	PRINTFORML Get Intimacy 5 with any of the following first:
;     ENDSELECT
;     IF !nSpoilerMode
;         CLEARLINE 1
;         RETURN -1
;     ENDIF
    
;     FOR LOCAL, 0, VARSIZE("HP_PERM_CHARA")
; 		SIF HP_PERM_CHARA:LOCAL < 0
; 			BREAK
; 		PRINTFORML ・%NAME:(HP_PERM_CHARA:LOCAL)%
; 	NEXT
; 	SIF YoujutsuPossible(MASTER,19)
; 		PRINTFORML Alternatively, use Common Sense Correction on any of the listed Touhous or Global Common Sense Correction with a strength of 51 or higher
; 	RETURN -1
; ENDSELECT


; RETURN 1


; @InitSavedTempStats()
; #DIMS nTableName
; nTableName '= "SavedTempStats"
; DT_CREATE nTableName
; DT_COLUMN_ADD nTableName, "type"
; DT_COLUMN_ADD nTableName, "slot", "int16"
; DT_COLUMN_ADD nTableName, "chara", "int16"
; DT_COLUMN_ADD nTableName, "integer", "int64"
; DT_COLUMN_ADD nTableName, "string", "int16"


; @NGSC_PENIS_ADD(ARG)
; #FUNCTION
; SIF !DT_SELECT(@"Hediff", @"chara = {ARG} and part = 68 and type > 100")
; 	CALLF AddBionic(ARG,68,TALENT:ARG:形状 ? 91+TALENT:ARG:形状 # 94,0)

; @NGSC_VAG_ADD(ARG)
; #FUNCTION
; SIF !DT_SELECT(@"Hediff", @"chara = {ARG} and part = 63 and type > 100")
; 	CALLF AddBionic(ARG,63,100,0)


; @BASE_BCS(ARG)
; #FUNCTION
; SELECTCASE ARG
; 	CASE 0
; 		RETURNF BARCOLORSET("緑")
; 	CASE 1
; 		RETURNF BARCOLORSET("青")
; 	CASE 2 
; 	CASE 3
; 	CASE 4 
; 		RETURNF PEECOLOR_C(0, 2)
; 	CASE 5
; 	CASE 6
; 		RETURNF BARCOLORSET("白")
; 	CASE 7
; 		RETURNF BARCOLORSET("オレンジ")
; 	CASE 8
; 		RETURNF BARCOLORSET("水色")
; 	CASE 9
; 	CASE 10
; 	CASE 11
; 	CASE 12
; 	CASE 13
; 	CASE 14
; 	CASE 15
; 	CASE 17
; 		RETURNF BARCOLORSET("JellyOrPoo")
; 	CASEELSE
; 		RETURNF ARG
; ENDSELECT 

; @ACCESSORY_EQUIPPED(ARG,ARG:1)
; #FUNCTION
; SIF EQUIP:ARG:19 == ARG:1 || EQUIP:ARG:20 == ARG:1 || EQUIP:ARG:21 == ARG:1
; 	RETURNF 1
; RETURNF 0

; @NAS_START_LOADING()
; #DIM nImageCount
; #DIMS nPick
; REDRAW 0
; CLEARLINE LINECOUNT+100
; REPEAT 150
; PRINTL
; REND
; CUSTOMDRAWLINE ─
; FONTBOLD
; IF benchMarkStart
; PRINTFORML  Benchmarking...
; ELSE
; PRINTFORML  Girls are waiting warmly...
; ENDIF
; FONTREGULAR
; CUSTOMDRAWLINE ─
; IF GETBIT(NASFeature,11)
; 	nImageCount = ENUMFILES("RESOURCES/OMOGATARI/Shitposts/")
; 	SETCOLOR C_RED
; 	PRINTFORML All pictures listed in the daily comics are fictitious and are not representations of reality.
; 	RESETCOLOR
; 	SETFONT "ＭＳ Ｐゴシック"
; 	FONTITALIC
; 	CUSTOMDRAWLINE ─
; 	nPick '= RESULTS:RAND(0,nImageCount)
; 	nPick '= SUBSTRING(nPick, 10)
; 	CALL EasyImage(@"nDailyMeme{RAND(__INT_MAX__)}",nPick,,1200,800,,1)
; 	CUSTOMDRAWLINE ─
; ENDIF
; NASLoadingBeforeTipLine = LINECOUNT
; CALL NAS_REDO_LOADINGSCREEN_END()


; @NAS_REDO_LOADINGSCREEN_END
; FONTREGULAR
; SETFONT
; IF benchMarkStart
; CALL BENCHMARK_CurInfo
; ELSE
; CALL TIPS_DISPLAY
; ENDIF
; RESETCOLOR
; CUSTOMDRAWLINE ─
; NASLoadingLine = LINECOUNT
; NASLoadingTime = GETMILLISECOND()


; @INIT_SCREEN_MESSAGE(ARGS)
; CALL ANIMATION_LOAD_NAS(1, 1, 1, ARGS)

; ;--------------------------------------------------
; ; Loading text
; ; Original from MeiQ
; ; This time it's not a faux though
; ;--------------------------------
; ;	nWaitCount - is the current loop position (we assume it's loop because this is where it's needed, right?)
; ;	nMinVal - starting value of a loop
; ;	nMaxVal - end value of a loop
; ;	strText - text to display
; ;--------------------------------------------------
; @ANIMATION_LOAD_NAS( nWaitCount, nMinVal = 0, nMaxVal, strText = "　Loading" )
; 	#DIMS strText
; 	#DIM nWaitCount

; 	#DIM nMinVal
; 	#DIM nMaxVal
; 	#DIM nPeriod
; 	#DIM nRedrawMem
; 	#DIM nColorMem
; 	CBGCLEAR

; 	nColorMem = GETCOLOR()
; 	nRedrawMem = CURRENTREDRAW()

; 	SIF LINEISEMPTY() == 0
; 		PRINTL

; 	REDRAW 0
; 	PRINTL
	
; 	nPeriod = (nWaitCount / 2) % 4
; 	IF GETMILLISECOND() - NASLoadingTime > (benchMarkStart ? 500 # 5000) 
; 	CLEARLINE LINECOUNT - NASLoadingBeforeTipLine
; 	ELSEIF NASLoadingLine
; 	CLEARLINE LINECOUNT - NASLoadingLine
; 	ELSE
; 	CLEARLINE 1
; 	ENDIF
; 	IF GETMILLISECOND() - NASLoadingTime > (benchMarkStart ? 500 # 5000) 
; 		CALL NAS_REDO_LOADINGSCREEN_END()
; 	ENDIF
; 	LOCAL = CALC_OSCILLATION_VALUE( 0x10 * nWaitCount, 0xFF - 0x44 )
; 	SETCOLOR 0x444444 + (0x010101 * LOCAL)
; 	;PRINTFORM %strText%%"."*nPeriod% {INVERSE_LERP(nMinVal, nMaxVal, nWaitCount)}％
; 	LOCALS =
; 	LOCALS += LAYER_RECTBAR(nWaitCount, nMaxVal, 16, 0x7070C0, 0x202050, , , 30)
; 	LOCALS += "[" + TOSTR(GETPERCENT(nWaitCount, nMaxVal, 1)) + "％]"
; 	LOCALS += " " + strText
; 	HTML_PRINT LOCALS

; 	REDRAW nRedrawMem
; 	SETCOLOR nColorMem
; 	;PRINTL 
; 	AWAIT
; 	CLEARLINE 1

; @NAS_LOAD_END
; CLEARLINE LINECOUNT+2
; VARSET NASLoadingLine
; STOPBGM
; PLAYSOUND @"se/ロード.m4a"

; @RESET_MOOD_BARS(ARG)
; #FUNCTION
; MAXBASE:ARG:Depression = 10000 
; MAXBASE:ARG:Terror = 10000 
; MAXBASE:ARG:Embarrassment = 10000 
; MAXBASE:ARG:Agony = MAX(10000,MAXBASE:ARG:0*5)

; @COMBAT_AGGRESSIVENESS(characterID)
; #FUNCTION
; #DIM characterID
; #DIM aggressiveness
; SELECTCASE (TALENT:characterID:87)
;   CASE -3
;     RETURNF 0;
;     ; dead calm
;   CASE 3
;     RETURNF 1000;
;     ; bloodlust
; ENDSELECT

; ;We will start calculating if talent 87 is not 3 or -3
; aggressiveness = 0;

; SELECTCASE (TALENT:characterID:10) 
;   CASE -1
;     aggressiveness += -20;
;     ; timid
;   CASE 1
;     aggressiveness += 20;
;     ; brave
; ENDSELECT
; SELECTCASE (TALENT:characterID:11) 
;   CASE -1
;     aggressiveness += -35;
;     ; docile
;   CASE 1
;     aggressiveness += 55;
;     ; defiant
; ENDSELECT
; SELECTCASE (TALENT:characterID:12) 
;   CASE -1
;     aggressiveness += -35;
;     ; calm
;   CASE 1
;     aggressiveness += 24;
;     ; cheeky
; ENDSELECT
; SELECTCASE (TALENT:characterID:13) 
;   CASE -1
;     aggressiveness += -60;
;     ; humble
;   CASE 1
;     aggressiveness += 40;
;     ; pride
; ENDSELECT
; SELECTCASE (TALENT:characterID:20) 
;   CASE 0
;     aggressiveness += 210;
;     ; normal
;   CASE 1
;     aggressiveness += 0;
;     ; self-control
; ENDSELECT
; SELECTCASE (TALENT:characterID:21) 
;   CASE -1
;     aggressiveness += -30;
;     ; empathic
;   CASE 1
;     aggressiveness += 30;
;   CASE 2
;     aggressiveness += 70;
;     ; psychopath
; ENDSELECT
; SELECTCASE (TALENT:characterID:40) 
;   CASE -1
;     aggressiveness += -30;
;     ; low pain tolerance
;   CASE 1
;     aggressiveness += 15;
;     ; tough
; ENDSELECT
; ; at this point the value of aggressiveness is equal to the value in the talent column in the excel file

; SELECTCASE (level_To_Rank(getCombatAbility(characterID)))
;   CASE 0
;     TIMES aggressiveness, 0;
;   CASE 1
;     TIMES aggressiveness, 1;
;   CASE 2
;     TIMES aggressiveness, 1.33;
;   CASE 3
;     TIMES aggressiveness, 1.58;
;   CASE 4
;     TIMES aggressiveness, 1.79;
;   CASE 5
;     TIMES aggressiveness, 1.96;
;   CASE 6
;     TIMES aggressiveness, 2.12;
;   CASE 7
;     TIMES aggressiveness, 2.19;
;   CASE 8
;     TIMES aggressiveness, 2.25;
;   CASE 9
;     TIMES aggressiveness, 2.3;
;   CASE 10
;     TIMES aggressiveness, 2.34;
; ENDSELECT
; aggressiveness = LIMIT(aggressiveness, 0, 900);
; ; at this point, aggressiveness is a value between 0 and 900 depend on talent and combatAbility

; ;Final step: map the value into the value range corresponding to talent 87
; SELECTCASE (TALENT:characterID:87)
;   CASE -2
;     RETURNF max(aggressiveness / 4 - 25, 0);
;     ; between -25 and 200, need to be limitted at 0
;   CASE -1
;     RETURNF aggressiveness * 2 / 3;
;     ; between 0 and 600
;   CASE 0
;     RETURNF aggressiveness + 50;
;     ; between 50 and 950
;   CASE 1
;     RETURNF aggressiveness * 2 / 3 + 400;
;     ; between 400 and 1000
;   CASE 2
;     RETURNF min(aggressiveness / 4 + 800, 1000);
;     ; between 800 and 1025, need to be limitted at 1000
; ENDSELECT

; @COMBAT_RESTRAINT(ARG)
; #FUNCTION
; RETURNF 500

; @COMBAT_BRAVERY(ARG)
; #FUNCTION
; #DIM BRAVERY = 300
; VARSET BRAVERY, 300

; SIF LEVEL_TO_RANK(GetCombatAbility(ARG)) == 0
; 	RETURNF 0
; ;Combat
; BRAVERY += (35*LEVEL_TO_RANK(GetCombatAbility(ARG)))


; ;Timid/Brave
; SELECTCASE TALENT:ARG:10
; CASE 1
; TIMES BRAVERY, 2.0
; CASE -1
; TIMES BRAVERY, 0.4
; ENDSELECT
; ;Calm/Cheeky
; SELECTCASE TALENT:ARG:12
; CASE 1
; TIMES BRAVERY, 1.3
; CASE -1
; TIMES BRAVERY, 1.3
; ENDSELECT
; ;Calm/Cheeky
; SELECTCASE TALENT:ARG:13
; CASE 1
; TIMES BRAVERY, 1.3
; CASE -1
; TIMES BRAVERY, 0.7
; ENDSELECT

; RETURNF LIMIT(BRAVERY,0,1000)

; @COMBAT_DESCRIPTION(ARG)
; CALL ResetYoujutsuResist(ARG)
; PRINTL
; CALL PRINTBUTTON_EX("Summary", 176, TFLAG:176, , , 1)
; ;description
; PRINTFORM %PARSE("You are",,,ARG)% a %COMBAT_DESCRIPTION_SUMMARY_TITLE(ARG)%. 
; IF ARG == MASTER
; 	CALL PRINT_STRL(@"Your @HEX@{AGGRESSIVENESS_COLOR(COMBAT_AGGRESSIVENESS(ARG))}@Aggression@, Restraint, and @HEX@{AGGRESSIVENESS_COLOR(COMBAT_BRAVERY(ARG))}@Bravery@ are destined by the Player.", , , , , , , , , , 1)
; 	GOTO Line2
; ENDIF

; ;aggression

; SELECTCASE COMBAT_AGGRESSIVENESS(ARG)
; CASE 1000
; 	SELECTCASE TALENT:ARG:Bloodlust
; 	CASE 3
; 		CALL PRINT_STR(@"%HIS_HER(ARG,1)% @HEX@0xFFCCFF@Bloodlust@ means that %HE_SHE(ARG)% is @HEX@{AGGRESSIVENESS_COLOR(COMBAT_AGGRESSIVENESS(ARG))}@Hyper Aggressive@", , , , , , , , , , 1)
; 	CASE 2
; 		CALL PRINT_STR(@"%HIS_HER(ARG,1)% @HEX@0xFFCCFF@Aggression@ means that %HE_SHE(ARG)% is @HEX@{AGGRESSIVENESS_COLOR(COMBAT_AGGRESSIVENESS(ARG))}@Hyper Aggressive@", , , , , , , , , , 1)
; 	CASE 1
; 		CALL PRINT_STR(@"%HIS_HER(ARG,1)% @HEX@0xFFCCFF@Over-Estimation@ means that %HE_SHE(ARG)% is @HEX@{AGGRESSIVENESS_COLOR(COMBAT_AGGRESSIVENESS(ARG))}@Hyper Aggressive@", , , , , , , , , , 1)
; 	CASEELSE
; 		CALL PRINT_STR(@"%HE_SHE(ARG,1)% is @HEX@{AGGRESSIVENESS_COLOR(COMBAT_AGGRESSIVENESS(ARG))}@Hyper Aggressive@ and will almost always cause a fight", , , , , , , , , , 1)
; 	ENDSELECT
; CASE 850 TO 999
; 	SELECTCASE TALENT:ARG:Bloodlust
; 	CASEELSE
; 		CALL PRINT_STR(@"%HE_SHE(ARG,1)% is @HEX@{AGGRESSIVENESS_COLOR(COMBAT_AGGRESSIVENESS(ARG))}@Very Aggressive@ and will very often initiate a fight", , , , , , , , , , 1)
; 	ENDSELECT
; CASE 666 TO 850
; 	SELECTCASE TALENT:ARG:Bloodlust
; 	CASEELSE
; 		CALL PRINT_STR(@"%HE_SHE(ARG,1)% is @HEX@{AGGRESSIVENESS_COLOR(COMBAT_AGGRESSIVENESS(ARG))}@Aggressive@ and will often initiate a fight", , , , , , , , , , 1)
; 	ENDSELECT
; CASE 400 TO 666
; 	SELECTCASE TALENT:ARG:Bloodlust
; 	CASEELSE
; 		CALL PRINT_STR(@"%HE_SHE(ARG,1)% is @HEX@{AGGRESSIVENESS_COLOR(COMBAT_AGGRESSIVENESS(ARG))}@Active@ and can cause a fight when the time is right", , , , , , , , , , 1)
; 	ENDSELECT
; CASE 333 TO 400
; 	SELECTCASE TALENT:ARG:Bloodlust
; 	CASEELSE
; 		CALL PRINT_STR(@"%HE_SHE(ARG,1)% is @HEX@{AGGRESSIVENESS_COLOR(COMBAT_AGGRESSIVENESS(ARG))}@Semi-Active@ and not very frequently will cause a fight", , , , , , , , , , 1)
; 	ENDSELECT
; CASE 175 TO 333
; 	SELECTCASE TALENT:ARG:Bloodlust
; 	CASEELSE
; 		CALL PRINT_STR(@"%HE_SHE(ARG,1)% is @HEX@{AGGRESSIVENESS_COLOR(COMBAT_AGGRESSIVENESS(ARG))}@Passive@ and will rarely cause a fight", , , , , , , , , , 1)
; 	ENDSELECT
; CASE 100 TO 175
; 	SELECTCASE TALENT:ARG:Bloodlust
; 	CASEELSE
; 		CALL PRINT_STR(@"%HE_SHE(ARG,1)% is @HEX@{AGGRESSIVENESS_COLOR(COMBAT_AGGRESSIVENESS(ARG))}@Very Passive@ and will very rarely cause a fight", , , , , , , , , , 1)
; 	ENDSELECT
; CASE 1 TO 99
; 	SELECTCASE TALENT:ARG:Bloodlust
; 	CASEELSE
; 		CALL PRINT_STR(@"%HE_SHE(ARG,1)% is @HEX@{AGGRESSIVENESS_COLOR(COMBAT_AGGRESSIVENESS(ARG))}@Extremely Passive@ and will almost never initiate a fight", , , , , , , , , , 1)
; 	ENDSELECT
; CASE 0
; 	SELECTCASE TALENT:ARG:Bloodlust
; 	CASE -3
; 		CALL PRINT_STR(@"%HE_SHE(ARG,1)% is @HEX@{AGGRESSIVENESS_COLOR(COMBAT_AGGRESSIVENESS(ARG))}@Dead Calm@ and will never initiate a fight", , , , , , , , , , 1)
; 	CASEELSE
; 		CALL PRINT_STR(@"%HE_SHE(ARG,1)% is @HEX@{AGGRESSIVENESS_COLOR(COMBAT_AGGRESSIVENESS(ARG))}@Nonviolent@ and will never initiate a fight", , , , , , , , , , 1)
; 	ENDSELECT
; ENDSELECT
; PRINTFORM , 
; SELECTCASE COMBAT_BRAVERY(ARG)
; CASE 1000
; 	SELECTCASE TALENT:ARG:Bloodlust
; 	CASE 3
; 		CALL PRINT_STR(@"%HIS_HER(ARG,1)% @HEX@0xFFCCFF@Bloodlust@ means that %HE_SHE(ARG)% is @HEX@{AGGRESSIVENESS_COLOR(COMBAT_AGGRESSIVENESS(ARG))}@Hyper Aggressive@", , , , , , , , , , 1)
; 	CASE 2
; 		CALL PRINT_STR(@"%HIS_HER(ARG,1)% @HEX@0xFFCCFF@Aggression@ means that %HE_SHE(ARG)% is @HEX@{AGGRESSIVENESS_COLOR(COMBAT_AGGRESSIVENESS(ARG))}@Hyper Aggressive@", , , , , , , , , , 1)
; 	CASE 1
; 		CALL PRINT_STR(@"%HIS_HER(ARG,1)% @HEX@0xFFCCFF@Over-Estimation@ means that %HE_SHE(ARG)% is @HEX@{AGGRESSIVENESS_COLOR(COMBAT_AGGRESSIVENESS(ARG))}@Hyper Aggressive@", , , , , , , , , , 1)
; 	CASEELSE
; 		CALL PRINT_STR(@"and when a fight happens, %HES_SHES(ARG)% @HEX@{AGGRESSIVENESS_COLOR(COMBAT_BRAVERY(ARG))}@Always@ in the battle", , , , , , , , , , 1)
; 	ENDSELECT
; CASE 850 TO 999
; 	SELECTCASE TALENT:ARG:Bloodlust
; 	CASEELSE
; 		CALL PRINT_STR(@"while also @HEX@{AGGRESSIVENESS_COLOR(COMBAT_AGGRESSIVENESS(ARG))}@Very Brave@ and will very often join a fight", , , , , , , , , , 1)
; 	ENDSELECT
; CASE 666 TO 850
; 	SELECTCASE TALENT:ARG:Bloodlust
; 	CASEELSE
; 		CALL PRINT_STR(@"while also @HEX@{AGGRESSIVENESS_COLOR(COMBAT_AGGRESSIVENESS(ARG))}@Brave@ and will often join a fight", , , , , , , , , , 1)
; 	ENDSELECT
; CASE 400 TO 666
; 	SELECTCASE TALENT:ARG:Bloodlust
; 	CASEELSE
; 		CALL PRINT_STR(@"while being @HEX@{AGGRESSIVENESS_COLOR(COMBAT_BRAVERY(ARG))}@Moderate@ when it comes to participating in fights", , , , , , , , , , 1)
; 	ENDSELECT
; CASE 333 TO 400
; 	SELECTCASE TALENT:ARG:Bloodlust
; 	CASEELSE
; 		CALL PRINT_STR(@"while being @HEX@{AGGRESSIVENESS_COLOR(COMBAT_AGGRESSIVENESS(ARG))}@Conservative@ and not very frequently will join an existing fight", , , , , , , , , , 1)
; 	ENDSELECT
; CASE 175 TO 333
; 	SELECTCASE TALENT:ARG:Bloodlust
; 	CASEELSE
; 		CALL PRINT_STR(@"while also @HEX@{AGGRESSIVENESS_COLOR(COMBAT_AGGRESSIVENESS(ARG))}@Hesitant@ and will rarely join a fight", , , , , , , , , , 1)
; 	ENDSELECT
; CASE 100 TO 175
; 	SELECTCASE TALENT:ARG:Bloodlust
; 	CASEELSE
; 		CALL PRINT_STR(@"while being @HEX@{AGGRESSIVENESS_COLOR(COMBAT_BRAVERY(ARG))}@Very Hesitant@ and will more often run away than joining.", , , , , , , , , , 1)
; 	ENDSELECT
; CASE 1 TO 99
; 	SELECTCASE TALENT:ARG:Bloodlust
; 	CASEELSE
; 		CALL PRINT_STR(@"while being @HEX@{AGGRESSIVENESS_COLOR(COMBAT_AGGRESSIVENESS(ARG))}@Extremely Hesitant@ and will very likely run away", , , , , , , , , , 1)
; 	ENDSELECT
; CASE 0
; 	CALL PRINT_STR(@"and when the bullets start flying, %HES_SHES(ARG)% @HEX@{AGGRESSIVENESS_COLOR(COMBAT_BRAVERY(ARG))}@one of the first ones@ running", , , , , , , , , , 1)
; ENDSELECT
; PRINTL .
; $Line2
; IF ARG != MASTER
; 	IF !GETBIT(TALENT:ARG:ESP,0)
; 		CALL PRINT_STR(@"%HE_SHE(ARG,1)% is @HEX@{C_ORANGE}@incapable@ of Danmaku and can only do Lethal Combat.", , , , , , , , , , 1)
; 		GOTO EndLine2
; 	ENDIF
; 	SELECTCASE TALENT:ARG:88
; 	CASE 3
; 		CALL PRINT_STR(@"%HE_SHE(ARG,1)% deticated to @HEX@{C_PINK}@Lethal Combat@ and will not accept any Danmaku battles.", , , , , , , , , , 1)
; 	CASE 0
; 		CALL PRINT_STR(@"%HE_SHE(ARG,1)% is @HEX@{C_GREEN}@Balanced@ between Danmaku and Lethal Combat.", , , , , , , , , , 1)
; 	CASE -3
; 		CALL PRINT_STR(@"%HE_SHE(ARG,1)% deticated to @HEX@{C_PINK}@Danmaku Battles@ and will not fight lethally unless %HIS_HER(ARG)% life depends on it.", , , , , , , , , , 1)
; 	ENDSELECT
; ENDIF
; $EndLine2
; PRINTL
; CALL PRINTBUTTON_EX("Stats", 176, TFLAG:176, , , 1)
; PRINTFORM Aggression: 
; CALL PRINT_STR(@"{COMBAT_AGGRESSIVENESS(ARG)/10, 3, RIGHT}.%TOSTR(COMBAT_AGGRESSIVENESS(ARG)%10,"0")%\% (@HEX@{AGGRESSIVENESS_COLOR(COMBAT_AGGRESSIVENESS(ARG))}@%COMBAT_AGGRESSIVENESS_LABEL(ARG)%@)", , , , , , , , , , 1)
; PRINTL
; PRINTFORM %"Bravery",10,LEFT%: 
; CALL PRINT_STR(@"{COMBAT_BRAVERY(ARG)/10, 3, RIGHT}.%TOSTR(COMBAT_BRAVERY(ARG)%10,"0")%\% (@HEX@{AGGRESSIVENESS_COLOR(COMBAT_BRAVERY(ARG))}@%COMBAT_BRAVERY_LABEL(ARG)%@)", , , , , , , , , , 1)

; PRINTL
; PRINTFORM Restraint: 

; PRINTL

; IF (TALENT:ARG:ESP > 1 || TALENT:ARG:ESP == -1 || TALENT:ARG:ESP <= 9000000000000000000) && !TALENT:ARG:NonSentient
; 	CALL PRINT_MAGIC_MOD(ARG)
; 	PRINTL
; 	CALL CombatMagicDisplay(ARG,2)
; ENDIF
; CALL PRINT_DAMAGE_RESIST(ARG)
; IF GETBIT(TALENT:ARG:ESP,0)
; 	CALL PRINTLINE, "Spell Cards"
; 	PRINTL 
; 	CALL SpellCardList(ARG)
; ENDIF

; @COMBAT_AGGRESSIVENESS_LABEL(ARG)
; #FUNCTIONS
; ;aggression

; SELECTCASE COMBAT_AGGRESSIVENESS(ARG)
; CASE 1000
; 	RETURNF "Hyper Aggressive"
; CASE 850 TO 999
; 	RETURNF "Very Aggressive"
; CASE 666 TO 850
; 	RETURNF "Aggressive"
; CASE 400 TO 666
; 	RETURNF "Active"
; CASE 333 TO 400
; 	RETURNF "Semi-Active"
; CASE 175 TO 333
; 	RETURNF "Passive"
; CASE 100 TO 175
; 	RETURNF "Very Passive"
; CASE 1 TO 99
; 	RETURNF "Extremely Passive"
; CASE 0
; 	RETURNF "Nonviolent"
; ENDSELECT

; @COMBAT_BRAVERY_LABEL(ARG)
; #FUNCTIONS
; ;aggression

; SELECTCASE COMBAT_BRAVERY(ARG)
; CASE 1000
; 	RETURNF "Tenatious"
; CASE 850 TO 999
; 	RETURNF "Very Brave"
; CASE 666 TO 850
; 	RETURNF "Brave"
; CASE 400 TO 666
; 	RETURNF "Moderate"
; CASE 333 TO 400
; 	RETURNF "Conservative"
; CASE 175 TO 333
; 	RETURNF "Hesitant"
; CASE 100 TO 175
; 	RETURNF "Very Hesitant"
; CASE 1 TO 99
; 	RETURNF "Extremely Hesitant"
; CASE 0
; 	RETURNF "Coward"
; ENDSELECT

; @COMBAT_DESCRIPTION_SUMMARY_TITLE(ARG)
; #FUNCTIONS
; #DIM COMBAT_LEVELS
; #DIM FAVE_WEAP
; COMBAT_LEVELS = MAX(ABL:ARG:42,ABL:ARG:66,ABL:ARG:67)
; FAVE_WEAP = EQUIP:ARG:Weapon
; ;combat rankings
; SIF !COMBAT_LEVELS
; 	RETURNF "Pacifist"

; IF COMBAT_LEVELS == ABL:ARG:42 && COMBAT_LEVELS == ABL:ARG:66 && COMBAT_LEVELS == ABL:ARG:67
; 	IF COMBAT_LEVELS == MaxNonHLevel
; 		RETURNF "Master of All Arts"
; 	ELSE
; 		RETURNF "All-Rounder"
; 	ENDIF
; ELSEIF COMBAT_LEVELS == ABL:ARG:42
; RETURNF "Danmakujin"
; ELSEIF COMBAT_LEVELS == ABL:ARG:66
; 	RETURNF "Ranger"
; ELSEIF COMBAT_LEVELS == ABL:ARG:67
; RETURNF "Warrior"
; ENDIF

; @InitCombatStatTable()
; #DIMS nTableName
; nTableName '= "CombatStatTable"
; DT_CREATE nTableName
; DT_COLUMN_ADD nTableName, "type"
; DT_COLUMN_ADD nTableName, "weapon", "int16"
; DT_COLUMN_ADD nTableName, "chara", "int16"
; DT_COLUMN_ADD nTableName, "uses", "int64"
; DT_COLUMN_ADD nTableName, "kills", "int64"

; @AGGRESSIVENESS_COLOR(ARG)
; #FUNCTION
; SELECTCASE ARG
; CASE IS <= 333
; 	RETURNF Color_Gradient_PER(C_AQUA,C_GREEN,MIN((ARG*100)/(333),100))
; CASE 333 TO 666
; 	RETURNF Color_Gradient_PER(C_GREEN,C_ORANGE,MIN(((ARG-333)*100)/(666-333),100))
; CASE IS >= 666
; 	RETURNF Color_Gradient_PER(C_ORANGE,C_D_RED,MIN(((ARG-666)*100)/(1000-666),100))
; ENDSELECT

; ; "Combat Purist"
; ; "Warrior"


; ;Mizuchi is a Nightstalker. Her Bloodlust means that she is Hyper Aggressive, while her Opportunism makes her Brave when it comes to combat.
; ;Her favorite weapon is Danmaku. Her favorite spell is Hijack. She is balanced between Danmaku and Lethal Combat.

; ;Shinki is an Excreta Staller. She is Dead Calm and will never initiate a fight, while being Average when it comes to joining fights.
; ;Her favorite weapon is the Gensou-chan TanSAM. Her favorite spell is Mecoprodyne. She is deticated to Lethal Combat and will not accept any Danmaku battles.

; ;Yumemi is a Rifleman. She is Passive and will rarely cause a fight, while being Average when it comes to joining fights.
; ;Her favorite weapon is the Heckler & Koch G3A3A1. Her favorite spell is The World. She is deticated to Lethal Combat and will not accept any Danmaku battles.

; ;Cirno is a Danmakujin. She is Aggressive and will often cause a fight, while her Tenacity means she will never miss and opportunity to join a battle.
; ;Her favorite weapon is Danmaku. Her favorite spell is Bufu. She prefers to start Danmaku battles.

; ;Shion is a Pacifist. She is Extremely Passive and will almost never initiate a fight, while being Very Conservative when it comes to joining a fight.
; ;Her favorite weapon is Danmaku. She is balanced between Danmaku and Lethal Combat.


; @STRAIGHT_BAR(nLength,nColor,nSymbol="━")
; #DIM nPrevColor
; #DIM nLength
; #DIM nColor
; #DIMS DYNAMIC nSymbol

; ; nLength = MIN(nLength,(MAXWIDTH()-HTML_STRINGLEN(HTML_POPPRINTINGSTR()))/2)
; ; SIF !nLength
; ; 	RETURN

; nPrevColor = GETCOLOR()
; SETCOLOR nColor
; PRINTFORM %nSymbol*nLength%
; SETCOLOR nPrevColor

; @SetWindowTitle
; IF nPublicMode
; 	WINDOW_TITLE = Emuera
; ELSE
; 	SELECTCASE ViewingTitlePage
; 	CASE 0
; 	WINDOW_TITLE = %NASTitleSTR()% %NASVersionName()%
; 	CASE 1
; 	WINDOW_TITLE = eraNAS: Legend of Gensokyo %NASVersionName()%
; 	ENDSELECT
; ENDIF
; SIF nSJW
; 	WINDOW_TITLE += @" (State Compliance: %StateComplienceMode()%)"


; @MAP_LETTER(ARGS, ML_LENGTH = -1)
; #FUNCTIONS
; #DIMS DYNAMIC ML_BUILD
; #DIM DYNAMIC ML_LENGTH
; VARSET ML_BUILD

; IF ML_LENGTH == -1
; 	ML_LENGTH = STRLENS(ARGS)
; ENDIF

; FOR LOCAL,0,ML_LENGTH
; 	IF STRLENS(SUBSTRING(ARGS,LOCAL,1))
; 	ML_BUILD += @"%SUBSTRING(ARGS,LOCAL,1)%​"
; 	ELSE
; 	ML_BUILD += @" ​"
; 	ENDIF
; NEXT
; RETURNF ML_BUILD

; @VALIDATE_CHARA_SINGLE(ARG)
; SIF ARG >= CHARANUM
; 	RETURN
; ;vehicles 
; IF CFLAG:ARG:BeingControledBy == 0 && CFLAG:ARG:ControlingVehicle == 0 && !TALENT:0:Vehicle
; 	;slot 0 is not a vehicle.
; 	CFLAG:ARG:BeingControledBy = -1
; 	CFLAG:ARG:ControlingVehicle = -1
; 	CFLAG:ARG:InVehicle = -1
; ENDIF	

; ;whereabouts sense
; ;TALENT:ARG:居場所察知 = 1
; ;undisable player
; SIF ARG == MASTER && CFLAG:ARG:出禁
; 	CFLAG:ARG:出禁 = 0

; ;panties
; CALL PANTY_REWORK_PANTY_TRANSFER(ARG)
; ;preferences
; CALLF MAKE_PANTY_PREFERENCE(ARG)
; ;moods
; CALLF RESET_MOOD_BARS(ARG)
; ;capacity
; CALL CrippleEffects(ARG)
; CALL ResetYoujutsuResist(ARG)


; IF nPee
; 	IF (PeeHold:ARG:0 > nPeeMaxTrain && PeeHold:ARG:0 < 6) || PeeHold:ARG:0 < nPeeMinTrain
; 		IF PeeHold:ARG:0 > nPeeMaxTrain
; 				CALL COLORMESSAGE(@"Resetting %CALLNAME:ARG% pee holding from {PeeHold:ARG:0}【%GET_TALENTNAME_TR(1514, PeeHold:ARG:0)%】, to {nPeeMaxTrain}【%GET_TALENTNAME_TR(1514, nPeeMaxTrain)%】...",C_YELLOW,1,1)		
; 				PeeHold:ARG:0 = nPeeMaxTrain
; 		ELSEIF PeeHold:ARG:0 < nPeeMinTrain
; 				CALL COLORMESSAGE(@"Resetting %CALLNAME:ARG% pee holding from {PeeHold:ARG:0}【%GET_TALENTNAME_TR(1514, PeeHold:ARG:0)%】, to {nPeeMinTrain}【%GET_TALENTNAME_TR(1514, nPeeMinTrain)%】...",C_YELLOW,1,1)		
; 				PeeHold:ARG:0 = nPeeMinTrain
; 		ENDIF
; 			PeeHoldExp:ARG:0 = EXP_DEMAND_20(0,91,ARG)
; 			CALLF SILENT_ENDURANCECHANGE(ARG)
; 	ENDIF
; 	CALLF ResetBladders(ARG)
; ENDIF

; IF nScat
; 	IF (PooHold:ARG:0 > nScatMaxTrain && PooHold:ARG:0 < 6) || PooHold:ARG:0 < nScatMinTrain
; 		IF PooHold:ARG:0 > nScatMaxTrain
; 				CALL COLORMESSAGE(@"Resetting %CALLNAME:ARG% poo holding from {PooHold:ARG:0}【%GET_TALENTNAME_TR(1500, PooHold:ARG:0)%】, to {nScatMaxTrain}【%GET_TALENTNAME_TR(1500, nScatMaxTrain)%】...",C_YELLOW,1,1)		
; 				PooHold:ARG:0 = nScatMaxTrain
; 		ELSEIF PooHold:ARG:0 < nScatMinTrain
; 				CALL COLORMESSAGE(@"Resetting %CALLNAME:ARG% poo holding from {PooHold:ARG:0}【%GET_TALENTNAME_TR(1500, PooHold:ARG:0)%】, to {nScatMinTrain}【%GET_TALENTNAME_TR(1500, nScatMinTrain)%】...",C_YELLOW,1,1)		
; 				PooHold:ARG:0 = nScatMinTrain
; 		ENDIF
; 			PooHoldExp:ARG:0 = EXP_DEMAND_21(0,92,ARG)
; 			CALLF SILENT_ENDURANCECHANGE(ARG)
; 	ENDIF
; 	CALLF ResetBladders(ARG)
; ENDIF

; ;combined diaper use
; Qol_Info_Count_Array:ARG:Qol_Count_TotalDiaperUse = Qol_Info_Count_Array:ARG:Qol_Count_DiapeWetting + Qol_Info_Count_Array:ARG:Qol_Count_DiapeMessing

; WHILE LOCAL < 300
; 	CALL BANNED_TALENT_CHECK(LOCAL)
; 	CALL BANNED_TALENT_CHECK(LOCAL+1)
; 	CALL BANNED_TALENT_CHECK(LOCAL+2)
; 	CALL BANNED_TALENT_CHECK(LOCAL+3)
; 	CALL BANNED_TALENT_CHECK(LOCAL+4)
; 	CALL BANNED_TALENT_CHECK(LOCAL+5)
; 	CALL BANNED_TALENT_CHECK(LOCAL+6)
; 	CALL BANNED_TALENT_CHECK(LOCAL+7)
; 	CALL BANNED_TALENT_CHECK(LOCAL+8)
; 	CALL BANNED_TALENT_CHECK(LOCAL+9)
; 	LOCAL += 10
; WEND

; ;trojan soul
; IF HasBionicPart(MASTER,82)
; 	SIF !TALENT:ARG:3
; 		TALENT:ARG:3 = 6
; ELSE
; 	SIF TALENT:ARG:3 == 6
; 		TALENT:ARG:3 = 0
; ENDIF

; IF TALENT:ARG:144
; 	TALENT:ARG:SexKnow = 5
; 	TALENT:ARG:144 = 0
; ELSEIF TALENT:ARG:27
; 	TALENT:ARG:SexKnow = -1
; 	TALENT:ARG:27 = 0
; ENDIF


; CALLF RevertLevels(ARG)

; IF TALENT:MASTER:行きずり
; 	CFLAG:MASTER:出禁 = 0
; 	TALENT:MASTER:行きずり = 0
; 	CALL COLORMESSAGE(@"Removing【Mob Character】trait from %CALLNAME:ARG% for the become-character system to work...",C_YELLOW,1,1)		
; ENDIF

; ;transition to decentralized genital system
; IF !CFLAG:ARG:3865
; 	CALL COLORMESSAGE(@"Converting %CALLNAME:ARG% to the new gender system...",C_YELLOW,1,1)
; 	CALL newGenderSystemConvert(ARG)
; ENDIF
; CFLAG:ARG:3865 = 1

; IF CFLAG:ARG:3866 != 2
; 	CALL COLORMESSAGE(@"Fixing incorrect bladder properties for %CALLNAME:ARG%...",C_YELLOW,1,1)
; 	CALL bladderTraitToPart(ARG)
; ENDIF
; CFLAG:ARG:3866 = 2
; ;esper and TSP fix
; IF MAXBASE:ARG:7 <= 0 && TALENT:ARG:ESP
; 	CALL COLORMESSAGE(@"Fixing incorrect max ESP properties for %CALLNAME:ARG%...",C_YELLOW,1,1)
; 	SIF MAXBASE:ARG:7 <= 0
; 		MAXBASE:ARG:7 = 100
; 	BASE:ARG:7 = MAXBASE:ARG:7
; ENDIF
; ; IF SaveIsEZB && EZB_ELO:ARG:0 <= 0
; ; 	CALL COLORMESSAGE(@"Fixing incorrect EasyBattle Elo for %CALLNAME:ARG%...",C_YELLOW,1,1)
; ; 	CALLF EZB_INIT_CHARA_LEAGUE(ARG)
; ; ENDIF


; SIF ARG != CSV_CHARANUM()
; CALL PlaceholderCharaImages(ARG)

; @BANNED_TALENT_CHECK(ARG,BTC_TALENT)
; #DIM BTC_TALENT
; IF TraitDisabled:(BTC_TALENT)
; 	SIF TALENT:ARG:(BTC_TALENT)
; 	CALL COLORMESSAGE(@"Removing【%GET_TALENTNAME_TR(BTC_TALENT,TALENT:ARG:(BTC_TALENT),ARG)%】from %CALLNAME:ARG% due to it being a banned trait...",C_YELLOW,1,1)		
; 	TALENT:ARG:(BTC_TALENT) = 0
; ENDIF

; @SI_PREFIX(ARG,ARG:1)
; #FUNCTIONS
; SELECTCASE ARG
; CASE 18
; 	SELECTCASE ARG:1
; 	CASE 0
; 		RETURNF "exa"
; 	CASE 1
; 		RETURNF "E"
; 	ENDSELECT
; CASE 15
; 	SELECTCASE ARG:1
; 	CASE 0
; 		RETURNF "peta"
; 	CASE 1
; 		RETURNF "P"
; 	ENDSELECT
; CASE 12
; 	SELECTCASE ARG:1
; 	CASE 0
; 		RETURNF "tera"
; 	CASE 1
; 		RETURNF "T"
; 	ENDSELECT
; CASE 9
; 	SELECTCASE ARG:1
; 	CASE 0
; 		RETURNF "giga"
; 	CASE 1
; 		RETURNF "G"
; 	ENDSELECT
; CASE 6
; 	SELECTCASE ARG:1
; 	CASE 0
; 		RETURNF "mega"
; 	CASE 1
; 		RETURNF "M"
; 	ENDSELECT
; CASE 3
; 	SELECTCASE ARG:1
; 	CASE 0
; 		RETURNF "kilo"
; 	CASE 1
; 		RETURNF "k"
; 	ENDSELECT
; CASE 0
; 	RETURNF ""
; CASE -3
; 	SELECTCASE ARG:1
; 	CASE 0
; 		RETURNF "milli"
; 	CASE 1
; 		RETURNF "m"
; 	ENDSELECT
; CASE -6
; 	SELECTCASE ARG:1
; 	CASE 0
; 		RETURNF "micro"
; 	CASE 1
; 		RETURNF "μ"
; 	ENDSELECT
; CASE -9
; 	SELECTCASE ARG:1
; 	CASE 0
; 		RETURNF "nano"
; 	CASE 1
; 		RETURNF "n"
; 	ENDSELECT
; ENDSELECT



; @ENIFY_STRINGS(ARGS,ARGS:1)
; #FUNCTIONS
; #DIMS DYNAMIC ES_LANGUAGE = "eng"

; ES_LANGUAGE '= AL_DETECT_LANGUAGE()

; SELECTCASE ARGS
; CASE "tempVar.VariableEmpty"
;     SELECTCASE ES_LANGUAGE
;     CASE "eng"
;         RETURNF @"Variable name cannot be empty"
;     ENDSELECT
; CASE "tempVar.Uninitialized"
;     SELECTCASE ES_LANGUAGE
;     CASE "eng"
;         RETURNF @"Variable name \"%ARGS:1%\" has not been initialized"
; 	CASE "ja"
; 		RETURNF @"未設定の変数です%ARGS:1%"
;     ENDSELECT
; CASE "tempVar.OutsideRange"
;     SELECTCASE ES_LANGUAGE
;     CASE "eng"
;         RETURNF @"%ARGS:1% is outside allowed range for temporary variables ({OBJ_ID_FIRST} to {OBJ_ID_LAST})"
; 	CASE "ja"
; 		RETURNF @"配列の範囲外です%ARGS:1%"
;     ENDSELECT
; CASE "tempVar.Duplicate"
;     SELECTCASE ES_LANGUAGE
;     CASE "eng"
;         RETURNF @"A variable with the name \"%ARGS:1%\" has already been set"
; 	CASE "ja"
; 		RETURNF @"すでに設定済みの変数です%ARGS:1%"
;     ENDSELECT
; CASE "tempVar.HitClassLimit"
;     SELECTCASE ES_LANGUAGE
;     CASE "eng"
;         RETURNF @"Cannot create any more classes (limit: %ARGS:1%)"
; 	CASE "ja"
; 		RETURNF @"保持変数が上限に達しています"
;     ENDSELECT
; ENDSELECT

; RETURNF ARGS

; @CanMelingFuckOff()
; #FUNCTION
; ; SIF CFLAG:58:面識
; ; 	RETURNF 1
; ;Intimacy 5
; SIF SDMUnlockCharacterCheck()
; 	RETURNF 1
; ;Dating
; SIF GROUPMATCH(FLAG:デート相手, 58, 15, 50, 16, 59)
; 	RETURNF 1
; ;Leading Around
; SIF CFLAG:58:同行 || CFLAG:15:同行 || CFLAG:50:同行 || CFLAG:16:同行 || CFLAG:59:同行
; 	RETURNF 1
; ;Meiling is unconscious or dead
; SIF !SHIRAHU(58)
; 	RETURNF 1
; ;banquet
; SIF ADD_BANQUET_ACTIVE(20) || ADD_BANQUET_ACTIVE(6)
; 	RETURNF 1
; ;temporary pass
; SIF TFLAG:SDMTimedAllow
; 	RETURNF 1
; ;permenment pass
; RETURNF sdmIndoorUnlocked

; @sdmIndoorUnlockNotify(reason)
; #DIMS reason
; ;, you can now access Makai via a portal.
; SELECTCASE reason
; CASE "bluff"
;     PRINTFORML The gatekeeper relents, and allows you access to the mansion.
; CASE "intimacy"
;     PRINTFORML After befriending %CALLNAME:SDMUnlockCharacterCheck()%, %HE_SHE(SDMUnlockCharacterCheck())% convinces the gatekeeper to let you in.
; ENDSELECT
; PRINTFORMW You now have full access to the [%GET_MAPNAME(3)%].

; sdmIndoorUnlocked = 1

; @SDMUnlockCharacterCheck
; #FUNCTION
; FOR LOCAL,0,5
;     SELECTCASE LOCAL
;     CASE 0
;     LOCAL:1 = 15
;     CASE 1
;     LOCAL:1 = 16
;     CASE 2
;     LOCAL:1 = 50
;     CASE 3
;     LOCAL:1 = 58
;     CASE 4
;     LOCAL:1 = 59
;     ENDSELECT
;     SIF ABL:(LOCAL:1):9 >= 5
;         RETURNF LOCAL:1
; NEXT

; @RequesterInArea(nArea)
; #FUNCTION
; #DIM DYNAMIC nArea
; #DIM DYNAMIC nChara
; nChara = -1
; FOR LOCAL:1, 0, VARSIZE("IRAI_SLOT")
; 	;no character
; 	SIF !IRAI_SLOT:(LOCAL:1)
; 		CONTINUE

; 	;passed or failed
; 	IF GROUPMATCH(CFLAG:(IRAI_SLOT_TO_CLIENT(LOCAL:1)):依頼状況,3,4,5,6)
; 		nChara = IRAI_SLOT_TO_CLIENT(LOCAL:1)
; 		IF Get_MapID(CFLAG:nChara:300) == nArea
; 			RETURNF nChara
; 		ENDIF
; 		nChara = -1
; 	ENDIF
; 	$TargetCheck
; 	;get character


; 	nChara = IRAI_SLOT_TO_PERSON(LOCAL:1)
; 	SIF nChara <= 0
; 		nChara = IRAI_SLOT_TO_CLIENT(LOCAL:1)
; 	IF Get_MapID(CFLAG:nChara:300) == nArea
; 		RETURNF nChara
; 	ENDIF
; NEXT
; RETURNF -1

; @NAS_UnlockNotify
; ;Makai
; IF !makaiPortalUnlocked
; 	;Knowledge A or higher
; 	IF ABL:MASTER:43 >= UniversalRank("A")
; 		CALL MakaiPortalUnlockNotify("knowledge")
; 	;Intimacy 5 or higher with a Makai person
; 	ELSEIF MakaiUnlockCharacterCheck()
; 		CALL MakaiPortalUnlockNotify("intimacy")
; 	ENDIF
; ENDIF

; ;SDM

; ;LoG


; @NAS_TimerActs
; #DIM TimePassed
; TimePassed = TIME_PROGRESS(TIME:1)
; IF K102_PunishPottyTimeLeft
; 	K102_PunishPottyTimeLeft -= TimePassed
; 	K102_PunishCheckPlayer += TimePassed
; 	K102_PunishCheckPity += TimePassed
; 	;elapsed
; 	IF K102_PunishPottyTimeLeft <= 0
; 		CALL K102_Punishment_PottyBondage_DiaperCheck(1)
; 		K102_PunishPottyTimeLeft = 0
; 		K102_PunishCheckPlayer = 0
; 		K102_PunishCheckPity = 0
; 	ENDIF
; 	;pity
; 	IF K102_PunishCheckPity >= 90
; 		CALL K102_Punishment_PottyBondage_DiaperCheck
; 		K102_PunishCheckPlayer = 0
; 		K102_PunishCheckPity = 0
; 	ENDIF
; 	;check
; 	IF K102_PunishCheckPlayer >= 30
; 		SIF RAND(100) <= 15
; 			CALL K102_Punishment_PottyBondage_DiaperCheck
; 		K102_PunishCheckPlayer = 0
; 	ENDIF
; ENDIF


; ;toEquip - Whether to equip the item or not (0: Unequip, 1: Equip, 2: Force Equip (will take slot 3))
; @AddAccessory(ARG,AccessoryID,toEquip=1)
; #FUNCTION
; #DIM DYNAMIC AccessoryID
; #DIM DYNAMIC toEquip
; #DIM DYNAMIC AccessorySlot
; #DIM DYNAMIC RepeatInt

; ;check accessory slot
; FOR RepeatInt,19,22
; 	IF (toEquip && !EQUIP:ARG:RepeatInt) || (!toEquip && EQUIP:ARG:RepeatInt == AccessoryID)
; 		AccessorySlot = RepeatInt
; 		BREAK
; 	ENDIF
; NEXT

; IF !AccessorySlot
; 	;could not find a slot
; 	IF toEquip == 2
; 		;force
; 		DEBUGPRINTFORML Attempted to add {AccessoryID} %undies_name_with_brand(ARG,AccessoryID,1,19)% to %CALLNAME:ARG% but could not find a free slot!
; 		DEBUGPRINTFORML Forcing slot 21.
; 		AccessorySlot = 21
; 	ELSEIF toEquip
; 		DEBUGPRINTFORML Attempted to add {AccessoryID} %undies_name_with_brand(ARG,AccessoryID,1,19)% to %CALLNAME:ARG% but could not find a free slot!
; 		RETURNF -1
; 	ELSE
; 		DEBUGPRINTFORML Could not find {AccessoryID} %undies_name_with_brand(ARG,AccessoryID,1,19)% on %CALLNAME:ARG%!
; 		RETURNF -1
; 	ENDIF
; ENDIF

; IF toEquip
; 	CFLAG:ARG:(200+AccessorySlot) = AccessoryID
; 	CFLAG:ARG:(240+AccessorySlot) = AccessoryID
; 	EQUIP:ARG:AccessorySlot = AccessoryID
; 	DEBUGPRINTFORML Changed %CALLNAME:ARG% accessory：{AccessoryID} %undies_name_with_brand(ARG,AccessoryID,1,19)% (slot {AccessorySlot})
; ELSE
; 	CFLAG:ARG:(200+AccessorySlot) = 0
; 	CFLAG:ARG:(240+AccessorySlot) = 0
; 	EQUIP:ARG:AccessorySlot = 0
; 	DEBUGPRINTFORML Removed %CALLNAME:ARG% accessory (slot {AccessorySlot})
; ENDIF
; RETURNF 1

; @BITE_THE_DUST_CLEAR_NAS_SHIT


; ;replacement functions for the jank coded system
; @NAS_HARVEST_GET(ARG)
; #FUNCTION
; #DIM DYNAMIC HarvestItem
; SELECTCASE ARG
; CASE 151 TO 183
; 	HarvestItem = ARG + 200
; CASE 190
; 	HarvestItem = 0
; CASE 1130
; 	HarvestItem = 624
; CASEELSE
; 	HarvestItem = ARG
; ENDSELECT
; RETURNF HarvestItem


; ;==================================================================================================================================================================================================================================================================================================
; ;NAS_IS_SEED
; ;----------------------------------------------------------
; ;Description
; ;----------------------------------------------------------
; ;Replacement for fuctions that use "の苗" to check for the seed name
; ;This also allows an explicit ID whitelist.
; ;==================================================================================================================================================================================================================================================================================================
; @NAS_IS_SEED(ARG)
; #FUNCTION
; SELECTCASE ARG
; CASE 151 TO 183, 190
; 	;vanilla items
; 	SIF STRLENS(ITEMNAME:ARG)
; 		RETURNF 1
; CASE 1130
; 	RETURNF 1
; CASEELSE
; 	RETURNF STRCOUNT(ITEMNAME:ARG, "の苗") > 0
; ENDSELECT


; ;----------------------------------------------------
; ;Replacement for HAS_PENIS that respects eraNAS' bionics
; ;----------------------------------------------------
; @HAS_PENIS_NAS(ARG = -1)
; #FUNCTION
; ;NAS custom code
; ;don't assume master is ID 0
; SIF ARG == -1
; 	ARG = MASTER

; ;NAS bionic custom code
; SIF IsPartCrippled(ARG,68)
; 	RETURNF 0

; RETURNF GETBIT(HealthFlags:ARG:0,HealthFlags_HasPenis)



; @NAS_Error_Show(ARGS,ARGS:1,COL_ID=C_RED,ResponseType=0)
; #DIM DYNAMIC COL_ID
; #DIM DYNAMIC ResponseType
; SETCOLOR COL_ID
; PRINTL
; PRINTFORML %"-"*89%
; PRINTFORML %ARGS%
; SIF STRLENS(ARGS:1)	
; PRINTFORML %ARGS:1%
; PRINTFORML !REPORT THIS!
; PRINTFORML %"-"*89%
; RESETCOLOR
; SELECTCASE ResponseType
; CASE 1
; PRINTW
; CASE 2
; FORCEWAIT
; CASE 3
; THROW
; ENDSELECT

; ; Oh boy, a link to a function that doesn't FUCKING EXIST
; ; - Mr Pops Alot
; @NOBYNAME(ARGS, isCritical = 0)
; #FUNCTION
; #DIM C_ID
; #DIM DYNAMIC isCritical
; ARGS '= Capitalize(ARGS)
; ;use findchara
; C_ID = FINDCHARA(CALLNAME, @"%ARGS%" , 1)
; SIF C_ID == -1
; 	C_ID = FINDCHARA(Name, @"%ARGS%" , 1)
; SIF C_ID > -1
; 	RETURNF C_ID

; ;else go to loop hell
; FOR LOCAL,0,CHARANUM
; 	SIF nameArray:LOCAL:na_Callname == ARGS || nameArray:LOCAL:na_Name == ARGS || nameArray:LOCAL:na_FirstName == ARGS || nameArray:LOCAL:na_LastName == ARGS
; 		C_ID = LOCAL
; 	SIF CSVCALLNAME(NO:LOCAL) == ARGS || CSVNAME(NO:LOCAL) == ARGS
; 		C_ID = LOCAL
; NEXT
; SIF C_ID == -1 && isCritical
; 	THROW Unknown Character "%ARGS%"
; RETURNF C_ID


; ;nas customs

; @ADD_LewdFoodAdd_Process3(DISH_ASSI)
; #DIM CAN_LEWD, 10
; #DIM SELECT_LEWD
; VARSET CAN_LEWD
; ;check
; SIF HAS_PENIS(DISH_ASSI) && BASE:DISH_ASSI:精力 >= 150
; 	CAN_LEWD:2 = 1
; SIF HAS_VAGINA(DISH_ASSI)
; 	CAN_LEWD:3 = 1
; SIF TALENT:DISH_ASSI:母乳体質 && BASE:DISH_ASSI:母乳 >= 150
; 	CAN_LEWD:4 = 1

; SIF !CAN_LEWD:2 && !CAN_LEWD:3 && !CAN_LEWD:4
; 	RETURN -1

; SIF DISH_ASSI == MASTER
; 	RETURN -1

; PRINTFORML %CALLNAME:DISH_ASSI% wants to add something lewd to the dish. Let them do it?
; CALL ASK_M("Let them add Semen",CAN_LEWD:2,"Let them add Pussy Juice",CAN_LEWD:3,"Let them add Breast Milk",CAN_LEWD:4,"Let them add whatever",(CAN_LEWD:2 || CAN_LEWD:3 || CAN_LEWD:4),"Don't let them add anything",1)
; ;re-set the flag
; SELECTCASE RESULT
; CASE 4
; 	RETURN -1
; CASE 3
; 	$RandomLoop
; 	LOCAL = RAND(2,4)
; 	SIF !CAN_LEWD:LOCAL
; 	GOTO RandomLoop
	
; 	DISH_LEWD = LOCAL
; 	SELECT_LEWD = LOCAL
; CASEELSE
; 	DISH_LEWD = (RESULT + 2)
; 	SELECT_LEWD = (RESULT + 2)
; ENDSELECT


; SIF SELECT_LEWD < 2
; 	RETURN
; SIF DISH_NAME == ""
; 	RETURN
	
; LOCALS = freshly made
; SIF STRCOUNT(DISH_TASTE, "劣化") == 1
; 	LOCALS = stale
; SIF STRCOUNT(DISH_TASTE, "劣化") >= 2
; 	LOCALS = rotting
; SELECTCASE DISH_LEWD
; 	CASE 2
; 		PRINTFORML Revealing %HIS_HER(DISH_ASSI)% %TINKO(DISH_ASSI)%, %CALLNAME:DISH_ASSI% quickly strokes it towards the %LOCALS% %DISHNAME_TR(DISH_NAME)%.
; 		PRINTFORML As %HE_SHE(DISH_ASSI)% climaxes, the dish is covered by %HIS_HER(DISH_ASSI)% %SAMEN_DESCRIPTION(DISH_ASSI)%...
; 		SIF TALENT:DISH_ASSI:濃厚精液
; 			PRINTFORML The amount of rich, virile cum lacing the food almost makes it look like it's inseminating it.
; 		DOWNBASE:DISH_ASSI:体力 += 100
; 		DOWNBASE:DISH_ASSI:気力 += 150
; 		;精力25%カット
; 		TIMES BASE:DISH_ASSI:精力, 0.75
; 		BASE:DISH_ASSI:勃起 = 300
; 		EXP:DISH_ASSI:自慰経験 ++
; 		EXP:DISH_ASSI:射精経験 ++
; 		EX:DISH_ASSI:射精 ++
; 		SIF TALENT:DISH_ASSI:濃厚精液
; 			DISH_LEWD = 102
; 		CALL DISH_TASTE_ADD(-1, "しょっぱい/濃厚/未知の味/水気/怪しい/予想外")
; 	CASE 3
; 		PRINTFORML Revealing %HIS_HER(DISH_ASSI)% %FSYN("vagina",,DISH_ASSI)%, %CALLNAME:DISH_ASSI% starts pleasing %HIS_HER(DISH_ASSI)% body in front of the %LOCALS% %DISHNAME_TR(DISH_NAME)%.
; 		PRINTFORML As %HE_SHE(DISH_ASSI)% climaxes, the %DISHNAME_TR(DISH_NAME)% is covered by %HIS_HER(DISH_ASSI)% %FSYN("juice")%...
; 		PRINTFORML %CALLNAME:DISH_ASSI% mixes it a bit, trying to make it as less visible as possible...
; 		DOWNBASE:DISH_ASSI:体力 += 40
; 		DOWNBASE:DISH_ASSI:気力 += 80
; 		EXP:DISH_ASSI:自慰経験 ++
; 		EX:DISH_ASSI:Ｃ絶頂 ++
; 		CALL DISH_TASTE_ADD(-1, "しょっぱい/未知の味/水気/怪しい/予想外")
; 	CASE 4
; 		PRINTFORML Exposing %HIS_HER(DISH_ASSI)% %OPPAI_DESCRIPTION_TR(DISH_ASSI)%, %CALLNAME:DISH_ASSI% starts squeezing %HIS_HER(DISH_ASSI)% nipples in front of the %LOCALS% %DISHNAME_TR(DISH_NAME)%...
; 		PRINTFORML As %CALLNAME:DISH_ASSI% makes %HIMSELF_HERSELF(DISH_ASSI)% lactate, the %DISHNAME_TR(DISH_NAME)% is covered by %HIS_HER(DISH_ASSI)% fresh breast milk.
; 		DOWNBASE:MASTER:体力 += 40
; 		DOWNBASE:MASTER:気力 += 80
; 		TIMES BASE:MASTER:母乳, 0.75
; 		EXP:MASTER:噴乳経験 ++
; 		EX:MASTER:噴乳 ++
; 		CALL DISH_TASTE_ADD(-1, "ミルク/おふくろの味/濃厚/未知の味/水気/怪しい/予想外/生命力")
; 	CASE 5
; 		PRINTFORML You pop open one of your full milk bottles and pour it on %LOCALS% %DISHNAME_TR(DISH_NAME)%...
; 		ITEM:ミルク瓶 --
; 		SIF ITEM:瓶 < 99
; 			ITEM:瓶++
; 		CALL DISH_TASTE_ADD(-1, "ミルク/おふくろの味/濃厚/未知の味/水気/怪しい/予想外/生命力")
; ENDSELECT
; IF DISH_LEWD
; 	PRINTFORML You give it a little stir to try to make it as inconspicuous as possible.
; 	PRINTFORML You can't wait to see someone feast upon this finely spiced dish...
; 	SIF DISH_LEWD == 5
; 		PRINTFORML Moreso if that milk was their own.
; 	WAIT
; ENDIF


; @NAS_PantySense
; #DIM P_ID
; #DIM DYNAMIC NewPanties
; #DIM DYNAMIC nDebugMode
; [IF_DEBUG]
; nDebugMode = 1
; [ENDIF]

; PRINTFORML You stick out your nose and begin sensing the area...
; CALL SINGLE_EMPTY_LINE()
; LOCAL:9 = LINECOUNT
; FOR LOCAL, 0, CHARANUM
; 	SIF CFLAG:LOCAL:出禁 ;ignore banned characters
; 		CONTINUE
; 	IF (GET_MAPID(CFLAG:LOCAL:現在位置) == GET_MAPID(CFLAG:MASTER:現在位置) && CFLAG:LOCAL:現在位置 != SUKIMA() && CAN_MEET(LOCAL)) || nDebugMode
; 		P_ID = EQUIP:LOCAL:6
; 		LOCALS = %UNDIES_NAME_WITH_BRAND(LOCAL,P_ID,1)%
; 		LOCALS:1 =
; 		SIF STRLENS(PantiesType:LOCAL:2)
; 			LOCALS:1 '= @" + \@ PadCount:LOCAL:0 > 1 ? %@"{PadCount:LOCAL:0}x "%# \@%PantiesType:LOCAL:2% Pad"
; 		SETCOLOR C_YELLOW
; 		SIF LOCAL == MASTER
; 		SETCOLOR C_AQUA

; 		PRINTFORM [{LOCAL, 3}]%CALLNAME:LOCAL,15,LEFT% %LOCALS, 42, LEFT% %LOCALS:1, 18, LEFT% 
; 		RESETCOLOR

; 		PRINTFORM <
; 		PRINTFORM %SoilStr(LOCAL,1,1),15,LEFT% {DiapeCharges:LOCAL:0,4,LEFT}/{DiapeCharges:LOCAL:1,4,LEFT}ml  
; 		RESETCOLOR
; 		PRINTFORM %SoilStr(LOCAL,2,1),15,LEFT% {DiapePooCharges:LOCAL:0,4,LEFT}/{DiapePooCharges:LOCAL:1,4,LEFT}g
; 		RESETCOLOR
; 		PRINTFORM >
; 		SIF TCVAR:LOCAL:NoDiaperDay && nOmutsu && EffectivePottyLevel(LOCAL) < 0
; 			PRINTFORM <No Diaper Day>
; 		PRINTL
; 	ENDIF
; NEXT
; ;SIF LOCAL:9 == LINECOUNT
; ;	PRINTFORML ...No dice.
; WAIT

; @PrankTypeToggle
; PRINTFORML Enable slightly meaner pranks?
; PRINTFORML Includes suitably nasty punishments!
; PRINTFORML This can be changed later in [160] Request Config in the main menu.

; CALL ASK_M("Bring on the death",nNecro,"It's fine as long as it doesn't cause anyone permanent damage",1, "No",1)
; SELECTCASE RESULT
; 	CASE 0
; 		PRINTFORMW You are United Fairies' finest, and killing people in creative ways gets you hard.
; 		Add_Fairy_Prank_Evil_Shenanigans = 2
; 	CASE 1
; 		PRINTFORMW Everyone here wants to shoot each other, after all.
; 		Add_Fairy_Prank_Evil_Shenanigans = 1
; 	CASE 2
; [SKIPSTART]
; 		IF EXP:MASTER:時姦経験 > 0
; 			PRINTFORMW Everything should be lighthearted in this necrophilia ABDL life simulator.
; 		ELSE
; 			PRINTFORMW Pranks set to mild ones only.
; 		ENDIF
; [SKIPEND]
; 		PRINTFORMW Everything should be lighthearted in this \@ nNecro ? %"corpse fucking " % #\@\@ nOmutsu ? %"ABDL "%#\@life simulator.
; 		Add_Fairy_Prank_Evil_Shenanigans = 0
; ENDSELECT

; ;=========================================================
; ;NAS_Check_Gain_Lewd
; ;
; ;----------------------------------------------------------
; ;Description
; ;----------------------------------------------------------
; ;Lewd check function that allows for males to get Lewd too.
; ;For the ATW path.
; ;==========================================================
; ;allow for males too
; @NAS_Check_Gain_Lewd(ARG)
; #FUNCTION
; #DIM CanLewd

; ;no lewd and not checked
; SIF TALENT:ARG:淫乱 || CFLAG:ARG:LEWD_CHECKED
; 	RETURNF 0

; IF HAS_VAGINA(ARG)
; 	;lewd vagina, cervix
; 	SIF !TALENT:ARG:淫壺 || !TALENT:ARG:ポルチオ性感
; 		RETURNF 0
; ENDIF

; ;lewd anus, breasts, kiss maniac, masturbator, nimble finger, skilled tongue, love taste of semen
; SIF TALENT:ARG:尻穴狂い && TALENT:ARG:淫乳 && TALENT:ARG:キス魔 && TALENT:ARG:自慰狂い && TALENT:ARG:器用な指 && TALENT:ARG:舌使い && TALENT:ARG:精愛味覚
; 	RETURNF 1


; ;=========================================================
; ;EQUIP_COM381
; ;
; ;----------------------------------------------------------
; ;Description
; ;----------------------------------------------------------
; ;Equips for custom commands
; ;==========================================================
; @EQUIP_COM381(ARG)
; SKIPDISP ARG
; SIF ADD_SELECTCUSTOMCOM < 0
; 	RETURN 0

; TRYCCALLFORM ADD_CUSTOM_EQUIP_COM{ADD_SELECTCUSTOMCOM}(ARG)
; 	RETURN RESULT
; CATCH
; ENDCATCH
; RETURN 0

;=========================================================
;NAS_Custom_COM_Name
;
;----------------------------------------------------------
;Description
;----------------------------------------------------------
;Custom eraNAS command names
;==========================================================
@NAS_Custom_COM_Name(ARG)
#FUNCTIONS
SELECTCASE ARG
	CASE 350
		RETURNF @"Rape %CALLNAME:TARGET%"
	CASE 59
		RETURNF "Set Vibrator Power"
	CASE 100
		RETURNF "Doctoring"
	CASE 151
		RETURNF "Defecate"
	CASE 153
		RETURNF "Drink Pee"
	CASE 154
		RETURNF "Eat Poo"
	CASE 160
		RETURNF "Urethral Missionary"
	CASE 161
		RETURNF "Urethral Doggy"
	CASE 162
		RETURNF "Urethral Cowgirl"
	CASE 163
		RETURNF "Urethral Sound"
	CASE 164
		RETURNF "Electrode（Ｃ）"
	CASE 165
		RETURNF "Electrode（Ｖ）"
	CASE 166
		RETURNF "Electrode（Ａ）"
	CASE 167
		RETURNF "Electrode（Ｂ）"
	CASE 168
		RETURNF "Electrode（Ｍ）"
	CASE 169
		RETURNF "Electrode（Ｕ）"	
	CASE 170
		RETURNF "Facesitting"
	CASE 298
		RETURNF "Brand as Slave"
	CASE 193
		RETURNF "Laxative"
	CASE 200
		RETURNF "Spawn Tentacles"
	CASE 201
		RETURNF "Hypnosis"
	CASE 299
		RETURNF "Execute"
	; CASE 330
	; 	IF TALENT:TARGET:Religion == TALENT:MASTER:Religion
	; 		RETURNF "Reassure"
	; 	ELSE
	; 		RETURNF @"Convert to %TOSTR_Religion(TALENT:MASTER:Religion)%"
	; 	ENDIF
	CASE 338
		RETURNF "Public Toy Play"
	CASE 339
		RETURNF "Shock Wand"
	CASE 340
		RETURNF "Kick Stomach"
	CASE 353
		RETURNF "Negotiate"
	CASE 357
		RETURNF "Relieve Self"
	CASE 358
		RETURNF "Get Caring Menu"	
	CASE 359
		RETURNF "Laundry"
	CASE 361
		RETURNF "Do Kegels"	
	CASE 452
		RETURNF "Hide Body"
	; CASE 453
	; 	IF IsDead:TARGET:0
	; 		RETURNF "Loot Corpse"
	; 	ELSE
	; 		RETURNF "Pickpocket"
	; 	ENDIF
	CASE 471
		RETURNF "Genbu Autovender"
	CASE 472
		RETURNF "Hibernate"
	CASE 473
		RETURNF "Arms Autovender"
	CASE 474
		RETURNF "Communication Hub"
	CASE 475
		RETURNF @"Mini %CALLNAME:102%"
	CASE 477
		RETURNF @"Recruitment Board"
	CASE 478
		RETURNF @"Construction"
	CASE 480
		RETURNF @"Change Research"
	; CASE 481
	; 	RETURNF @"Fire %PrintWeaponName(MASTER,EQUIP:MASTER:Weapon,1)%"
	CASE 483
		RETURNF "Organize Battle"
	CASE 484
		RETURNF "Challenge"
	CASE 489
		RETURNF @"Kick Out %CALLNAME:TARGET%"	
	CASE 797
		IF TARGET == MASTER
		RETURNF @"Attack"
		ELSE
		RETURNF @"Attack %CALLNAME:TARGET%"
		ENDIF
	CASE 635
		RETURNF @"Clothing Store"
	CASE 636
		RETURNF @"Palanquin InterStellar"
	CASE 700
		RETURNF @"Handjob"
	CASE 780
		RETURNF "Internet"
	; CASE 930 TO 939
	; 	RETURNF LucidDreamInputName(DAILY_Lucid_Stats:3,ARG-930)
	CASE 998
		;NAS: Filler function. Will always be blank
		RETURNF
	CASE 999
		RETURNF "Debug"
ENDSELECT


; @IRAI_一般92_Punishment_Save_NAS
; #DIM CAN_DO_SH ;NAS because youjutsu
; #DIM CAN_DO_SK ;NAS because youjutsu
; CALL YoujutsuMagicCanDo(MASTER,19,0)
; CAN_DO_SH = RESULT
; CALL YoujutsuMagicCanDo(MASTER,6,0)
; CAN_DO_SK = RESULT
; PRINTFORML Use magic or fight to make your getaway?
; {
; CALL ASK_M(
; "Cast [The World] and run off", BASE:MASTER:TSP >= 3000,
; "Cast [Skip]", 1,
; "Cast [Suppress Hostility]", CAN_DO_SH,
; @"Fight %CALLNAME:Add_VICTIM%", CAN_DO_SK,
; @"Give Up", 1,
; )
; }
; SELECTCASE RESULT
; CASE 0
; 	PRINTFORML Using a considerable amount of your power, you run away as far as you can, escaping your punishment.
; 	PRINTFORML Though something tells you %CALLNAME:Add_VICTIM% won't be too happy about that anyway...
; 	BASE:MASTER:TSP -= 3000
; 	CFLAG:Add_VICTIM:ブチギレ = 1
; 	RETURN 1
; CASE 1
; 	CALL PROCESS_YOUJUTSU_COMMAND(MASTER,MASTER,6,0)
; 	IF RESULT < 0
; 		PRINTFORML ...Unfortunately, it didn't work.
; 		RETURN 0
; 	ENDIF
; 	PRINTFORML Using Skip, you teleport away to safety, escaping your punishment.
; 	PRINTFORML Though something tells you %CALLNAME:Add_VICTIM% won't be too happy about that anyway...
; 	CFLAG:Add_VICTIM:ブチギレ = 1
; 	RETURN 1
; CASE 2
; 	PRINTFORML You focus, stare into %CALLNAME:Add_VICTIM%'s eyes, and tell %HIM_HER(Add_VICTIM)% in a firm voice that what you did really wasn't worth getting worked up about.
; 	CALL PROCESS_YOUJUTSU_COMMAND(MASTER,Add_VICTIM,19,0)
; 	IF RESULT < 0
; 		PRINTFORML ...Unfortunately, it didn't work.
; 		RETURN 0
; 	ENDIF
; 	PRINTFORML %CALLNAME:Add_VICTIM% relents, and lets you go.
; 	RETURN 1
; CASE 3
; 	PRINTFORML You pull out your %PrintWeaponName(MASTER)% and begin to fight %CALLNAME:Add_VICTIM%.
; 	CALL KNIFE_FIGHT(MASTER,Add_VICTIM,1,1)
; 	IF lcWarResult == CurrentBattle:Battle_PlayerSide
; 		IF SHIRAHU(Add_VICTIM)
; 			PRINTFORML %CALLNAME:Add_VICTIM% cries as %HE_SHE(Add_VICTIM)% begs for mercy.
; 			PRINTFORML %HE_SHE(Add_VICTIM,1)% says that %HE_SHE(Add_VICTIM)% will forgive you if you leave %HIM_HER(Add_VICTIM)% alive.
; 		ELSE
; 			PRINTFORML %CALLNAME:Add_VICTIM% collapses to the ground, \@ IsDead:Add_VICTIM:0 ? lifeless # unconscious\@, escaping your punishment.
; 			PRINTFORML You run away from the body, trying to escape the fact you just \@ IsDead:Add_VICTIM:0 ? killed # knocked out \@ %CALLNAME:Add_VICTIM%.
; 		ENDIF
; 		RETURN 1
; 	ELSE
; 		IF !SHIRAHU(MASTER)
; 			PRINTFORML You collapse to the ground, your injuries taken in the battle being a punishment itself.
; 			PRINTFORML You are left for dead as %CALLNAME:Add_VICTIM% loots your body and heads off.
; 			RETURN 1
; 		ENDIF
; 	ENDIF
; CASEELSE
; 	RETURN 0
; ENDSELECT


; ;Easier character swapping
; ;ARG:0 = Swapping from
; ;ARG:1 = Swapping to
; ;ARG:2 = Options
; ;	・1 = Swap swapping ID
; @NAS_SWAP_CHARA(ARG,ARG:1,ARG:2)
; #FUNCTION

; PRINTFORML Swapping {ARG} %CALLNAME:ARG% with {ARG:1} %CALLNAME:(ARG:1)%
; SIF ARG:2
; 	NO:ARG = ARG:1


; CALLF CopyHediffsCC(ARG:0, 0)
; CALLF CopyHediffsCC2(ARG:1,0)
; CALLF ClearAllHediffs(ARG:0, 1)
; CALLF ClearAllHediffs(ARG:1, 1)
; SWAPCHARA ARG,ARG:1
; FOR LOCAL,0,CHARANUM
; 	SWAP RELATION:LOCAL:ARG,RELATION:LOCAL:(ARG:1)
; NEXT
; CALLF CopyHediffsCC(ARG:1, 1)
; CALLF CopyHediffsCC2(ARG, 1)

; ;Moves character to the last slot
; @NAS_MOVE_CHARA(ARG)
; #FUNCTION
; PRINTFORML Moving %CALLNAME:ARG% (#{ARG}) to slot #{CHARANUM}
; ADDCOPYCHARA ARG
; CALLF CopyHediffsCC(ARG, 0)
; FOR LOCAL,0,CHARANUM
; 	SWAP CharaFamily:LOCAL:ARG,CharaFamily:LOCAL:(CHARANUM-1)
; 	SWAP CharaFamily:ARG:LOCAL,CharaFamily:(CHARANUM-1):LOCAL
; NEXT
; CALLF ClearAllHediffs(ARG:0, 1)
; DELCHARA ARG



; @NAME_ARRAY_COMPARE(C_ID,PickChange = 1)
; #DIM C_ID
; #DIM PickChange
; #DIMS FormerNames, 20
; #DIMS NAC_COMPARE,2
; #DIMS CONST STATUS_TITLE = "JP Name", "JP Callname", "Name", "Callname", "Workplace", "Work", "Title", "First Name", "Last Name", "Middle Name", "Name Type", "Prefix", "Suffix", "Short Title", "", "", "", "", "Edited Name", "Edited Call Name"
; FormerNames:19 '= NameChecker(C_ID)
; FormerNames:18 '= CALLNAME:C_ID
; FOR N, 0, VARSIZE("nameArray")
; 	FormerNames:N '= nameArray:C_ID:N
; NEXT

; CALL IndividualNameSet(C_ID)
; CALLNAME:C_ID '= nameArray:C_ID:na_CallName
; PRINTFORML Current save data name array does not match with game set name array:
; FOR LOCAL,0,VARSIZE("FormerNames")
; 	SELECTCASE LOCAL
; 	CASE 18
; 		NAC_COMPARE:0 '= FormerNames:LOCAL
; 		NAC_COMPARE:1 '= CALLNAME:C_ID
; 	CASE 19
; 		NAC_COMPARE:0 '= FormerNames:LOCAL
; 		NAC_COMPARE:1 '= NameChecker(C_ID)
; 	CASE IS >= VARSIZE("nameArray")
; 		CONTINUE
; 	CASEELSE
; 		NAC_COMPARE:0 '= FormerNames:LOCAL
; 		NAC_COMPARE:1 '= nameArray:C_ID:LOCAL
; 	ENDSELECT
; 	SETCOLOR C_YELLOW
; 	PRINTFORML %@"%STATUS_TITLE:LOCAL%",15,LEFT%: 
; 	RESETCOLOR
; 	PRINTFORM %@"%NAC_COMPARE:0%",25,LEFT%
; 	SETCOLOR C_RED
; 	PRINTFORM  ➞ 
; 	RESETCOLOR
; 	PRINTFORM %@"%NAC_COMPARE:1%",25,LEFT%
; 	PRINTL
; NEXT
; PRINTFORML Do you want to name this character back to 「%NameChecker(C_ID)%」?
; CALL ASK_YN()
; SELECTCASE RESULT
; CASE 0
; CASE 1
; 		FOR N, 0, VARSIZE("nameArray")
; 			nameArray:C_ID:N '= FormerNames:N
; 		NEXT
; 		CALLNAME:C_ID '= FormerNames:18
; ENDSELECT
; NAME:C_ID = %NameChecker(C_ID)%

; ;eraNAS custom CGs
; @NASImg_Set
; Img_CustomFace:11:0++ ;Marisa
; Img_CustomFace:136:0++ ;Takane
; Img_CustomStand:136:0++ ;Takane


; Img_CustomFace:91:0 ++ ;Tojiko
; Img_CustomStand:91:0 ++ ;Tojiko


; @TALENT_VALUE(ARG,nChara,nValue = -999)
; #FUNCTION
; #DIM nChara
; #DIM nValue

; ;toggle
; IF nValue == -999
; 	SIF !GETBIT(NASFeature,4)
; 		RETURNF 0
; 	nValue = TALENT:nChara:ARG
; ENDIF

; SELECTCASE ARG
; CASE 1514,1500,1310,56,121
; 	SELECTCASE nValue
; 	CASE 6
; 		RETURNF -100
; 	CASE -5
; 		RETURNF -30
; 	CASE -4
; 		RETURNF -20
; 	CASE -3
; 		RETURNF -10
; 	CASE 3
; 		RETURNF -10
; 	CASE 4
; 		RETURNF -20
; 	CASE 5
; 		RETURNF -30
; 	ENDSELECT
; CASE 3
; 	RETURNF 20
; CASE 4
; 	RETURNF 20
; CASE 5
; 	RETURNF 20
; CASE 7
; 	RETURNF 20
; CASE 8
; 	RETURNF 10
; CASE 29
; 	RETURNF 30
; CASE 185
; 	RETURNF 10
; CASE 105, 108, 109, 110, 111, 112
; 	RETURNF -50
; CASE 10
; 	SELECTCASE nValue
; 	CASE -1
; 		IF nChara == MASTER
; 		RETURNF -30
; 		ELSE
; 		RETURNF 0
; 		ENDIF	
; 	CASE 1
; 		IF nChara == MASTER
; 		RETURNF 30
; 		ELSE
; 		RETURNF -20
; 		ENDIF	
; 	ENDSELECT
; CASE 11
; 	SELECTCASE nValue
; 	CASE -1
; 		IF nChara == MASTER
; 		RETURNF -20
; 		ELSE
; 		RETURNF 30
; 		ENDIF	
; 	CASE 1
; 		IF nChara == MASTER
; 		RETURNF 30
; 		ELSEIF TALENT:nChara:3
; 		RETURNF -50
; 		ELSE
; 		RETURNF -30
; 		ENDIF	
; 	ENDSELECT
; CASE 12
; 	SELECTCASE nValue
; 	CASE -1
; 		IF nChara == MASTER
; 		RETURNF -50
; 		ELSE
; 		RETURNF 30
; 		ENDIF	
; 	CASE 1
; 		IF nChara == MASTER
; 		RETURNF 20
; 		ELSE
; 		RETURNF -20
; 		ENDIF	
; 	ENDSELECT
; CASE 13
; 	SELECTCASE nValue
; 	CASE -1
; 		IF nChara == MASTER
; 		RETURNF -50
; 		ELSE
; 		RETURNF 30
; 		ENDIF	
; 	CASE 1
; 		IF nChara == MASTER
; 		RETURNF -50
; 		ELSE
; 		RETURNF -30
; 		ENDIF	
; 	ENDSELECT	
; CASE 14
; 	IF nChara == MASTER
; 	RETURNF -50
; 	ELSEIF TALENT:nChara:3
; 	RETURNF 30
; 	ELSEIF TALENT:nChara:4
; 	RETURNF -10
; 	ELSE
; 	RETURNF -30
; 	ENDIF	
; CASE 15
; 	SELECTCASE nValue
; 	CASE -1
; 		RETURNF -20
; 	CASE 1
; 		RETURNF 20
; 	ENDSELECT
; CASE 16
; 	RETURNF -50
; CASE 17
; 	SELECTCASE nValue
; 	CASE 0 TO 2
; 		RETURNF -50
; 	CASE 3 TO 6
; 		RETURNF -30
; 	CASE 7 TO 9
; 		RETURNF -20
; 	CASE 10 TO 12
; 		RETURNF -10
; 	CASE 13 TO 40
; 	CASE 40 TO 60
; 		RETURNF -10
; 	CASE 60 TO 79
; 		RETURNF -20
; 	CASE IS >= 80
; 		RETURNF -30
; 	ENDSELECT
; CASE 20
; 	RETURNF -30
; CASE 21
; 	SELECTCASE nValue
; 	CASE -1
; 		RETURNF 20
; 	CASE 1
; 		IF nChara == MASTER
; 		RETURNF -50
; 		ELSEIF TALENT:nChara:3
; 		RETURNF -50
; 		ELSE
; 		RETURNF -20
; 		ENDIF	
; 	CASE 2
; 		IF nChara == MASTER
; 		RETURNF -50
; 		ELSEIF TALENT:nChara:3
; 		RETURNF 30
; 		ELSE
; 		RETURNF -20
; 		ENDIF
; 	ENDSELECT
; CASE 22
; 	IF nChara == MASTER
; 	RETURNF -50
; 	ELSE
; 	RETURNF -30
; 	ENDIF
; CASE 23
; 	SELECTCASE nValue
; 	CASE -1
; 		IF nChara == MASTER
; 		RETURNF -50
; 		ELSE
; 		RETURNF -20
; 		ENDIF
; 	CASE 1
; 		IF nChara == MASTER
; 		RETURNF -50
; 		ELSE
; 		RETURNF 30
; 		ENDIF
; 	ENDSELECT

; CASE 24
; 	SELECTCASE nValue
; 	CASE -1
; 		IF TALENT:MASTER:ARG == -1
; 		RETURNF 10
; 		ELSE
; 		RETURNF -50
; 		ENDIF
; 	CASE 1
; 		IF TALENT:MASTER:ARG == 1
; 		RETURNF 30
; 		ELSE
; 		RETURNF -50
; 		ENDIF
; 	ENDSELECT
; CASE 25
; 	IF nChara == MASTER
; 	RETURNF 10
; 	ELSEIF TALENT:nChara:3
; 	RETURNF 20
; 	ELSEIF !FuckReserved(nChara)
; 	RETURNF -50
; 	ELSE
; 	RETURNF -30
; 	ENDIF
; CASE 26
; 	RETURNF 20
; CASE 27
; 	RETURNF -20
; CASE 30
; 	SELECTCASE nValue
; 	CASE -1
; 		IF nChara == MASTER
; 		RETURNF -50
; 		ELSE
; 		RETURNF 20
; 		ENDIF
; 	CASE 1
; 		IF nChara == MASTER
; 		RETURNF -50
; 		ELSEIF TALENT:nChara:3
; 		RETURNF -20
; 		ELSE
; 		RETURNF -30
; 		ENDIF
; 	ENDSELECT
; CASE 31
; 	SELECTCASE nValue
; 	CASE -1
; 		IF nChara == MASTER
; 		RETURNF -50
; 		ELSE
; 		RETURNF -30
; 		ENDIF
; 	CASE 1
; 		IF nChara == MASTER
; 		RETURNF -50
; 		ELSE
; 		RETURNF 20
; 		ENDIF
; 	ENDSELECT
; CASE 32
; 		IF nChara == MASTER
; 		RETURNF -50
; 		ELSE
; 		RETURNF -20
; 		ENDIF
; CASE 34
; 	RETURNF 10
; CASE 40
; 	SELECTCASE nValue
; 	CASE -1
; 		RETURNF 30
; 	CASE 1
; 		RETURNF -30
; 	ENDSELECT
; CASE 41
; 	SELECTCASE nValue
; 	CASE -1
; 		RETURNF -10
; 	CASE 1
; 		RETURNF 10
; 	ENDSELECT
; CASE 50
; 	SELECTCASE nValue
; 	CASE -1
; 		RETURNF -30
; 	CASEELSE
; 		RETURNF 30
; 	ENDSELECT
; CASE 51, 52, 53
; 	RETURNF 20
; CASE 54
; 	RETURNF -10
; CASE 55
; 	RETURNF 30
; CASE 59
; 	RETURNF 30	
; CASE 60
; 	RETURNF 20
; CASE 61
; 	SELECTCASE nValue
; 	CASE -2
; 	RETURNF -30
; 	CASE -1
; 	RETURNF -10
; 	CASE 1
; 	RETURNF 10
; 	CASE 2
; 	RETURNF 30
; 	ENDSELECT
; CASE 62
; 	RETURNF 30
; CASE 70
; 	SELECTCASE nValue
; 	CASE -1
; 		IF nChara == MASTER
; 		RETURNF -50
; 		ELSEIF TALENT:nChara:3
; 		RETURNF -50
; 		ELSE
; 		RETURNF -30
; 		ENDIF
; 	CASE 1
; 		IF nChara == MASTER
; 		RETURNF -50
; 		ELSE
; 		RETURNF 30
; 		ENDIF
; 	ENDSELECT
; CASE 71
; 	RETURNF 20
; CASE 72
; 	RETURNF 30
; CASE 80
; 	RETURNF 20
; CASE 81
; 	SELECTCASE nValue
; 	CASE -1
; 		RETURNF 20
; 	CASEELSE
; 		IF !OTOKOGIRAI(nChara)
; 		RETURNF -50
; 		ELSE
; 		RETURNF -30
; 		ENDIF
; 	ENDSELECT
; CASE 82
; 	RETURNF 20
; CASE 83
; 	RETURNF 20
; CASE 84
; 	RETURNF -30
; CASE 85
; 	RETURNF 30
; CASE 86
; 	RETURNF 20
; CASE 92
; 	RETURNF 20
; CASE 93
; 	RETURNF 30
; CASE 94
; 	IF !TALENT:MASTER:94
; 	RETURNF -50
; 	ELSE
; 	RETURNF 30
; 	ENDIF
; CASE 101 TO 104, 106
; 	SELECTCASE nValue
; 	CASE -1
; 		SELECTCASE ARG
; 		CASE 101
; 			SIF TALENT:MASTER:170
; 				RETURNF -50
; 		CASE 102
; 			SIF TALENT:MASTER:172
; 				RETURNF -50
; 		CASE 103
; 			SIF TALENT:MASTER:173
; 				RETURNF -50		
; 		CASE 104
; 			SIF TALENT:MASTER:171
; 				RETURNF -50		
; 		CASE 105
; 			SIF TALENT:MASTER:169
; 				RETURNF -50		
; 		ENDSELECT
		
; 		RETURNF -20
; 	CASE 1
; 		RETURNF 20
; 	ENDSELECT
; CASE 122
; 	SELECTCASE nValue
; 	CASE -1
; 		RETURNF -30
; 	CASE 1
; 		RETURNF 30
; 	ENDSELECT
; CASE 130
; 	SELECTCASE nValue
; 	CASE -1
; 		RETURNF -30
; 	CASE 1
; 		RETURNF 30
; 	ENDSELECT
; CASE 136
; 		RETURNF 10
; CASE 137
; 		RETURNF -20
; CASE 143
; 		RETURNF 20
; CASE 144
; 		RETURNF 30
; CASE 145
; 		RETURNF 10
; CASE 149
; 		RETURNF 20
; CASE 150
; 	IF !nOmutsu
; 		RETURNF -50
; 	ELSE
; 		RETURNF 30
; 	ENDIF
; CASE 151
; 		RETURNF -20
; CASE 152
; 		RETURNF 30
; CASE 153, 154
; 		RETURNF -10
; CASE 156
; 		RETURNF 30
; CASE 157
; 		RETURNF 10
; CASE 158
; 		RETURNF 20
; CASE 159
; 		RETURNF 30
; CASE 160
; 		RETURNF 10
; CASE 161
; 		RETURNF 10
; CASE 162
; 		SELECTCASE nValue
; 		CASE -1
; 			RETURNF -10
; 		CASE 1
; 			RETURNF 10
; 		CASE 2
; 			RETURNF 20
; 		ENDSELECT
; CASE 169 TO 173
; 		RETURNF 30
; CASE 177
; 		RETURNF 30
; CASE 178
; 		RETURNF 10
; CASE 179
; 		RETURNF 30
; CASE 183
; 		RETURNF 20
; CASE 221
; 	RETURNF 30
; CASE 222
; 	RETURNF 30
; CASE 1204
; 	SELECTCASE nValue
; 	CASE 0
; 		RETURNF -30
; 	CASE 1, 2
; 		RETURNF -20
; 	CASE 3, 4
; 		RETURNF -10
; 	CASE 6
; 		RETURNF 10
; 	CASE 7
; 		RETURNF 20
; 	CASE 8
; 		RETURNF 30 
; 	ENDSELECT
; CASE 1300
; 	SELECTCASE nValue
; 	CASE -1
; 		RETURNF -30
; 	CASE 2,3
; 		RETURNF 10
; 	CASE 4
; 		RETURNF 20
; 	CASE 5
; 		RETURNF 30 
; 	ENDSELECT
; CASE 270 TO 273
; 		RETURNF 20
; CASE 1510
; 	RETURNF -10
; CASE 1511
; 	RETURNF -10
; ENDSELECT

; @COLOR_FROM_VALUE(ARG,nTalent,ARG:1=0)
; #FUNCTIONS
; #DIM nTalent
; ;exception talents
; SELECTCASE nTalent
; CASE 234
; ;tech know
; 	RETURNF TOSTR(TechLevelColor(ARG:1),"X6")
; ENDSELECT

; SELECTCASE ARG
; CASE 30
; 	RETURNF "9999FF"
; CASE 20
; 	RETURNF "99FF99"
; CASE 10
; 	RETURNF "c7e1bd"
; CASE 0
; CASE -10
; 	RETURNF "FFFF99"
; CASE -20
; 	RETURNF "d9463e"
; CASE -30
; 	RETURNF "FF0000"
; CASE -50
; 	RETURNF "666666"	
; ENDSELECT


; @GET_YEAR
; #FUNCTION
; RETURNF ((DAY:0+StartingDay) / YearLength)

; @SET_START_YEAR
; StartingDay = (YearLength*StartingYear)

; @EVENTLOAD
; #PRI
; CALL SET_START_YEAR()

; @EVENTFIRST
; #PRI
; CALL SET_START_YEAR()


; ;checks for slut/lewd fall states
; ;atw path is probably better so might remove these
; @LewdCheck(ARG)
; #FUNCTION
; SIF TALENT:ARG:恋慕
; 	RETURNF 0
; SIF TALENT:ARG:4
; 	RETURNF 0

; SIF !TALENT:ARG:ヤリマン
; 	RETURNF 0
; SIF !TALENT:ARG:愛欲
; 	RETURNF 0
; SIF CFLAG:ARG:好感度 < REQUIRED_FAVOR_Lewd
; 	RETURNF 0
; SIF ABL:ARG:欲望 < REQUIRED_DESIRE_Lewd
; 	RETURNF 0
; SIF (EXP:ARG:絶頂経験 - EXP:ARG:無自覚絶頂経験) < REQUIRED_ECSTACY_Lewd
; 	RETURNF 0
; SIF (ABL:ARG:欲望 - ABL:ARG:親密) < 1
; 	RETURNF 0
; RETURNF 1

; @SlutCheck(ARG)
; #FUNCTION
; SIF TALENT:ARG:恋慕
; 	RETURNF 0
; SIF TALENT:ARG:ヤリマン
; 	RETURNF 0
; SIF !TALENT:ARG:愛欲
; 	RETURNF 0
; SIF CFLAG:ARG:好感度 < REQUIRED_FAVOR_Slut
; 	RETURNF 0
; SIF ABL:ARG:欲望 < REQUIRED_DESIRE_Slut
; 	RETURNF 0
; SIF (EXP:ARG:絶頂経験 - EXP:ARG:無自覚絶頂経験) < REQUIRED_ECSTACY_Slut
; 	RETURNF 0
; SIF (ABL:ARG:欲望 - ABL:ARG:親密) < 1
; 	RETURNF 0
; RETURNF 1
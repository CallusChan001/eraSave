;舔穴、女上位 + 指交
@ADD_CUSTOM_SCOM11
CALL ADD_CUSTOM_SCOM_MODULE11
CALL ADD_SEX_MODULE_EXECUTE

RETURN 1

@ADD_CUSTOM_SCOM_ABLE11
#DIM DYNAMIC SUCCEED
CALL ADD_CUSTOM_SCOM_MODULE11
CALL ADD_SEX_MODULE_COM_ABLE
SIF !RESULT
	RETURN 0

;need to be decent at all parts
SIF ABL:MASTER:指 < 4
	RETURN 0
SIF ABL:MASTER:舌 < 4
	RETURN 0
SIF ABL:MASTER:腰 < 4
	RETURN 0

RETURN 1

@ADD_CUSTOM_CAN_SCOM11(ARG)
SKIPDISP ARG
PRINTFORML 双女上位同时指交
SKIPDISP 0

CALL ADD_CUSTOM_SCOM_MODULE11
CALL ADD_SEX_MODULE_CAN_COM(ARG)
RETURN RESULT

@ADD_CUSTOM_MESSAGE_SCOM11
#DIM DYNAMIC V_INDEX = -1
#DIM DYNAMIC CUNNILINGUS_INDEX = -1
#DIM DYNAMIC FINGERING_INDEX = -1

FOR LOCAL, 0, ADD_SEX_MODULE_ACTION_COUNT
	IF ADD_SEX_MODULE_IS_ACTION(LOCAL, SET_P, SET_V)
		V_INDEX = LOCAL
	ELSEIF ADD_SEX_MODULE_IS_ACTION(LOCAL, SET_M, SET_C)
		CUNNILINGUS_INDEX = LOCAL
	ELSEIF ADD_SEX_MODULE_IS_ACTION(LOCAL, SET_YUBI, SET_V)
		FINGERING_INDEX = LOCAL
	ENDIF
NEXT

IF V_INDEX < 0 || CUNNILINGUS_INDEX < 0 || FINGERING_INDEX < 0
	PRINTFORMDL ERROR: Targets not valid for @ADD_CUSTOM_MESSAGE_SCOM11
	RETURN
ENDIF

PRINTFORMDL %CALLNAME:MASTER%用嘴侍奉着%CALLNAME:(ADD_SEX_MODULE_CHARA:CUNNILINGUS_INDEX)%、手指探索着%CALLNAME:(ADD_SEX_MODULE_CHARA:FINGERING_INDEX)%的蜜穴深处，%TINKO(MASTER)%正被骑在身上的%CALLNAME:(ADD_SEX_MODULE_CHARA:V_INDEX)%卖力套弄着，三位佳人发出此起彼伏的娇媚呻吟。

@ASSISTANT_KOJO_CUSTOM_SCOM11
FOR LOCAL, 0, ADD_SEX_MODULE_ACTION_COUNT
	SIF ADD_SEX_MODULE_CHARA:LOCAL == TARGET
		CONTINUE
	CALL KOJO_MESSAGE_SEND("COMMAND_ASSISTANT",-1,ADD_SEX_MODULE_CHARA:LOCAL,-1,-1)
NEXT

@ADD_CUSTOM_SCOM_SET11
#DIM DYNAMIC V0
#DIM DYNAMIC M0
#DIM DYNAMIC F0

SIF !IS_COM_SEX("v") && !GROUPMATCH(SELECTCOM, 1, 3)
	RETURN 0

V0 = ADD_MASTER_POSE_TR(PLAYER, SET_V,SET_P)
M0 = ADD_MASTER_POSE_TR(PLAYER, SET_C,SET_M)
F0 = ADD_MASTER_POSE_TR(PLAYER, SET_V,SET_YUBI)

SIF V0 <= 0 && M0 <= 0 && F0 <= 0 ;nothing valid in the current turn
	RETURN 0

IF !V0
	FOR LOCAL, 1, 3
		LOCAL:1 = ADD_MASTER_POSE_TR(PLAYER, SET_V,SET_P,LOCAL)

		SIF !LOCAL:1
			CONTINUE

		V0 = LOCAL:1
		BREAK
	NEXT
ENDIF
IF !M0
	FOR LOCAL, 1, 3
		LOCAL:1 = ADD_MASTER_POSE_TR(PLAYER, SET_C,SET_M,LOCAL)

		SIF !LOCAL:1
			CONTINUE

		M0 = LOCAL:1
		BREAK
	NEXT
ENDIF
IF !F0
	FOR LOCAL, 1, 3
		LOCAL:1 = ADD_MASTER_POSE_TR(PLAYER, SET_V,SET_YUBI,LOCAL)

		SIF !LOCAL:1
			CONTINUE

		F0 = LOCAL:1
		BREAK
	NEXT
ENDIF
DEBUGPRINTFORML V0 = {V0} M0 = {M0} F0 = {F0}

SIF V0 == M0 || V0 == F0 || M0 == F0
	RETURN 0

IF F0 == TARGET && SELECTCOM != 3
	RETURN 0
ELSEIF V0 == TARGET && !IS_COM_SEX("v")
	RETURN 0
ELSEIF M0 == TARGET && SELECTCOM != 1
	RETURN 0
ENDIF

ADD_SEX_MODULE_ACTOR:0 = PLAYER
ADD_SEX_MODULE_CHARA:0 = V0
ADD_SEX_MODULE_CHARA:1 = M0
ADD_SEX_MODULE_CHARA:2 = F0
ADD_SEX_MODULE_POSE:0 = ADD_TOUCH_CURRENT_POSE(PLAYER, V0)

RETURN 1

@ADD_CUSTOM_SCOM_MODULE11
CALL ADD_SEX_MODULE_START(11)
CALL ADD_SEX_MODULE_ADD_ACTION(SET_P, SET_V,, 0)
CALL ADD_SEX_MODULE_ADD_ACTION(SET_M, SET_C,, 1)
CALL ADD_SEX_MODULE_ADD_ACTION(SET_YUBI, SET_V,, 2)
CALL ADD_SEX_MODULE_FINISH

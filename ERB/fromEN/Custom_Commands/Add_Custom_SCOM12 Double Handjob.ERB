;Double Handjob
@ADD_CUSTOM_SCOM12
CALL ADD_CUSTOM_SCOM_MODULE12
CALL ADD_SEX_MODULE_EXECUTE

RETURN 1

@ADD_CUSTOM_SCOM_ABLE12
#DIM DYNAMIC SUCCEED
CALL ADD_CUSTOM_SCOM_MODULE12
CALL ADD_SEX_MODULE_COM_ABLE
SIF !RESULT
	RETURN 0

;everyone needs moderate finger skill
FOR LOCAL, 0, 2
	SIF ABL:(ADD_SEX_MODULE_CHARA:LOCAL):指 < 2
		RETURN 0
NEXT

RETURN 1

@ADD_CUSTOM_CAN_SCOM12(ARG)
SKIPDISP ARG
PRINTFORML 双人手交
SKIPDISP 0

CALL ADD_CUSTOM_SCOM_MODULE12
CALL ADD_SEX_MODULE_CAN_COM(ARG)
RETURN RESULT

@ADD_CUSTOM_MESSAGE_SCOM12
#DIM CURRENT_CHARA
#DIM OTHER_CHARA
#DIM SKILL_DIFFERENCE

SKILL_DIFFERENCE = (ABL:(ADD_SEX_MODULE_CHARA:0):指 * 3 + ABL:(ADD_SEX_MODULE_CHARA:0):技巧) - (ABL:(ADD_SEX_MODULE_CHARA:1):指 * 3 + ABL:(ADD_SEX_MODULE_CHARA:1):技巧)

IF NOWEX:MASTER:射精
	PRINTFORMDL 感受到%CALLNAME:MASTER%射精的预兆，%CALLNAME:(ADD_SEX_MODULE_CHARA:0)%和%CALLNAME:(ADD_SEX_MODULE_CHARA:1)%加快了套弄的频率，将%CALLNAME:MASTER%推向高潮。
ELSE
	IF TALENT:PLAYER:双槍
		IF ADD_PREV_SELECTED_SCOM == 12
			PRINTFORMDL %CALLNAME:(ADD_SEX_MODULE_CHARA:0)%和%CALLNAME:(ADD_SEX_MODULE_CHARA:1)%继续配合着套弄%CALLNAME:MASTER%%TINKO(PLAYER, 1)%。
		ELSE
			PRINTFORMDL 当%CALLNAME:(ADD_SEX_MODULE_CHARA:1)%套弄着一根肉棒时，%CALLNAME:(ADD_SEX_MODULE_CHARA:0)%也抓住另一根开始爱抚。
		ENDIF

		;both are skilled
		IF ABL:(ADD_SEX_MODULE_CHARA:0):技巧 > 5 && ABL:(ADD_SEX_MODULE_CHARA:0):指 > 3 && ABL:(ADD_SEX_MODULE_CHARA:1):技巧 > 5 && ABL:(ADD_SEX_MODULE_CHARA:1):指 > 3
			PRINTFORMDL 她们熟练地配合着彼此的套弄节奏，高超的技巧为肉棒带来了巨大的快感浪潮。
		;one is more skilled
		ELSEIF SKILL_DIFFERENCE
			PRINTFORMDL %CALLNAME:(ADD_SEX_MODULE_CHARA:(SKILL_DIFFERENCE > 0 ? 1 # 0))%难以跟上%CALLNAME:(ADD_SEX_MODULE_CHARA:(SKILL_DIFFERENCE > 0 ? 0 # 1))%的节奏，肉棒传来不平衡的奇妙快感。
		;equally unskilled
		ELSE
			PRINTFORMDL 她们俩都不是很熟练，显然更难配合彼此。
		ENDIF
	ELSE
		IF ADD_PREV_SELECTED_SCOM == 12
			PRINTFORMDL %CALLNAME:(ADD_SEX_MODULE_CHARA:0)%和%CALLNAME:(ADD_SEX_MODULE_CHARA:1)%继续配合着套弄%CALLNAME:MASTER%%TINKO(PLAYER, 1)%。
		ELSE
			PRINTFORMDL %CALLNAME:(ADD_SEX_MODULE_CHARA:0)%加入进来，也伸手抚摸%CALLNAME:MASTER%%TINKO(PLAYER, 1)%。
		ENDIF

		;both are skilled
		IF ABL:(ADD_SEX_MODULE_CHARA:0):技巧 > 5 && ABL:(ADD_SEX_MODULE_CHARA:0):指 > 3 && ABL:(ADD_SEX_MODULE_CHARA:1):技巧 > 5 && ABL:(ADD_SEX_MODULE_CHARA:1):指 > 3
			PRINTFORMDL 她们的指技高超，配合也相当热切，尽力为%CALLNAME:MASTER%%TINKO(PLAYER)%带来至高快感。
		;one is more skilled
		ELSEIF SKILL_DIFFERENCE
			PRINTFORMDL %CALLNAME:(ADD_SEX_MODULE_CHARA:(SKILL_DIFFERENCE > 0 ? 1 # 0))%不如%CALLNAME:(ADD_SEX_MODULE_CHARA:(SKILL_DIFFERENCE > 0 ? 0 # 1))%熟练，时不时撞到她的手。
		;equally unskilled
		ELSE
			PRINTFORMDL 她们俩都不是特别熟练，总是时不时挡住彼此的套弄动作。
		ENDIF
	ENDIF

	IF ABL:(ADD_SEX_MODULE_CHARA:0):指 > 4 && ABL:(ADD_SEX_MODULE_CHARA:0):技巧 > 7 && ABL:(ADD_SEX_MODULE_CHARA:1):指 && ABL:(ADD_SEX_MODULE_CHARA:1):技巧 > 7 && !RAND:4
		PRINTFORMDL 她们用一同用空着的手伸向%CALLNAME:MASTER%的屁股，开始来回抚摸大腿、轻轻%SPLIT_G("揉搓:爱抚:捏弄")%%FSYN("蛋蛋")%……
	ELSEIF ABL:(ADD_SEX_MODULE_CHARA:0):指 > 4 && ABL:(ADD_SEX_MODULE_CHARA:0):技巧 > 7 && !RAND:4
		PRINTFORMDL %CALLNAME:(ADD_SEX_MODULE_CHARA:0)%同时伸手%SPLIT_G("揉搓:爱抚")%%FSYN("蛋蛋")%……
	ELSEIF ABL:(ADD_SEX_MODULE_CHARA:1):指 && ABL:(ADD_SEX_MODULE_CHARA:1):技巧 > 7 && !RAND:4
		PRINTFORMDL %CALLNAME:(ADD_SEX_MODULE_CHARA:1)%同时伸手%SPLIT_G("揉搓:爱抚")%%FSYN("蛋蛋")%……
	ENDIF
ENDIF

@ASSISTANT_KOJO_CUSTOM_SCOM12
FOR LOCAL, 0, ADD_SEX_MODULE_ACTION_COUNT
	SIF ADD_SEX_MODULE_CHARA:LOCAL == TARGET
		CONTINUE
	CALL KOJO_MESSAGE_SEND("COMMAND_ASSISTANT",-1,ADD_SEX_MODULE_CHARA:LOCAL,-1,-1)
NEXT

@ADD_CUSTOM_SCOM_SET12
#DIM DYNAMIC H0
#DIM DYNAMIC H1

H0 = ADD_MASTER_POSE_TR(PLAYER, SET_YUBI,SET_P)
H1 = ADD_MASTER_POSE_TR(PLAYER, SET_YUBI,SET_P, 1)

SIF H0 <= 0 || H1 <= 0 ;nothing valid in the current turn
	RETURN 0

SIF H0 == H1
	RETURN 0

ADD_SEX_MODULE_ACTOR:0 = PLAYER
ADD_SEX_MODULE_CHARA:0 = H0
ADD_SEX_MODULE_CHARA:1 = H1

RETURN 1

@ADD_CUSTOM_SCOM_MODULE12
CALL ADD_SEX_MODULE_START(12)
CALL ADD_SEX_MODULE_ADD_ACTION(SET_P, SET_YUBI,,0)
CALL ADD_SEX_MODULE_ADD_ACTION(SET_P, SET_YUBI,,1)
CALL ADD_SEX_MODULE_FINISH

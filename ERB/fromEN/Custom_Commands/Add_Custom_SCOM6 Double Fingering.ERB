;Double Fingering
@ADD_CUSTOM_SCOM6
;-------------------------------------------------
;COM別FLAGの設定
;-------------------------------------------------
;TCVAR:2 射精箇所フラグ（-1=コンドーム 1=膣内 2=アナル 3=手淫 4=口淫 5=パイズリ 6=素股 7=足コキ 8=体表 9=アナル奉仕 10=道具 11=触手）
;二人目
LOCAL = MASTER_POSE(SET_V,SET_YUBI,1)
;行為者
TCVAR:116 = PLAYER
TCVAR:LOCAL:116 = PLAYER
TCVAR:PLAYER:108 = 1

;破瓜抑制
TFLAG:2 = 1

IF FLAG:70
	BASE:MASTER:TSP -= 60
ELSE
	;口上による強制失敗
	SIF TFLAG:192 == -1
		RETURN -1
ENDIF
CALL ADD_CUSTOM_SCOM6_TARGET(TARGET)
CALL ADD_CUSTOM_SCOM6_TARGET(LOCAL)

EXP:PLAYER:手淫経験 ++
;同性愛　レズなら戻り値1ゲイなら戻り値2
IF HETEROSEX(TARGET,PLAYER)
	EXP:(50 + HETEROSEX(TARGET,PLAYER)) += 3
	EXP:PLAYER:(50 + HETEROSEX(TARGET,PLAYER)) += 3
ENDIF
;同性愛　レズなら戻り値1ゲイなら戻り値2
IF HETEROSEX(TARGET,LOCAL)
	EXP:LOCAL:(50 + HETEROSEX(TARGET,LOCAL)) += 3
	EXP:TARGET:(50 + HETEROSEX(TARGET,LOCAL)) += 3
ENDIF
;同性愛　レズなら戻り値1ゲイなら戻り値2
IF HETEROSEX(LOCAL,PLAYER)
	EXP:LOCAL:(50 + HETEROSEX(LOCAL,PLAYER)) += 3
	EXP:PLAYER:(50 + HETEROSEX(LOCAL,PLAYER)) += 3
ENDIF

TFLAG:194 = 0
LOCAL:1 = ADD_LESBIANISM_SCORE(TARGET, LOCAL)
IF LOCAL:1 > 0
	IF LOCAL:1 >= 8 && !RAND:3
		TFLAG:194 = 3 ;kiss
	ELSEIF LOCAL:1 >= 5 && !RAND:3
		TFLAG:194 = 2 ;breast grab
	ELSEIF LOCAL:1 >= 3 && !RAND:2
		TFLAG:194 = 1 ;handholding
	ENDIF
ENDIF

RETURN 1

@ADD_CUSTOM_SCOM6_TARGET(ARG)
;-------------------------------------------------
;ソース追加処理
;-------------------------------------------------
;消費体力、気力
IF FLAG:70
	IF TALENT:ARG:処女 || TALENT:ARG:処女 == -1
		SOURCE:ARG:快Ｖ = 120
		SOURCE:ARG:苦痛 = 10
	ELSE
		SOURCE:ARG:快Ｖ = 60
		SOURCE:ARG:苦痛 = 5
	ENDIF
ELSE
	DOWNBASE:ARG:体力 += 30
	DOWNBASE:ARG:気力 += 80

	IF TALENT:ARG:処女 || TALENT:ARG:処女 == -1 ;com custom code, fix
		SOURCE:ARG:快Ｖ = 120
		SOURCE:ARG:苦痛 = 15
		SOURCE:ARG:露出 = 10
		SOURCE:ARG:逸脱 = 20
		SOURCE:ARG:反感 = 20
	;V経験が0の時はV経験を伴わない物に派生
	;Vの珠は入らないが、快Vが高いと慣らしてあるため処女喪失時に影響
	ELSE
		SOURCE:ARG:快Ｖ = 60
		SOURCE:ARG:苦痛 = 10
		SOURCE:ARG:露出 = 30
		SOURCE:ARG:逸脱 = 30
		SOURCE:ARG:反感 = 30
	ENDIF
ENDIF

SIF TALENT:PLAYER:器用な指
	SOURCE:ARG:快Ｖ += 20
SOURCE:ARG:快Ｖ += ABL:PLAYER:指 * 5
;-------------------------------------------------
;特殊ソース処理
;-------------------------------------------------
;抑圧、抵抗持ちには、抑鬱ソース追加
IF TALENT:ARG:自己愛 < 0 || TALENT:ARG:抵抗
	SOURCE:ARG:鬱屈 += 20
	;処女
	SIF TALENT:ARG:処女
		SOURCE:ARG:鬱屈 += 10
ENDIF
;Vへの苦痛
CALL PAIN_CHECK_V(ARG)

STAIN:ARG:6 |= STAIN:PLAYER:1
STAIN:PLAYER:1 |= STAIN:ARG:6
EXP:ARG:Ｖ経験 ++

@ADD_CUSTOM_SCOM_ABLE6
;指挿入れ実行判定
SIF !TFLAG:100
	RETURN 0
;一括管理
SIF TFLAG:102 != 2
	RETURN 0
LOCAL = MASTER_POSE(SET_V,SET_YUBI,1)
;時間停止中はスキップ
IF !FLAG:70
	;馴れ合い強度2
	SIF (TCVAR:MASTER:馴れ合い < 2) && CFLAG:睡眠 == 0
		RETURN 0
	;着衣
	SIF TEQUIP:0 & 4
		RETURN 0
	;睡眠中
	SIF CFLAG:睡眠 && CFLAG:イタズラ < 2
		RETURN 0
	;仕事中
	SIF CFLAG:行動 == 5
		RETURN 0
	;デート中
	SIF CHK_DATENOW(CFLAG:デート中) && CFLAG:現在位置 != OMANEKIBEYA()
		RETURN 0
	;添い寝中
	SIF CFLAG:添い寝中
		RETURN 0
	SIF TEQUIP:50 >= 0
		RETURN 0
ENDIF
;気力0
SIF BASE:MASTER:気力 <= 0
	RETURN 0
SIF GETBIT (TCVAR:26,5)
	RETURN 0
RETURN 1

@ADD_CUSTOM_MESSAGE_SCOM6
#DIM DYNAMIC TARGET_TEXT
#DIM DYNAMIC OTHER_TEXT
LOCAL = MASTER_POSE(SET_V,SET_YUBI,1)

IF FLAG:70 == 1
	PRINTFORM 在继续玩弄%CALLNAME:LOCAL%的蜜壶时，%CALLNAME:MASTER%将手伸向并排的%CALLNAME:TARGET%，\n缓缓地将手指
	IF TEQUIP:0 > 1
		PRINTFORM 伸进
		IF PALAM:潤滑 > PALAMLV:3
			PRINT 湿透的
		ELSEIF PALAM:潤滑 > PALAMLV:1
			PRINT 微微湿润的
		ENDIF
		PRINTFORML %SHOW_BOTTOM(TARGET)%、插入%SLIT(TARGET)%……
	ELSE
		PRINTFORML 插入%SLIT(TARGET)%……
	ENDIF
	PRINTFORML 在时停中同时享受两人蜜穴的不同感触

	IF IS_VIRGIN(TARGET)
		TARGET_TEXT = 1
	ELSEIF ABL:Ｖ感覚 < 2
		TARGET_TEXT = 2
	ELSE
		TARGET_TEXT = 3
	ENDIF
	IF IS_VIRGIN(LOCAL)
		OTHER_TEXT = 1
	ELSEIF ABL:LOCAL:Ｖ感覚 < 2
		OTHER_TEXT = 2
	ELSE
		OTHER_TEXT = 3
	ENDIF

	IF TARGET_TEXT == OTHER_TEXT
		SELECTCASE TARGET_TEXT
			CASE 1
				PRINTFORML 时停中的%CALLNAME:TARGET%和%CALLNAME:LOCAL%无法抵抗%CALLNAME:MASTER%小心又黏腻地玩弄她们的处女穴……
			CASE 2
				PRINTFORML 时停中的%CALLNAME:TARGET%和%CALLNAME:LOCAL%无法抵抗%CALLNAME:MASTER%玩弄她们的小穴……
			CASE 3
				PRINTFORML 时停中的%CALLNAME:TARGET%和%CALLNAME:LOCAL%无法抵抗%CALLNAME:MASTER%的指奸，感度良好的肉壶迫不及待地缠绕上来，仿佛殷勤招呼访客……
		ENDSELECT
	ELSE
		SELECTCASE TARGET_TEXT
			CASE 1
				PRINTFORM %CALLNAME:MASTER%小心又温柔地玩弄%CALLNAME:TARGET%的处女穴
			CASE 2
				PRINTFORM %CALLNAME:MASTER%玩弄着%CALLNAME:TARGET%%SLIT(TARGET)%
			CASE 3
				PRINTFORM %CALLNAME:MASTER%粗暴地搅弄%CALLNAME:TARGET%贪婪的肉壶
		ENDSELECT

		PRINTFORM ，\n同时
		
		SELECTCASE TARGET_TEXT
			CASE 1
				PRINTFORM 小心又温柔地玩弄%CALLNAME:LOCAL%的处女穴……
			CASE 2
				PRINTFORM 玩弄着%CALLNAME:LOCAL%%SLIT(LOCAL)%……
			CASE 3
				PRINTFORM %CALLNAME:LOCAL%的肉壶迫不及待地缠绕上手指，仿佛殷勤邀请%CALLNAME:MASTER%进入……
		ENDSELECT
		PRINTFORML
	ENDIF
ELSE
	PRINTFORM 在继续爱抚%CALLNAME:LOCAL%的同时，%CALLNAME:MASTER%将手伸向一旁的%CALLNAME:TARGET%，\n缓缓地将手指
	IF TEQUIP:0 > 1
		PRINTFORM 伸进
		IF PALAM:潤滑 > PALAMLV:3
			PRINT 湿透的
		ELSEIF PALAM:潤滑 > PALAMLV:1
			PRINT 微微湿润的
		ENDIF
		PRINTFORM %SHOW_BOTTOM(TARGET)%插入%SLIT(TARGET)%
	ELSE
		PRINTFORM 插入暴露在外的小穴
	ENDIF
	PRINTFORML …

	IF IS_VIRGIN(TARGET)
		TARGET_TEXT = 1
	ELSEIF ABL:Ｖ感覚 < 1
		TARGET_TEXT = 2
	ELSEIF ABL:Ｖ感覚 <= 4
		TARGET_TEXT = 3
	ELSE
		TARGET_TEXT = 4
	ENDIF

	IF IS_VIRGIN(LOCAL)
		OTHER_TEXT = 1
	ELSEIF ABL:LOCAL:Ｖ感覚 < 1
		OTHER_TEXT = 2
	ELSEIF ABL:LOCAL:Ｖ感覚 <= 4
		OTHER_TEXT = 3
	ELSE
		OTHER_TEXT = 4
	ENDIF

	IF TARGET_TEXT == OTHER_TEXT
		SELECTCASE TARGET_TEXT
			CASE 1
				PRINTFORML %CALLNAME:TARGET%和%CALLNAME:LOCAL%扭着身子试图夹住%CALLNAME:MASTER%的手臂，仿佛要阻止%CALLNAME:MASTER%的手指深入……
			CASE 2
				PRINTFORML %CALLNAME:TARGET%和%CALLNAME:LOCAL%身体内外都因插入的异物感而绷紧……
			CASE 3
				PRINTFORML %CALLNAME:TARGET%和%CALLNAME:LOCAL%随着%CALLNAME:MASTER%手指的运动发出此起彼伏的销魂娇吟……
			CASE 4
				PRINTFORML %CALLNAME:TARGET%和%CALLNAME:LOCAL%嘴巴半张、涎水流出，腰肢不自主地扭动起来寻求更多快感……
		ENDSELECT
	ELSE
		PRINTFORM %CALLNAME:TARGET%
		SELECTCASE TARGET_TEXT
			CASE 1
				PRINTFORM 扭着身子试图夹住%CALLNAME:MASTER%的手臂，仿佛要阻止%CALLNAME:MASTER%的手指深入
			CASE 2
				PRINTFORM 身体内外都因插入的异物感而绷紧
			CASE 3
				PRINTFORM 随着%CALLNAME:MASTER%手指的运动发出炽热而销魂的销魂娇吟
			CASE 4
				PRINTFORM 嘴巴半张、涎水流出，腰肢不自主地扭动起来寻求更多快感
		ENDSELECT

		PRINTFORM ，\n同时%CALLNAME:LOCAL%
		
		SELECTCASE OTHER_TEXT
			CASE 1
				PRINTFORM 扭着身子试图夹住%CALLNAME:MASTER%的手臂，仿佛要阻止%CALLNAME:MASTER%的手指深入
			CASE 2
				PRINTFORM 身体内外都因插入的异物感而绷紧
			CASE 3
				PRINTFORM 随着%CALLNAME:MASTER%手指的运动发出炽热而销魂的销魂娇吟
			CASE 4
				PRINTFORM 嘴巴半张、涎水流出，腰肢不自主地扭动起来寻求更多快感
		ENDSELECT
		PRINTFORML …
	ENDIF

	SELECTCASE TFLAG:194
		CASE 1
			PRINTFORML 随着爱抚继续，互相依偎的%CALLNAME:TARGET%和%CALLNAME:LOCAL%双手已经握在了一起…
		CASE 2
			PRINTFORML 随着爱抚继续，%CALLNAME:LOCAL%一只手伸向%CALLNAME:TARGET%的乳房揉捏起来，煽动着彼此的兴奋…
		CASE 3
			PRINTFORML 随着爱抚继续，%CALLNAME:TARGET%和%CALLNAME:LOCAL%激烈地拥吻起来，煽动着三人的兴奋…
	ENDSELECT
ENDIF

@ASSISTANT_KOJO_CUSTOM_SCOM6
LOCAL = MASTER_POSE(SET_V,SET_YUBI,1)
CALL KOJO_MESSAGE_SEND("COMMAND_ASSISTANT",-1,LOCAL,-1,-1)

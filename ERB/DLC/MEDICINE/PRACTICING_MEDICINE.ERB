;主角睡觉，医疗业务结算，为明日正常营业重置变量
@MEDICAL_BUSINESS_SETTLEMENT
;依据近期营业次数进行奖励，暂时没有处罚
SIF !IFDr
	RETURN
IF IFDr:1
	PRINTFORML %CALLNAME:0%的医馆今天照常营业了呢
	PRINTL
	PRINTFORMW %CALLNAME:0% 名望 + 5
	EP:1 += 5
ELSE
	PRINTFORMW %CALLNAME:0%的医馆今天处于闭门歇业的状态
ENDIF
;重置营业标志，放行明日开业
IFDr:1 = 0
;重置今日问诊，修正近期问诊
CVARSET BASE,38
;病症随时间自然消失，防止出现无法处理的‘不治之症’
FOR LOCAL, 1, CHARANUM
	SIF BASE:LOCAL:39>0
		BASE:LOCAL:39--
	SIF BASE:LOCAL:42<=0
		CONTINUE
	BASE:LOCAL:42--
	IF !BASE:LOCAL:42&&BASE:LOCAL:45
		PRINTFORML %CALLNAME:LOCAL%的【%STR:(BASE:LOCAL:45)%】症状消失了
		VARSET BASE:LOCAL:40, 0, 40, 86
	;防止某病人过于难治
	;ELSEIF BASE:LOCAL:45
	;	LOCAL:1=RAND:70 + 19000
	;	CALL DISEASE_TYPE(LOCAL)
	;	SIF LOCAL:1==BASE:LOCAL:45
	;		CONTINUE
	;	PRINTFORML %CALLNAME:LOCAL%的【%STR:(BASE:LOCAL:45)%】症状发生了变化！
	;	BASE:LOCAL:45=LOCAL:1
	;	PRINTFORML %CALLNAME:LOCAL%的症状变成了【%STR:(BASE:LOCAL:45)%】！
	ENDIF
NEXT
;修正超过设定外数值的名望和仁义
IF !MeDf:1
	LIMIT EP:1,-499,999
	LIMIT EP:2,-499,999
ENDIF
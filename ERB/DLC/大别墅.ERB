@COLOREDMAP_HAKUREI_5(AA,MAPROW_COLORS)
#LOCALSIZE 1
#LOCALSSIZE 1
#DIMS REF AA, 0
#DIMS REF MAPROW_COLORS, 0
AA:00 = 　​　​林​林​　​　​林​林​林​　​林​林​林​林​　​林​林​林​林​　​　​林​林​林​林
AA:01 = ​■​■​田​■​田​■​田​■​■​■​■​ﾄ​ ​■​■​■​■​■​田​■​■​■​■​■​林​林
AA:02 = ​■​Ⅱ​○​​Ⅱ○​​Ⅱ​○​＿​|​|​/​ ​■​ ​ﾄ​田​日​61地​｜​　​｜​水​62日​田​林​林
AA:03 = ​■​Ⅱ​○​​Ⅱ​○​​Ⅱ​○​​|​ ​￣​　​■​ﾄ​ ​■​━​━​━​┫​　​┣​━​━​━​■​　​林
AA:04 = ​■​　 ​宴会 67　​|​[​】◎​■​ ​ﾄ​田​日64风​｜​　​｜火63​日​田​林​林
AA:05 = ​■​Ⅱ​○​Ⅱ​○​Ⅱ​○​​|​ ​　​　​■​ﾄ​ ​■​━​━​━​┫​　​┣​━​━​━​■​林​林
AA:06 = ​■​Ⅱ​○​Ⅱ​○​​Ⅱ​○​​|​ ​　​　​■​ ​ﾄ​田​日​65光​｜​　​｜​暗​66日​田​林
AA:07 = ​■​■​田​■​田​■​━​■​■​■​■​ﾄ​ ​■​■​■​━​■​　​■​━​━​━​■​　​林
AA:08 = ┃​　​　​　​　​　​□​　​　​　​　​　​├​―​田​―​┤​　​　​　​　​　​田​　​林
AA:09 = ┃​　​　​　​　​　​□　​　​　​　​　​├​―​■​―​┤​　​　​　​　​　​■​林​林
AA:10 = 22□□​□□□68​□□□□​□​□​　┃―​┤​　​回​60　​　​■​　​林
AA:11 = ​┃​　​　​　​　​　​　​　​　​　​□​　​├​―​■​―​┘​　​​大客厅​　​■​林
AA:12 = ​┃​　​　​　​　​　​　​　​　​　​□　​├​―​田​　​　​　​　​　​　​　​田​　​林
AA:13 = ​林​　​　​　​┏​┳​━​━​┓​　​□​　​■​■​■​―​■​━​■​━​―​━​■​　​林
AA:14 = ​林​林​　​　​┃​｜​57　​｜​□​□　​■​　​　​.​.​主卧​┃​ ​​厨房 ​田​林​林
AA:15 = 林​林​　​　​┣​┻​―​━​┫​◎​　​　​田​　58□​　​　​｜​　59​　​■​林
AA:16 = ​林​林​林​　 ​γ​​​　​　​　​ヽ ​　​　​■​　​　​'​'​　​　​┃​　​　​　​田​　​林
AA:17 = 林​林​　​　​（​　​　​　​　​) 　​　​■■​■​■​■​田​■​■​■​■​■​　​林
AA:18 = 林林​林​林​ヽ​＼​　​　​ノ​　​　​　​ ​|​ρ​ρ​ρ​ρ​| ​​林​　　　　　​林
AA:19 = ​林​林​林​林​林​林​￣​￣​林​　​　​　​​　​￣​￣​￣￣​　​　​　​林​林​　​　​林
AA:20 = ​林​林​　​　​林​林​林​林​林​林​林​林​　​林​林​林​林​　​　​林​林​林​林林林

MAPROW_COLORS:00 = 0,,florad,,0,,florad,,,0,florad,,,,0,florad,,,,0,,florad,,,,,,,,
MAPROW_COLORS:01 = 0x796551,,0x3D5B79,0x796551,0x3D5B79,0x796551,0x3D5B79,0x796551,,,,floras,,0x796551,,,,,0x3D5B79,0x796551,,,,,florad,,,,,
MAPROW_COLORS:02 = 0x796551,0x47291F,,,,,,0x513D29,,,,,0x796551,floras,,0x3D5B79,0x3D0101,0,,0x6e511e,0x5B1F01,0,0x5B1F01,0x3eede7,0,,0x3D0101,0x3D5B79,floras,sakurad
MAPROW_COLORS:03 = 0x796551,0x47291F,,,,,,0x513D29,,,0,0x796551,floras,,0x796551,,,,,0,0x796551,,,,,0,floras,,,
MAPROW_COLORS:04 = 0x796551,0,,def,,0,,,,0x513D29,,,0,0x796551,floras,,0x3D5B79,0x3D0101,0,,0x00e09e,0x5B1F01,0,0x5B1F01,0xff2d51,0,,0x3D0101,0x3D5B79,sakuras
MAPROW_COLORS:05 = 0x796551,0x47291F,,,,,,0x513D29,,0,,0x796551,floras,,0x796551,,,,,0,0x796551,,,,,floras,,,,
MAPROW_COLORS:06 = 0x796551,0x47291F,,,,,,0x513D29,,0,,0x796551,floras,,0x3D5B79,0x3D0101,0,,0xeacd76,0x5B1F01,0,0x5B1F01,0x395260,0,,0x3D0101,0x3D5B79,floras,,
MAPROW_COLORS:07 = 0x796551,,0x3D5B79,0x796551,0x3D5B79,0x796551,0x3D5B79,0x796551,,,,floras,,0x796551,,,,,0,0x796551,,,,,0,floras,,,,
MAPROW_COLORS:08 = 0,0x0B0B0B,,,,,0x0B0B0B,0x0B0B0B,,,,,0x513D29,,0x3D5B79,0x513D29,,0,,,,,0x3D5B79,0,floras,sakuras,,,,
MAPROW_COLORS:09 = 0,0x0B0B0B,,,,,0x0B0B0B,0x0B0B0B,,,,,0x513D29,,0x796551,0x513D29,,0,,,,,0x796551,floras,sakural,,,,,
MAPROW_COLORS:10 = 0,,0x0B0B0B,,,0x0B0B0B,,0,,0x0B0B0B,,,,,,,0x5B1F01,0x513D29,,0,0x013D3D,0,,,,0x796551,0,floras
MAPROW_COLORS:11 = 0,0x0B0B0B,,,,,,0x0B0B0B,,,0x0B0B0B,0x0B0B0B,0x513D29,,0x796551,0x513D29,,0,,,,,0x796551,floras,,
MAPROW_COLORS:12 = 0,0x0B0B0B,,,,,,0x0B0B0B,,,0x0B0B0B,0x0B0B0B,0x513D29,,0x3D5B79,0,,,,,,,0x3D5B79,0,floras,,,,,
MAPROW_COLORS:13 = floral,0x0B0B0B,,,0x796551,,,,,0x0B0B0B,0x0B0B0B,0x0B0B0B,0x796551,,,0x5B1F01,0x796551,,,,0x5B1F01,0x796551,,0,sakuras,
MAPROW_COLORS:14 = florad,,0x0B0B0B,,0x796551,0x5B1F01,0,,,0x5B1F01,0x0B0B0B,,0x0B0B0B,0x796551,0,,0x47291F,,def,,0x796551,0,def,,0,0x3D5B79,floras,,
MAPROW_COLORS:15 = floral,,0x0B0B0B,,0x796551,,0x5B1F01,0x796551,,0x3D79B5,0x0B0B0B,,0x3D5B79,0,,,0x513D29,def,,0x5B1F01,0,,,,0x796551,floras,,,
MAPROW_COLORS:16 = floras,,floran,0x0B0B0B,,0x3D79B5,still,steam,steam,0x3D79B5,0x0B0B0B,,,0x796551,0,,0x47291F,,0,,0x796551,0,,,0x3D5B79,0,floras,sakural,
MAPROW_COLORS:17 = floral,,0x0B0B0B,,0x3D79B5,steam,still,still,steam,0x3D79B5,0x0B0B0B,,,0x796551,,,,,0x3D5B79,0x796551,,,,,sakural,sakural,
MAPROW_COLORS:18 = floral,,,,floran,0x3D79B5,still,steam,0x3D79B5,0x0B0B0B,,,0,0x5B5B5B,flower,,,,0x5B5B5B,0,sakurad,0x0B0B0B,,,,,floras,,,,,,,
MAPROW_COLORS:19 = sakuran,sakurad,sakuras,sakural,floras,,0x3D79B5,,floras,0x0B0B0B,,,0x5B5B5B,,,,,0x0B0B0B,,,floras,,0,,floras,,,,,,
MAPROW_COLORS:20 = florad,,0,,floral,,,florad,floras,,sakuran,sakural,0,florad,,,,0,,florad,,sakuras,,sakural,,,

@MAP_HAKUREI_5(AA)
#LOCALSIZE 1
#LOCALSSIZE 1
#DIMS REF AA, 0
AA:00 = 　​　​林​林​　​　​林​林​林​　​林​林​林​林​　​林​林​林​林​　​　​林​林​林​林
AA:01 = ​■​■​田​■​田​■​田​■​■​■​■​ﾄ​ ​■​■​■​■​■​田​■​■​■​■​■​林​林
AA:02 = ​■​Ⅱ​　​​​Ⅱ　​​​Ⅱ​　​​​＿​|​|​/​ ​■​ ​ﾄ​田​ ​61 地​｜​　​｜​水 ​62 ​田​林​林
AA:03 = ​■​Ⅱ​　​​​Ⅱ​　​​​Ⅱ​　​​​|​ ​￣​　​■​ﾄ​ ​■​━​━​━​┫​　​┣​━​━​━​■​　​林
AA:04 = ​■​　 ​宴会 67　​|​[​】◎​■​ ​ﾄ​田​ 64 风​｜​　​｜火 63​ ​田​林​林
AA:05 = ​■​Ⅱ​　​​Ⅱ​　​​Ⅱ​　​​​|​ ​　​　​■​ﾄ​ ​■​━​━​━​┫​　​┣​━​━​━​■​林​林
AA:06 = ​■​Ⅱ​　​​Ⅱ​　​​​Ⅱ​　​​​|​ ​　​　​■​ ​ﾄ​田​ 65 光​｜​　​｜​暗 ​66 ​田​林
AA:07 = ​■​■​田​■​田​■​━​■​■​■​■​ﾄ​ ​■​■​■​━​■​　​■​━​━​━​■​　​林
AA:08 = ┃​　​​　​​　​​　​​　​​　​​　​​　​​　​​　​​　​​├​―​田​―​┤​　​　​　​　​　​田​　​林
AA:09 = ┃​　​​　​​　​​　​​　​​　​　​​　​​　​​　​​　​​├​―​■​―​┤​　​　​　​　​　​■​林​林
AA:10 = 22　​←​←​　​　​68​　​　​　​　​​　​​├​―​​┃―​┤​　​回​60　​　​■​　​林
AA:11 = ​┃​　​​　​​　​​　​​　​​　​​　​​　​​　​​　​​　​​├​―​■​―​┘​　​​大客厅​　​■​林
AA:12 = ​┃​　​​　​​　​​　​​　​　​​　​​　​​　​​　​　​​├​―​田​　​　​　​　​　​　​　​田​　​林
AA:13 = ​林​　​​　​​　​​┏​┳​━​━​┓​　​​　​​　​​■​■​■​―​■​━​■​━​―​━​■​　​林
AA:14 = ​林​林​　​​　​​┃​｜​57　​｜​　​​　​　​​■​　​　​.​.​主卧​┃​ ​​厨房 ​田​林​林
AA:15 = 林​林​　​​　​​┣​┻​―​━​┫​◎​　​​　​​田​　58□​​　​　​｜​　59​　​■​林
AA:16 = ​林​林​林​　​ ​γ - -ーヽ ​​　​​　​​■​　​　​'​'​　​　​┃​　​　​　​田​　​林
AA:17 = 林​林​　​​　​​（- -  -∫) 　​​　​​■■​■​■​■​田​■​■​■​■​■​　​林
AA:18 = 林林​林​林​　＼​ -∫​ノ​　​​　​​　​ ​|​ρф＊γ​| ​​林​　　　　　​林
AA:19 = ​林​林​林​林​林​林​￣​￣​林​　​​　​​　​​​　​￣​￣​￣￣​　​　​　​林​林​　​　​林
AA:20 = ​林​林​　​　​林​林​林​林​林​林​林​林​　​林​林​林​林​　​　​林​林​林​林林林

@DRAW_MAP_BG_FamilyHotel(SLICED)
#LOCALSIZE 1
#LOCALSSIZE 1
#DIMS SLICED
SELECTCASE SLICED
CASE "地"
	SETCOLOR 0x6e511e
	PRINT 地
	RESETCOLOR
CASE "水"
	SETCOLOR 0x3eede7
	PRINT 水
	RESETCOLOR
CASE "火"
	SETCOLOR 0xff2d51
	PRINT 火
	RESETCOLOR
CASE "风"
	SETCOLOR 0x00e09e
	PRINT 风
	RESETCOLOR
CASE "光"
	SETCOLOR 0xeacd76
	PRINT 光
	RESETCOLOR
CASE "暗"
	SETCOLOR 0x395260
	PRINT 暗
	RESETCOLOR
ENDSELECT

@FamilyHotel_Close_Info
#LOCALSIZE 1
#LOCALSSIZE 1
PRINTFORMW 大别墅正在装修中…\n（※旅店系统补丁未开启）

@FamilyHotel_GPS_Info
#LOCALSIZE 1
#LOCALSSIZE 1
IF GROUPMATCH(CFLAG:MASTER:現在位置,P61地の間,P62水の間,P63火の間,P64风の間,P65光の間,P66暗の間)
	PRINTFORM   住宿旅客: 
	FOR LOCAL, 1, CHARANUM - 1
		SIF CFLAG:LOCAL:初期位置 == CFLAG:MASTER:現在位置
			PRINTFORM ❤%CALLNAME:LOCAL% 
	NEXT
ENDIF

@引っ越し初期位置設定_FamilyHotel_Choice
#LOCALSIZE 1
#LOCALSSIZE 1
;之前用默认初期位置判断的，而且还取余，感觉一点道理都没有，其他地图如果也有53号默认初期怎么办，改成地图判断多好
IF MAIN_MAP == MAP神社
	PRINTFORM [ 58] - (58)大别墅的主卧　
	FONTSTYLE 5
	SETCOLOR C_GRAY
	PRINTFORML (魔改功能)
	FONTSTYLE 0
	RESETCOLOR
ENDIF

@引っ越し初期位置設定_FamilyHotel_Sethome
#LOCALSIZE 1
#LOCALSSIZE 1
默认初期位置 = P58大主卧
拠点_家主 = [[霊夢]]
PRINTFORMW 将大别墅主卧设定为了%CALLNAME:MASTER%的私室

@来訪フラグ_FamilyHotel(来訪者数)
#LOCALSIZE 6
#LOCALSSIZE 1
#DIM 来訪者数
;SIF 来訪者数 == 0
;	RETURN
PRINTFORML 昨日来访者住宿收益:     (评价好坏会影响好感/信赖变化哟)
FOR LOCAL, 1, CHARANUM - 1
	FOR LOCAL:1, P61地の間, (P66暗の間+1)
		IF CFLAG:LOCAL:神社在住 == LOCAL:1
			CFLAG:LOCAL:神社在住 = 0
			SIF MAIN_MAP == 0
				CFLAG:LOCAL:拠点来訪 = 1
			CFLAG:LOCAL:初期位置 = CSVCFLAG(LOCAL, GETNUM(CFLAG, "初期位置"))
			IF CFLAG:LOCAL:初期位置 < 57
				CFLAG:LOCAL:神社在住 = CSVCFLAG(LOCAL, GETNUM(CFLAG, "初期位置"))
				CFLAG:LOCAL:拠点来訪 = 0
				;#;PRINTFORM 神社原住民 {CFLAG:LOCAL:神社在住}-%NAME_FROM_PLACE(CFLAG:LOCAL:神社在住)%  
			ENDIF
			PRINTFORM 住在%NAME_FROM_PLACE(8000 + LOCAL:1)%的
			SETCOLOR 0x66FFFF
			PRINTFORM %CALLNAME:LOCAL,12,Left%
			RESETCOLOR 
			PRINTFORM %TEXTR("个人感觉/和朋友谈论/投稿了《文文。新闻》/记录下来了/投稿了《花果子念报》")%:
			PRINTFORM %TEXTR("豪华别墅/这家旅社/这个地方")%的
			PRINTFORM %TEXTR("住宿环境/大落地镜/软绵大床/超大浴缸/周边景色")%实在是
			LOCAL:2 = 500 + (5000 - YOGORE:(LOCAL:1))/10	;住宿费
			SELECTCASE YOGORE:(LOCAL:1)
				CASE IS < 250
					SETCOLOR C_GREEN
					PRINTFORM 棒极了!
					CFLAG:LOCAL:信賴度 += 5
				CASE IS < 500
					SETCOLOR C_M_GREEN
					PRINTFORM 非常赞!
					CFLAG:LOCAL:信賴度 += 2
				CASE IS < 1000
					SETCOLOR C_P_GREEN
					PRINTFORM 还可以!
					CFLAG:LOCAL:信賴度 += 1
				CASE IS < 2000
					SETCOLOR C_YELLOW
					PRINTFORM 一般般!
				CASE IS < 3500
					SETCOLOR C_V_PINK
					PRINTFORM 有点脏!
					CFLAG:LOCAL:信賴度 -= 1
				CASE IS < 5000
					SETCOLOR C_RED
					PRINTFORM 太差了!
					CFLAG:LOCAL:信賴度 -= 5
				CASEELSE
					SETCOLOR C_RED
					PRINTFORM 和猪窝没什么区别!!!
					CFLAG:LOCAL:信賴度 -= 10
			ENDSELECT
			CFLAG:LOCAL:好感度 += (5000 - YOGORE:(LOCAL:1))/100
			RESETCOLOR
			IF LOCAL:2 > 0
				PRINTFORML 并交纳了{LOCAL:2}住宿费。
				MONEY += LOCAL:2
				YOGORE:(LOCAL:1) += LOCAL:2
			ELSE
				PRINTFORML ,没给钱就走了...甚至把房间弄得更脏了......
				CFLAG:LOCAL:拠点来訪 = 0	;直接回家了
				YOGORE:(LOCAL:1) += Rand:500 + YOGORE:(LOCAL:1)/10
			ENDIF	
		ENDIF
	NEXT
NEXT

LOCAL:4 = Min(来訪者数,6)
PRINTFORM 今日来访者住宿人数合计{LOCAL:4,2}人,
$随机住户
IF LOCAL:4 < 1 && 来訪者数 > 0
	;PRINTFORMW   大别墅今天好像有新旅客的样子…
	PRINTFORMW 预定了大别墅的房间…
	RETURN
ELSE
	LOCAL:5 = Rand:(CHARANUM - 2) + 1
	SIF CFLAG:(LOCAL:5):拠点来訪 == 0 && CFLAG:(LOCAL:5):神社在住 > 57
		GOTO 随机住户
	CFLAG:(LOCAL:5):神社在住 = LOCAL:4 + 60
	CFLAG:(LOCAL:5):初期位置 = LOCAL:4 + 60
	CFLAG:(LOCAL:5):現在位置 = LOCAL:4 + 60
	LOCAL:4 --
	PRINTFORM %CALLNAME:(LOCAL:5)%.
	GOTO 随机住户
ENDIF
